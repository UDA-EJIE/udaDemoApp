package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.DatosPagoProveedoresInt;

/**
 * DatosPagoProveedoresIntIntDaoImpl generated by UDA, 19-jun-2018 13:27:18.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class DatosPagoProveedoresIntDaoImpl extends GenericoDaoImpl<DatosPagoProveedoresInt>
		implements DatosPagoProveedoresIntDao {

	protected static final String ID_TAREA_095 = "ID_TAREA_095";
	protected static final String IDTAREA = "IDTAREA";

	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { IDTAREA, "IMPORTEBASE", "IMPORTEIVA",
			"IMPORTETOTAL", "PORIVA" };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<DatosPagoProveedoresInt> rwMap = new RowMapper<DatosPagoProveedoresInt>() {
		@Override
		public DatosPagoProveedoresInt mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			final DatosPagoProveedoresInt datosPagoProveedoresInt = new DatosPagoProveedoresInt();
			datosPagoProveedoresInt.setIdTarea(resultSet.getBigDecimal(IDTAREA));
			datosPagoProveedoresInt.setImporteBase(resultSet.getBigDecimal("IMPORTEBASE"));
			datosPagoProveedoresInt.setImporteIva(resultSet.getBigDecimal("IMPORTEIVA"));
			datosPagoProveedoresInt.setImporteTotal(resultSet.getBigDecimal("IMPORTETOTAL"));
			datosPagoProveedoresInt.setPorIva(resultSet.getBigDecimal("PORIVA"));
			return datosPagoProveedoresInt;
		}
	};

	private RowMapper<DatosPagoProveedoresInt> rwMapPK = new RowMapper<DatosPagoProveedoresInt>() {
		@Override
		public DatosPagoProveedoresInt mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			final DatosPagoProveedoresInt datosPagoProveedoresInt = new DatosPagoProveedoresInt();
			datosPagoProveedoresInt.setIdTarea(resultSet.getBigDecimal(IDTAREA));

			return datosPagoProveedoresInt;
		}
	};

	/**
	 * Constructor
	 */
	public DatosPagoProveedoresIntDaoImpl() {
		super(DatosPagoProveedoresInt.class);
	}

	@Override
	public DatosPagoProveedoresInt add(DatosPagoProveedoresInt datospagoproveedores) {
		String query = "INSERT INTO AA79B95S01 (ID_TAREA_095, IMPORTE_BASE_095, IMPORTE_IVA_095, IMPORTE_TOTAL_095, POR_IVA_095) VALUES (?,?,?,?,?)";
		this.getJdbcTemplate().update(query, datospagoproveedores.getIdTarea(), datospagoproveedores.getImporteBase(),
				datospagoproveedores.getImporteIva(), datospagoproveedores.getImporteTotal(),
				datospagoproveedores.getPorIva());
		return datospagoproveedores;
	}

	@Override
	public DatosPagoProveedoresInt update(DatosPagoProveedoresInt datospagoproveedores) {
		String query = "UPDATE AA79B95S01 SET ID_TAREA_095 = ?, IMPORTE_BASE_095 = ?, IMPORTE_IVA_095 = ?, IMPORTE_TOTAL_095 = ?, POR_IVA_095 = ? WHERE ID_TAREA_095=?";
		this.getJdbcTemplate().update(query, datospagoproveedores.getIdTarea(), datospagoproveedores.getImporteBase(),
				datospagoproveedores.getImporteIva(), datospagoproveedores.getImporteTotal(),
				datospagoproveedores.getPorIva(), datospagoproveedores.getIdTarea());
		return datospagoproveedores;
	}

	@Override
	public void remove(DatosPagoProveedoresInt datospagoproveedores) {
		String query = "DELETE FROM AA79B95S01 WHERE ID_TAREA_095=?";
		this.getJdbcTemplate().update(query, datospagoproveedores.getIdTarea());
	}

	@Override()
	protected String getSelect() {
		StringBuilder query = new StringBuilder();

		query.append("SELECT t1.ID_TAREA_095 IDTAREA, t1.IMPORTE_BASE_095 IMPORTEBASE,"
				+ " t1.IMPORTE_IVA_095 IMPORTEIVA, t1.IMPORTE_TOTAL_095 IMPORTETOTAL, t1.POR_IVA_095 PORIVA");

		return query.toString();
	}

	@Override()
	protected String getFrom() {
		StringBuilder query = new StringBuilder();

		query.append(" FROM AA79B95S01 t1 ");

		return query.toString();
	}

	@Override()
	protected RowMapper<DatosPagoProveedoresInt> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return DatosPagoProveedoresIntDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return ID_TAREA_095;
	}

	@Override()
	protected RowMapper<DatosPagoProveedoresInt> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(DatosPagoProveedoresInt bean, List<Object> params) {
		params.add(bean.getIdTarea());
		return " WHERE t1.ID_TAREA_095 = ?";
	}

	@Override()
	protected String getWhere(DatosPagoProveedoresInt bean, List<Object> params) {

		return this.getWhereClause(bean, params);
	}

	@Override()
	protected String getWhereLike(DatosPagoProveedoresInt bean, Boolean startsWith, List<Object> params,
			Boolean search) {

		return this.getWhereClause(bean, params);
	}

	/**
	 * Obtiene la clausula where
	 * 
	 * @param bean
	 *            DatosPagoProveedoresInt
	 * @param params
	 *            List<Object>
	 * @return String
	 */
	private String getWhereClause(DatosPagoProveedoresInt bean, List<Object> params) {
		StringBuilder where = new StringBuilder(DatosPagoProveedoresIntDaoImpl.STRING_BUILDER_INIT);

		if (bean != null) {
			where.append(SqlUtils.generarWhereIgual(ID_TAREA_095, bean.getIdTarea(), params));
			/* Añadir según necesidades */
		}

		return where.toString();
	}

}
