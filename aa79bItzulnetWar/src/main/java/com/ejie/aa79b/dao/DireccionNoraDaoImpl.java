package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import org.apache.commons.lang.StringUtils;
import org.springframework.dao.support.DataAccessUtils;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.DBConstants;
import com.ejie.aa79b.common.DaoConstants;
import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.dao.mapper.DirNoraRowMapper;
import com.ejie.aa79b.dao.mapper.DireccionNoraRowMapper;
import com.ejie.aa79b.model.Calle;
import com.ejie.aa79b.model.Direccion;
import com.ejie.aa79b.model.DireccionNora;
import com.ejie.aa79b.model.Localidad;
import com.ejie.aa79b.model.Municipio;
import com.ejie.aa79b.model.Pais;
import com.ejie.aa79b.model.Portal;
import com.ejie.aa79b.model.Provincia;
import com.ejie.aa79b.model.enums.TipoNoraEnum;

/**
 * DireccionNoraDaoImpl generated by UDA, 08-feb-2018 8:37:04.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class DireccionNoraDaoImpl extends GenericoDaoImpl<DireccionNora> implements DireccionNoraDao {

	protected static final String CDIRNORA_049 = "CDIRNORA_049";
	protected static final String TIPONORA_049 = "TIPONORA_049";
	protected static final String CODNORA_049 = "CODNORA_049";
	protected static final String CODPROV_049 = "CODPROV_049";
	protected static final String CODCOMUN_049 = "CODCOMUN_049";
	protected static final String CODMUNI_049 = "CODMUNI_049";
	protected static final String CODLOCAL_049 = "CODLOCAL_049";
	protected static final String CODPOST_049 = "CODPOST_049";
	protected static final String ESCALER_049 = "ESCALER_049";
	protected static final String PISO_049 = "PISO_049";
	protected static final String MANO_049 = "MANO_049";
	protected static final String PUERTA_049 = "PUERTA_049";
	protected static final String APROX_049 = "APROX_049";
	protected static final String TXTCALLE_049 = "TXTCALLE_049";
	protected static final String TXTPORTAL_049 = "TXTPORTAL_049";
	protected static final String CODPAIS_049 = "CODPAIS_049";
	protected static final String TXTPROV_049 = "TXTPROV_049";
	protected static final String TXTCIUDAD_049 = "TXTCIUDAD_049";
	protected static final String TXTDIREC_049 = "TXTDIREC_049";
	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { DBConstants.CDIRNORA, DBConstants.TIPONORA,
			"CODNORA", "CODPROV", "CODCOMUN", "CODMUNI", "CODLOCAL", "CODPOST", "ESCALER", DBConstants.PISO,
			DBConstants.MANO, DBConstants.PUERTA, "APROX", "TXTCALLE", "TXTPORTAL", "CODPAIS", "TXTPROV", "TXTCIUDAD",
			"TXTDIREC" };
	protected static final String WHERE_ID = " WHERE ID = ? ";

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<DireccionNora> rwMap = new DireccionNoraRowMapper();

	private RowMapper<DireccionNora> rwMapPK = new RowMapper<DireccionNora>() {
		@Override()
		public DireccionNora mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			DireccionNora direccion = new DireccionNora();
			direccion.setDirNora(resultSet.getInt(DBConstants.CDIRNORA));

			return direccion;
		}
	};

	private RowMapper<Portal> rwMapPortal = new RowMapper<Portal>() {
		@Override
		public Portal mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			Portal portal = new Portal();
			portal.setId(resultSet.getLong("ID"));
			portal.setNumero(resultSet.getLong("NUMERO"));
			portal.setBis(resultSet.getString("BIS"));
			portal.setBloque(resultSet.getString("BLOQUE"));
			portal.setAcepcion(resultSet.getString("ACEPCION"));
			portal.setCodigoPostal(resultSet.getString("CODIGO_POSTAL"));
			portal.setCalleId(resultSet.getLong("CALLE_ID"));
			portal.setLocalidadId(resultSet.getLong("LOCALIDAD_ID"));
			return portal;
		}
	};

	private RowMapper<Calle> rwMapCalle = new RowMapper<Calle>() {
		@Override
		public Calle mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			Calle calle = new Calle();
			calle.setId(resultSet.getLong("ID"));
			calle.setDsO(resultSet.getString("DS_O"));
			calle.setDsE(resultSet.getString("DS_E"));
			calle.setMunicipioId(resultSet.getString("MUNICIPIO_ID"));
			calle.setProvinciaId(resultSet.getString("PROVINCIA_ID"));
			return calle;
		}
	};

	private RowMapper<Localidad> rwMapLocalidad = new RowMapper<Localidad>() {
		@Override
		public Localidad mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			Localidad localidad = new Localidad();
			localidad.setId(resultSet.getLong("ID"));
			localidad.setDsO(resultSet.getString("DS_O"));
			localidad.setMunicipioId(resultSet.getString("MUNICIPIO_ID"));
			localidad.setProvinciaId(resultSet.getString("PROVINCIA_ID"));
			return localidad;
		}
	};

	private RowMapper<Municipio> rwMapMunicipio = new RowMapper<Municipio>() {
		@Override
		public Municipio mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			Municipio municipio = new Municipio();
			municipio.setId(resultSet.getString("ID"));
			municipio.setDsO(resultSet.getString("DS_O"));
			return municipio;
		}
	};

	private RowMapper<Provincia> rwMapProvincia = new RowMapper<Provincia>() {
		@Override
		public Provincia mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			Provincia provincia = new Provincia();
			provincia.setId(resultSet.getString("ID"));
			provincia.setDsO(resultSet.getString("DS_O"));
			return provincia;
		}
	};

	private RowMapper<Pais> rwMapPais = new RowMapper<Pais>() {
		@Override
		public Pais mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			Pais pais = new Pais();
			pais.setId(resultSet.getString("ID"));
			pais.setDsO(resultSet.getString("DS_O"));
			return pais;
		}
	};

	private RowMapper<Direccion> rwMapDirNoraConDni = new RowMapper<Direccion>() {
		@Override()
		public Direccion mapRow(ResultSet rs, int rowNum) throws SQLException {
			Direccion direccion = new Direccion();
			direccion.setCodProvincia(rs.getString(DBConstants.PROVINCIA));
			direccion.setCodMunicipio(rs.getString(DBConstants.MUNICIPIO));
			direccion.setTxtLocalidad(rs.getString(DBConstants.LOCALIDAD));
			direccion.setTxtCalle(rs.getString(DBConstants.DIRECCION));
			direccion.setCodPostal(rs.getString(DBConstants.CODPOSTAL));
			return direccion;
		}
	};

	private RowMapper<DireccionNora> rwMapDirNoraConDirNora = new DirNoraRowMapper();

	private RowMapper<Direccion> getRwMapDirNoraConDni() {
		return this.rwMapDirNoraConDni;
	}

	private RowMapper<DireccionNora> getRwMapDirNoraConDirNora() {
		return this.rwMapDirNoraConDirNora;
	}

	/**
	 * Constructor
	 */
	public DireccionNoraDaoImpl() {
		super(DireccionNora.class);
	}

	/*
	 * OPERACIONES CRUD
	 */

	/**
	 * Inserts a single row in the DireccionNora table.
	 *
	 * @param direccionnora
	 *            DireccionNora
	 * @return DireccionNora
	 */
	@Override()
	public DireccionNora add(DireccionNora direccionnora) {
		String query = "INSERT INTO AA79B49S01 (TIPONORA_049, CODNORA_049, CODPROV_049, CODCOMUN_049, CODMUNI_049, CODLOCAL_049, CODPOST_049, ESCALER_049, PISO_049, MANO_049, PUERTA_049, APROX_049, TXTCALLE_049, TXTPORTAL_049, CODPAIS_049, TXTPROV_049, TXTCIUDAD_049, TXTDIREC_049, CDIRNORA_049) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

		List<Object> paramsInsert;
		if (TipoNoraEnum.UNO.getValue().equals(direccionnora.getTipoNora())
				|| TipoNoraEnum.DOS.getValue().equals(direccionnora.getTipoNora())) {
			paramsInsert = this.getParametrosTipoNora12(direccionnora);
		} else if (TipoNoraEnum.TRES.getValue().equals(direccionnora.getTipoNora())) {
			paramsInsert = this.getParametrosTipoNora3(direccionnora);
		} else {
			paramsInsert = this.getParametrosTipoNora0(direccionnora);
		}

		this.getJdbcTemplate().update(query, paramsInsert.toArray());
		return direccionnora;
	}

	/**
	 * Updates a single row in the DireccionNora table.
	 *
	 * @param direccionnora
	 *            DireccionNora
	 * @return DireccionNora
	 */
	@Override()
	public DireccionNora update(DireccionNora direccionnora) {
		String query = "UPDATE AA79B49S01 SET TIPONORA_049=?, CODNORA_049=?, CODPROV_049=?, CODCOMUN_049=?, CODMUNI_049=?, CODLOCAL_049=?, CODPOST_049=?, ESCALER_049=?, PISO_049=?, MANO_049=?, PUERTA_049=?, APROX_049=?, TXTCALLE_049=?, TXTPORTAL_049=?, CODPAIS_049=?, TXTPROV_049=?, TXTCIUDAD_049=?, TXTDIREC_049=? WHERE CDIRNORA_049=?";

		List<Object> paramsInsert;
		if (TipoNoraEnum.UNO.getValue().equals(direccionnora.getTipoNora())
				|| TipoNoraEnum.DOS.getValue().equals(direccionnora.getTipoNora())) {
			paramsInsert = this.getParametrosTipoNora12(direccionnora);
		} else if (TipoNoraEnum.TRES.getValue().equals(direccionnora.getTipoNora())) {
			paramsInsert = this.getParametrosTipoNora3(direccionnora);
		} else {
			paramsInsert = this.getParametrosTipoNora0(direccionnora);
		}

		this.getJdbcTemplate().update(query, paramsInsert.toArray());
		return direccionnora;
	}

	/**
	 * Removes a single row in the DireccionNora table.
	 *
	 * @param direccionnora
	 *            DireccionNora
	 * @return
	 */
	@Override()
	public void remove(DireccionNora direccionnora) {
		String query = "DELETE FROM AA79B49S01 WHERE CDIRNORA_049=?";
		this.getJdbcTemplate().update(query, direccionnora.getDirNora());
	}

	@Override()
	protected String getSelect() {
		StringBuilder query = new StringBuilder();

		query.append("SELECT t1.CDIRNORA_049 CDIRNORA");
		query.append(", t1.TIPONORA_049 TIPONORA");
		query.append(", t1.CODNORA_049 CODNORA");
		query.append(", t1.CODPROV_049 CODPROV");
		query.append(", t1.CODCOMUN_049 CODCOMUN");
		query.append(", t1.CODMUNI_049 CODMUNI");
		query.append(", t1.CODLOCAL_049 CODLOCAL");
		query.append(", t1.CODPOST_049 CODPOST");
		query.append(", t1.ESCALER_049 ESCALER");
		query.append(", t1.PISO_049 PISO");
		query.append(", t1.MANO_049 MANO");
		query.append(", t1.PUERTA_049 PUERTA");
		query.append(", t1.APROX_049 APROX");
		query.append(", t1.TXTCALLE_049 TXTCALLE");
		query.append(", t1.TXTPORTAL_049 TXTPORTAL");
		query.append(", t1.CODPAIS_049 CODPAIS");
		query.append(", t1.TXTPROV_049 TXTPROV");
		query.append(", t1.TXTCIUDAD_049 TXTCIUDAD");
		query.append(", t1.TXTDIREC_049 TXTDIREC");

		return query.toString();
	}

	@Override()
	protected String getFrom() {
		StringBuilder query = new StringBuilder();

		query.append(" FROM AA79B49S01 t1 ");

		return query.toString();
	}

	@Override()
	protected RowMapper<DireccionNora> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return DireccionNoraDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return CDIRNORA_049;
	}

	@Override()
	protected RowMapper<DireccionNora> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(DireccionNora bean, List<Object> params) {
		params.add(bean.getDirNora());
		return " WHERE CDIRNORA_049 = ?";
	}

	@Override()
	protected String getWhere(DireccionNora bean, List<Object> params) {

		StringBuilder where = new StringBuilder(DireccionNoraDaoImpl.STRING_BUILDER_INIT);

		if (bean != null) {
			where.append(SqlUtils.generarWhereIgual(CDIRNORA_049, bean.getDirNora(), params));
			where.append(SqlUtils.generarWhereIgual(TIPONORA_049, bean.getTipoNora(), params));
			where.append(SqlUtils.generarWhereIgual(CODNORA_049, bean.getCodNora(), params));
			where.append(SqlUtils.generarWhereIgual(CODPROV_049, bean.getCodProvincia(), params));
			where.append(SqlUtils.generarWhereIgual(CODCOMUN_049, bean.getCodComun(), params));
			where.append(SqlUtils.generarWhereIgual(CODMUNI_049, bean.getCodMunicipio(), params));
			where.append(SqlUtils.generarWhereIgual(CODLOCAL_049, bean.getCodLocal(), params));
			where.append(SqlUtils.generarWhereIgual(CODPOST_049, bean.getCodPostal(), params));
			where.append(SqlUtils.generarWhereIgual(ESCALER_049, bean.getEscalera(), params));
			where.append(SqlUtils.generarWhereIgual(PISO_049, bean.getPiso(), params));
			where.append(SqlUtils.generarWhereIgual(MANO_049, bean.getMano(), params));
			where.append(SqlUtils.generarWhereIgual(PUERTA_049, bean.getPuerta(), params));
			where.append(SqlUtils.generarWhereIgual(APROX_049, bean.getAprox(), params));
			where.append(SqlUtils.generarWhereIgual(TXTCALLE_049, bean.getTxtCalle(), params));
			where.append(SqlUtils.generarWhereIgual(TXTPORTAL_049, bean.getTxtPortal(), params));
			where.append(SqlUtils.generarWhereIgual(CODPAIS_049, bean.getCodPais(), params));
			where.append(SqlUtils.generarWhereIgual(TXTPROV_049, bean.getTxtProvincia(), params));
			where.append(SqlUtils.generarWhereIgual(TXTCIUDAD_049, bean.getTxtLocalidad(), params));
			where.append(SqlUtils.generarWhereIgual(TXTDIREC_049, bean.getTxtDirec(), params));
		}

		return where.toString();
	}

	@Override()
	protected String getWhereLike(DireccionNora bean, Boolean startsWith, List<Object> params, Boolean search) {

		StringBuilder where = new StringBuilder(DireccionNoraDaoImpl.STRING_BUILDER_INIT);

		if (bean != null) {
			where.append(SqlUtils.generarWhereIgual(CDIRNORA_049, bean.getDirNora(), params));
			where.append(SqlUtils.generarWhereIgual(TIPONORA_049, bean.getTipoNora(), params));
			where.append(SqlUtils.generarWhereIgual(CODNORA_049, bean.getCodNora(), params));
			where.append(SqlUtils.generarWhereIgual(CODPROV_049, bean.getCodProvincia(), params));
			where.append(SqlUtils.generarWhereIgual(CODCOMUN_049, bean.getCodComun(), params));
			where.append(SqlUtils.generarWhereIgual(CODMUNI_049, bean.getCodMunicipio(), params));
			where.append(SqlUtils.generarWhereIgual(CODLOCAL_049, bean.getCodLocal(), params));
			where.append(SqlUtils.generarWhereIgual(CODPOST_049, bean.getCodPostal(), params));
			where.append(SqlUtils.generarWhereIgual(ESCALER_049, bean.getEscalera(), params));
			where.append(SqlUtils.generarWhereIgual(PISO_049, bean.getPiso(), params));
			where.append(SqlUtils.generarWhereIgual(MANO_049, bean.getMano(), params));
			where.append(SqlUtils.generarWhereIgual(PUERTA_049, bean.getPuerta(), params));
			where.append(SqlUtils.generarWhereIgual(APROX_049, bean.getAprox(), params));
			where.append(SqlUtils.generarWhereIgual(TXTCALLE_049, bean.getTxtCalle(), params));
			where.append(SqlUtils.generarWhereIgual(TXTPORTAL_049, bean.getTxtPortal(), params));
			where.append(SqlUtils.generarWhereIgual(CODPAIS_049, bean.getCodPais(), params));
			where.append(SqlUtils.generarWhereIgual(TXTPROV_049, bean.getTxtProvincia(), params));
			where.append(SqlUtils.generarWhereIgual(TXTCIUDAD_049, bean.getTxtLocalidad(), params));
			where.append(SqlUtils.generarWhereIgual(TXTDIREC_049, bean.getTxtDirec(), params));
		}

		return where.toString();
	}

	/**
	 * @param id
	 *            Long
	 * @return Portal
	 */
	@Override
	public Portal getPortal(Long id) {
		StringBuilder query = new StringBuilder("SELECT ID, NUMERO, DECODE(BIS, 'Y', 'BIS', BIS) AS BIS,")
				.append(" BLOQUE, ACEPCION, CODIGO_POSTAL, CALLE_ID, LOCALIDAD_ID").append(" FROM AA79PORTAL")
				.append(WHERE_ID);

		List<Portal> portalList = this.getJdbcTemplate().query(query.toString(), this.rwMapPortal, id);
		if (portalList != null && !portalList.isEmpty()) {
			return DataAccessUtils.uniqueResult(portalList);
		} else {
			return new Portal();
		}

	}

	/**
	 * @param id
	 *            Long
	 * @return Portal
	 */
	@Override
	public Calle getCalle(Long id) {
		StringBuilder query = new StringBuilder("SELECT ID, UPPER(DS_O) AS DS_O, UPPER(DS_E) AS DS_E,")
				.append(" MUNICIPIO_ID, PROVINCIA_ID").append(" FROM AA79CALLE").append(WHERE_ID);

		List<Calle> calleList = this.getJdbcTemplate().query(query.toString(), this.rwMapCalle, id);

		if (calleList != null && !calleList.isEmpty()) {
			return DataAccessUtils.uniqueResult(calleList);
		} else {
			return new Calle();
		}
	}

	/**
	 * @param id
	 *            Long
	 * @return Localidad
	 */
	@Override
	public Localidad getLocalidad(Long id) {
		StringBuilder query = new StringBuilder("SELECT ID, UPPER(DS_O) AS DS_O, MUNICIPIO_ID, PROVINCIA_ID")
				.append(" FROM AA79LOCALIDAD").append(WHERE_ID);

		List<Localidad> localidadList = this.getJdbcTemplate().query(query.toString(), this.rwMapLocalidad, id);

		if (localidadList != null && !localidadList.isEmpty()) {
			return DataAccessUtils.uniqueResult(localidadList);
		} else {
			return new Localidad();
		}

	}

	/**
	 * @param idMun
	 *            String
	 * @param idProv
	 *            String
	 * @return Municipio
	 */
	@Override
	public Municipio getMunicipio(String idMun, String idProv) {
		StringBuilder query = new StringBuilder("SELECT ID, UPPER(DS_O) AS DS_O").append(" FROM AA79MUNICIPIO")
				.append(WHERE_ID + "AND PROVINCIA_ID=?");

		List<Municipio> municipioList = this.getJdbcTemplate().query(query.toString(), this.rwMapMunicipio, idMun,
				idProv);
		if (municipioList != null && !municipioList.isEmpty()) {
			return DataAccessUtils.uniqueResult(municipioList);
		} else {
			return new Municipio();
		}

	}

	/**
	 * @param id
	 *            String
	 * @return Provincia
	 */
	@Override
	public Provincia getProvincia(String id) {
		StringBuilder query = new StringBuilder("SELECT ID,  UPPER(DS_O) AS DS_O FROM AA79PROVINCIA " + WHERE_ID);

		List<Provincia> provinciaList = this.getJdbcTemplate().query(query.toString(), this.rwMapProvincia, id);
		if (provinciaList != null && !provinciaList.isEmpty()) {
			return DataAccessUtils.uniqueResult(provinciaList);
		} else {
			return new Provincia();
		}

	}

	/**
	 * @param id
	 *            String
	 * @return Pais
	 */
	@Override
	public Pais getPais(String id) {
		StringBuilder query = new StringBuilder("SELECT ID,  UPPER(DS_O) AS DS_O FROM AA79PAIS" + WHERE_ID);

		List<Pais> paisList = this.getJdbcTemplate().query(query.toString(), this.rwMapPais, id);
		if (paisList != null && !paisList.isEmpty()) {
			return DataAccessUtils.uniqueResult(paisList);
		} else {
			return new Pais();
		}

	}

	/**
	 * @param direccionNora
	 *            DireccionNora
	 * @return List<Object>
	 */
	private List<Object> getParametrosTipoNora0(DireccionNora direccionNora) {
		List<Object> paramsTipo1 = new ArrayList<Object>();
		paramsTipo1.add(direccionNora.getTipoNora()); // TIPONORA_
		paramsTipo1.add(direccionNora.getPortal().getId()); // CODNORA_
		paramsTipo1.add(direccionNora.getProvincia().getId()); // CODPROV_
		paramsTipo1.add(null); // CODCOMUN_
		paramsTipo1.add(direccionNora.getMunicipio().getId()); // CODMUNI_
		paramsTipo1.add(direccionNora.getLocalidad().getId()); // CODLOCAL_
		paramsTipo1.add(direccionNora.getCodPostal()); // CODPOST_
		if (StringUtils.isNotBlank(direccionNora.getEscalera())) {
			paramsTipo1.add(direccionNora.getEscalera()); // ESCALER_
		} else {
			paramsTipo1.add(null); // ESCALER_
		}
		if (StringUtils.isNotBlank(direccionNora.getPiso())) {
			paramsTipo1.add(direccionNora.getPiso()); // PISO_
		} else {
			paramsTipo1.add(null); // PISO_
		}
		if (StringUtils.isNotBlank(direccionNora.getMano())) {
			paramsTipo1.add(direccionNora.getMano()); // MANO_
		} else {
			paramsTipo1.add(null); // MANO_
		}
		if (StringUtils.isNotBlank(direccionNora.getPuerta())) {
			paramsTipo1.add(direccionNora.getPuerta()); // PUERTA_
		} else {
			paramsTipo1.add(null); // PUERTA_
		}
		if (StringUtils.isNotBlank(direccionNora.getAprox())) {
			paramsTipo1.add(direccionNora.getAprox()); // APROX_
		} else {
			paramsTipo1.add(null); // APROX_
		}
		paramsTipo1.add(null); // TXTCALLE_
		paramsTipo1.add(null); // TXTPORTAL_
		if (StringUtils.isNotBlank(direccionNora.getPais().getId())) {
			paramsTipo1.add(direccionNora.getPais().getId()); // CODPAIS_
		} else {
			paramsTipo1.add(null); // CODPAIS_
		}
		paramsTipo1.add(null); // TXTPROV_
		paramsTipo1.add(null); // TXTCIUDAD_
		paramsTipo1.add(null); // TXTDIREC_
		paramsTipo1.add(this.obtenerCDirNora(direccionNora)); // CDIRNORA_

		return paramsTipo1;
	}

	/**
	 * @param direccionNora
	 * @param paramsTipo1
	 */
	private Integer obtenerCDirNora(DireccionNora direccionNora) {
		if (direccionNora.getDirNora() == null) {
			direccionNora.setDirNora(this.getNextVal());
		}
		return direccionNora.getDirNora();
	}

	/**
	 * @param direccionNora
	 *            DireccionNora
	 * @return List<Object>
	 */
	private List<Object> getParametrosTipoNora12(DireccionNora direccionNora) {
		List<Object> paramsTipo12 = new ArrayList<Object>();
		paramsTipo12.add(direccionNora.getTipoNora()); // TIPONORA_
		paramsTipo12.add(null); // CODNORA_
		paramsTipo12.add(direccionNora.getProvincia().getId()); // CODPROV_
		paramsTipo12.add(null); // CODCOMUN_
		paramsTipo12.add(direccionNora.getMunicipio().getId()); // CODMUNI_
		paramsTipo12.add(direccionNora.getLocalidad().getId()); // CODLOCAL_
		paramsTipo12.add(direccionNora.getCodPostal()); // CODPOST_
		if (StringUtils.isNotBlank(direccionNora.getEscalera())) {
			paramsTipo12.add(direccionNora.getEscalera()); // ESCALER_
		} else {
			paramsTipo12.add(null); // ESCALER_
		}
		if (StringUtils.isNotBlank(direccionNora.getPiso())) {
			paramsTipo12.add(direccionNora.getPiso()); // PISO_
		} else {
			paramsTipo12.add(null); // PISO_
		}
		if (StringUtils.isNotBlank(direccionNora.getMano())) {
			paramsTipo12.add(direccionNora.getMano()); // MANO_
		} else {
			paramsTipo12.add(null); // MANO_
		}
		if (StringUtils.isNotBlank(direccionNora.getPuerta())) {
			paramsTipo12.add(direccionNora.getPuerta()); // PUERTA_
		} else {
			paramsTipo12.add(null); // PUERTA_
		}
		if (StringUtils.isNotBlank(direccionNora.getAprox())) {
			paramsTipo12.add(direccionNora.getAprox()); // APROX_
		} else {
			paramsTipo12.add(null); // APROX_
		}
		paramsTipo12.add(direccionNora.getCalle().getDsO()); // TXTCALLE_
		paramsTipo12.add(direccionNora.getPortal().getTxtPortal()); // TXTPORTAL_
		if (StringUtils.isNotBlank(direccionNora.getPais().getId())) {
			paramsTipo12.add(direccionNora.getPais().getId()); // CODPAIS_
		} else {
			paramsTipo12.add(null); // CODPAIS_
		}
		paramsTipo12.add(null); // TXTPROV_
		paramsTipo12.add(null); // TXTCIUDAD_
		paramsTipo12.add(null); // TXTDIREC_
		paramsTipo12.add(this.obtenerCDirNora(direccionNora)); // CDIRNORA_
		return paramsTipo12;
	}

	/**
	 * @param direccionNora
	 *            DireccionNora
	 * @return List<Object>
	 */
	private List<Object> getParametrosTipoNora3(DireccionNora direccionNora) {
		List<Object> paramsTipo3 = new ArrayList<Object>();
		paramsTipo3.add(direccionNora.getTipoNora());
		paramsTipo3.add(null); // CODNORA_
		paramsTipo3.add(null); // CODPROV_
		paramsTipo3.add(null); // CODCOMUN_
		paramsTipo3.add(null); // CODMUNI_
		paramsTipo3.add(null); // CODLOCAL_
		paramsTipo3.add(direccionNora.getCodPostal()); // CODPOST_
		if (StringUtils.isNotBlank(direccionNora.getEscalera())) {
			paramsTipo3.add(direccionNora.getEscalera()); // ESCALER_
		} else {
			paramsTipo3.add(null); // ESCALER_
		}
		if (StringUtils.isNotBlank(direccionNora.getPiso())) {
			paramsTipo3.add(direccionNora.getPiso()); // PISO_
		} else {
			paramsTipo3.add(null); // PISO_
		}
		if (StringUtils.isNotBlank(direccionNora.getMano())) {
			paramsTipo3.add(direccionNora.getMano()); // MANO_
		} else {
			paramsTipo3.add(null); // MANO_
		}
		if (StringUtils.isNotBlank(direccionNora.getPuerta())) {
			paramsTipo3.add(direccionNora.getPuerta()); // PUERTA_
		} else {
			paramsTipo3.add(null); // PUERTA_
		}
		if (StringUtils.isNotBlank(direccionNora.getAprox())) {
			paramsTipo3.add(direccionNora.getAprox()); // APROX_
		} else {
			paramsTipo3.add(null); // APROX_
		}

		paramsTipo3.add(null); // TXTCALLE_
		paramsTipo3.add(null); // TXTPORTAL_
		if (StringUtils.isNotBlank(direccionNora.getPais().getId())) {
			paramsTipo3.add(direccionNora.getPais().getId()); // CODPAIS_
		} else {
			paramsTipo3.add(null); // CODPAIS_
		}
		paramsTipo3.add(direccionNora.getProvincia().getDsO());// TXTPROV_
		paramsTipo3.add(direccionNora.getLocalidad().getDsO());// TXTCIUDAD_
		paramsTipo3.add(direccionNora.getCalle().getDsO()); // TXTDIREC_
		paramsTipo3.add(this.obtenerCDirNora(direccionNora)); // CDIRNORA_
		return paramsTipo3;
	}

	/**
	 * @return Integer
	 */
	public Integer getNextVal() {
		return this.getJdbcTemplate().queryForObject("SELECT AA79B49Q00.NEXTVAL FROM DUAL", Integer.class);
	}

	@Override
	public Direccion obtenerDireccionConDni(String dni) {
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder();
		query.append(DaoConstants.SELECT);
		query.append(" t2." + DBConstants.PROVINCIA + " " + DBConstants.PROVINCIA + DaoConstants.SIGNO_COMA);
		query.append(" t2." + DBConstants.MUNICIPIO + " " + DBConstants.MUNICIPIO + DaoConstants.SIGNO_COMA);
		query.append(" t2." + DBConstants.LOCALIDAD + " " + DBConstants.LOCALIDAD + DaoConstants.SIGNO_COMA);
		query.append(" t2." + DBConstants.DIRECCION + " " + DBConstants.DIRECCION + DaoConstants.SIGNO_COMA);
		query.append(" t2." + DBConstants.CODPOSTAL + DaoConstants.BLANK + DBConstants.CODPOSTAL);
		query.append(DaoConstants.FROM + DBConstants.VISTAX54JAPISOLICITANTES + " t1 ");
		query.append(DaoConstants.LEFT_JOIN + DBConstants.VISTAX54JNORA + " t2 ");
		query.append(DaoConstants.ON + " t1.CDIRNORA " + DaoConstants.SIGNOIGUAL + " t2.CDIRNORA ");
		query.append(DaoConstants.WHERE + " t1.DNI " + DaoConstants.SIGNOIGUAL_INTERROGACION);
		params.add(dni);

		List<Direccion> beanList = this.getJdbcTemplate().query(query.toString(), this.getRwMapDirNoraConDni(),
				params.toArray());
		return DataAccessUtils.uniqueResult(beanList);
	}

	@Override
	public DireccionNora obtenerDatosX54JNoraConDirNora(Integer dirNora) {
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder();
		query.append(DaoConstants.SELECT);
		query.append(" t1." + DBConstants.TIPONORA + " " + DBConstants.TIPONORA + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.PAIS + " " + DBConstants.PAIS + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODPAIS + " " + DBConstants.CODPAIS + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CALLE + " " + DBConstants.CALLE + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODCALLE + " " + DBConstants.CODCALLE + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.PORTAL + " " + DBConstants.PORTAL + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODPORTAL + " " + DBConstants.CODPORTAL + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.ESCALERA + " " + DBConstants.ESCALERA + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.PISO + " " + DBConstants.PISO + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.MANO + " " + DBConstants.MANO + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.PUERTA + " " + DBConstants.PUERTA + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.APROX + " " + DBConstants.APROX + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.PROVINCIA + " " + DBConstants.PROVINCIA + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODPROVINCIA + " " + DBConstants.CODPROVINCIA + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.MUNICIPIO + " " + DBConstants.MUNICIPIO + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODMUNICIPIO + " " + DBConstants.CODMUNICIPIO + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.LOCALIDAD + " " + DBConstants.LOCALIDAD + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODLOCALIDAD + " " + DBConstants.CODLOCALIDAD + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.DIRECCION + " " + DBConstants.DIRECCION + DaoConstants.SIGNO_COMA);
		query.append(" t1." + DBConstants.CODPOSTAL + DaoConstants.BLANK + DBConstants.CODPOSTAL);
		query.append(DaoConstants.FROM + DBConstants.VISTAX54JNORA + " t1 ");
		query.append(DaoConstants.WHERE + " t1.CDIRNORA " + DaoConstants.SIGNOIGUAL_INTERROGACION);
		params.add(dirNora);

		List<DireccionNora> beanList = this.getJdbcTemplate().query(query.toString(), this.getRwMapDirNoraConDirNora(),
				params.toArray());
		return DataAccessUtils.uniqueResult(beanList);
	}

}
