package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ConfigDireccionEmail;

/**
 * ConfigDireccionEmailDaoImpl generated by UDA, 05-dic-2017 15:17:18.
 * @author UDA
 */

@Repository
@Transactional
public class ConfigDireccionEmailDaoImpl extends GenericoDaoImpl<ConfigDireccionEmail> implements ConfigDireccionEmailDao {


    public ConfigDireccionEmailDaoImpl() {
		super(ConfigDireccionEmail.class);
	}

	public static final String[] ORDER_BY_WHITE_LIST = new String[] {"ID007", "DIREMAIL007"};
	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<ConfigDireccionEmail> rwMap = new RowMapper<ConfigDireccionEmail>() {
		@Override()
		public ConfigDireccionEmail mapRow(ResultSet resultSet, int rowNum) throws SQLException {
           return new ConfigDireccionEmail(
               resultSet.getInt("ID007"), resultSet.getString("DIREMAIL007")
           );
		}
	};

	private RowMapper<ConfigDireccionEmail> rwMapPK = new RowMapper<ConfigDireccionEmail>() {
		@Override()
		public ConfigDireccionEmail mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ConfigDireccionEmail(
				resultSet.getInt("ID007")
           );
		}
	};

	@Override()
	public ConfigDireccionEmail add(ConfigDireccionEmail configdireccionemail) {
    	String query = "INSERT INTO AA79B07S01 (ID_007, DIR_EMAIL_007) VALUES (?,?)";
		this.getJdbcTemplate().update(query, configdireccionemail.getId(), configdireccionemail.getDirEmail());
		return configdireccionemail;
	}

    @Override()
	public ConfigDireccionEmail update(ConfigDireccionEmail configdireccionemail) {
		String query = "UPDATE AA79B07S01 SET DIR_EMAIL_007=? WHERE ID_007=?";
		this.getJdbcTemplate().update(query, configdireccionemail.getDirEmail(), configdireccionemail.getId());
		return configdireccionemail;
	}

    @Override()
	public void remove(ConfigDireccionEmail configdireccionemail) {
		String query = "DELETE FROM AA79B07S01 WHERE ID_007=?";
		this.getJdbcTemplate().update(query, configdireccionemail.getId());
    }

	@Override()
	protected String getSelect() {
		return "SELECT t1.ID_007 ID007, t1.DIR_EMAIL_007 DIREMAIL007";
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B07S01 t1";
	}

	@Override()
	protected RowMapper<ConfigDireccionEmail> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_007";
	}

	@Override()
	protected RowMapper<ConfigDireccionEmail> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(ConfigDireccionEmail bean, List<Object> params) {
		params.add(bean.getId());
		return " WHERE t1.ID_007 = ?";
	}

	@Override()
	protected String getWhere(ConfigDireccionEmail bean, List<Object> params) {
		StringBuilder where = new StringBuilder(ConfigDireccionEmailDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_007", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("DIR_EMAIL_007", bean.getDirEmail(), params));
		return where.toString();
	}

	@Override()
	protected String getWhereLike(ConfigDireccionEmail bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(ConfigDireccionEmailDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_007", bean.getId(), params));
		where.append(SqlUtils.generarWhereLikeNormalizado("DIR_EMAIL_007", bean.getDirEmail(), params, startsWith));
		return where.toString();
	}
}

