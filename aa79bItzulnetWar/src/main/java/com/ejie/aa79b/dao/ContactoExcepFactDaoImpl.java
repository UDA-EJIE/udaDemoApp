package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ContactoExcepFact;

/**
 * ContactoExcepFactDaoImpl generated by UDA, 29-ene-2018 12:17:36.
 * @author UDA
 */

@Repository
@Transactional
public class ContactoExcepFactDaoImpl extends GenericoDaoImpl<ContactoExcepFact> implements ContactoExcepFactDao {

    private static final String IDEXCEPCION037 = "IDEXCEPCION037";
    private static final String DNITRABAJADOR037 = "DNITRABAJADOR037";

    
    protected static final String[] ORDER_BY_WHITE_LIST = new String[] {IDEXCEPCION037, DNITRABAJADOR037};

    /*
     * ROW_MAPPERS
     */
    private RowMapper<ContactoExcepFact> rwMap = new RowMapper<ContactoExcepFact>() {
        @Override
        public ContactoExcepFact mapRow(ResultSet resultSet, int rowNum) throws SQLException {
           return new ContactoExcepFact(
                   resultSet.getLong(IDEXCEPCION037), resultSet.getString(DNITRABAJADOR037)
           ); 
       } 
    } ; 

    private RowMapper<ContactoExcepFact> rwMapPK = new RowMapper<ContactoExcepFact>() {
        @Override
        public ContactoExcepFact mapRow(ResultSet resultSet, int rowNum) throws SQLException {
            return new ContactoExcepFact(
                resultSet.getLong(IDEXCEPCION037)
            ); 
        } 
    } ;
           
   
          
    public ContactoExcepFactDaoImpl() {
        /* Constructor */
        super(ContactoExcepFact.class);
    }

	/*
	 * OPERACIONES CRUD
	 */

    /**
     * Inserts a single row in the ContactoExcepFact table.
     *
     * @param contactoexcepfact ContactoExcepFact
     * @return ContactoExcepFact
     */
	@Override
    public ContactoExcepFact add(ContactoExcepFact contactoexcepfact) {
    	String query = "INSERT INTO AA79B37S01 (ID_EXCEPCION_037, DNI_TRABAJADOR_037) VALUES (?,?)";
		this.getJdbcTemplate().update(query, contactoexcepfact.getIdExcepcion037(), contactoexcepfact.getDniTrabajador037());
		return contactoexcepfact;
	}

    /**
     * Updates a single row in the ContactoExcepFact table.
     *
     * @param contactoexcepfact ContactoExcepFact
     * @return ContactoExcepFact
     */
    @Override
    public ContactoExcepFact update(ContactoExcepFact contactoexcepfact) {
		String query = "UPDATE AA79B37S01 SET ID_EXCEPCION_037=?, DNI_TRABAJADOR_037=? WHERE ID_037=?";
		this.getJdbcTemplate().update(query, contactoexcepfact.getIdExcepcion037(),contactoexcepfact.getDniTrabajador037());
		return contactoexcepfact;
	}

      

    /**
     * Removes a single row in the ContactoExcepFact table.
     *
     * @param contactoexcepfact ContactoExcepFact
     * @return
     */
    @Override
    public void borraTodosPorIdExcepcion(Long idExcepcion037) {
        String query = "DELETE FROM AA79B37S01 WHERE ID_EXCEPCION_037=?";
        this.getJdbcTemplate().update(query, idExcepcion037);
    } 
    /**
     * The method getQuery.
     * 
     * @return String OJO CON ESTE MÉTOD
     */
    @Override()
    protected String getSelect() {        
        StringBuilder sb = new StringBuilder();

        sb.append("SELECT t1.ID_EXCEPCION_037 IDEXCEPCION037, t1.DNI_TRABAJADOR_037 DNITRABAJADOR037 ");
        
        return sb.toString();
    }

    @Override()
    protected String getFrom() {
        return " FROM AA79B37S01 t1  ";
    }

    @Override()
    protected RowMapper<ContactoExcepFact> getRwMap() {
        return this.rwMap;
    }

    @Override()
    protected String[] getOrderBy() {
        return ContactoExcepFactDaoImpl.ORDER_BY_WHITE_LIST;
    }

    @Override()
    protected String getPK() {
        return "ID_EXCEPCION_037";
    }

    @Override()
    protected RowMapper<ContactoExcepFact> getRwMapPK() {
        return this.rwMapPK;
    }
    
    @Override()
    protected String getWherePK(ContactoExcepFact bean, List<Object> params) {
        params.add(bean.getIdExcepcion037());            
        return "  WHERE t1.ID_EXCEPCION_037 = ?";
    }
	/*
	 * MÉTODOS PRIVADOS
	 */
    @Override()
    protected String getWhere(ContactoExcepFact bean, List<Object> params) {

        StringBuilder where = new StringBuilder(ContactoExcepFactDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual("ID_EXCEPCION_037", bean.getIdExcepcion037(), params));
        where.append(SqlUtils.generarWhereIgual("DNI_TRABAJADOR_037", bean.getDniTrabajador037(), params));
        return where.toString();
    }
    
    @Override
    protected String getWhereLike(ContactoExcepFact bean, Boolean startsWith, List<Object> params,
            Boolean search) {

        StringBuilder whereLike = new StringBuilder(ContactoExcepFactDaoImpl.STRING_BUILDER_INIT);
        whereLike.append(SqlUtils.generarWhereIgual("ID_EXCEPCION_037", bean.getIdExcepcion037(), params));
        whereLike.append(SqlUtils.generarWhereIgual("DNI_TRABAJADOR_037", bean.getDniTrabajador037(), params));
        return whereLike.toString();
    }
    
}

