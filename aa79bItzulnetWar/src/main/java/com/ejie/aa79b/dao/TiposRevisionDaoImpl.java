package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;
import java.util.Locale;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.TiposRevision;

/**
 * TiposRevisionDaoImpl generated by UDA, 28-nov-2017 15:23:30.
 *
 * @author UDA
 */

@Repository
@Transactional
public class TiposRevisionDaoImpl extends GenericoDaoImpl<TiposRevision> implements TiposRevisionDao {

	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

	protected static final String ID_018 = "ID_018";
	protected static final String ID018 = "ID018";
	protected static final String WHERE_1 = " WHERE 1=1 ";
	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { ID018, "DESCES018", "DESCEU018", "OBSERVEU018",
			"OBSERVES018", "ESTADO018", "ESTADODESCEU", "ESTADODESCES", "PORPALABRASREV018", "DESCNORMEU",
			"DESCNORMES", "PORRELREVTRAD018" };

	private RowMapper<TiposRevision> rwMap = new RowMapper<TiposRevision>() {
		@Override()
		public TiposRevision mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			TiposRevision tiposrevision = new TiposRevision(resultSet.getLong(ID018), resultSet.getString("DESCES018"),
					resultSet.getString("DESCEU018"), resultSet.getString("OBSERVEU018"),
					resultSet.getString("OBSERVES018"), resultSet.getString("ESTADO018"),
					resultSet.getLong("PORPALABRASREV018"));

			tiposrevision.setEstadoDescEs(resultSet.getString("ESTADODESCES"));
			tiposrevision.setEstadoDescEu(resultSet.getString("ESTADODESCEU"));
			tiposrevision.setPorRelTradRev018(resultSet.getLong("PORRELREVTRAD018"));
			return tiposrevision;
		}
	};

	private RowMapper<TiposRevision> rwMapPK = new RowMapper<TiposRevision>() {
		@Override()
		public TiposRevision mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new TiposRevision(resultSet.getLong(ID018));
		}
	};

	/**
	 * Constructor de la clase.
	 */
	public TiposRevisionDaoImpl() {
		/* Constructor */
		super(TiposRevision.class);
	}
	/*
	 * OPERACIONES CRUD
	 */

	@Override()
	public TiposRevision add(TiposRevision tiposrevision) {
		String query = "INSERT INTO AA79B18S01 (ID_018, DESC_ES_018, DESC_EU_018, OBSERV_EU_018, OBSERV_ES_018, ESTADO_018, POR_PALABRAS_REV_018, POR_REL_REV_TRAD_018) VALUES (AA79B18Q00.NEXTVAL,?,?,?,?,?,?,?)";

		this.getJdbcTemplate().update(query, tiposrevision.getDescEs018(), tiposrevision.getDescEu018(),
				tiposrevision.getObservEu018(), tiposrevision.getObservEs018(), tiposrevision.getEstado018(),
				tiposrevision.getPorPalabrasRev018(), tiposrevision.getPorRelTradRev018());
		return tiposrevision;
	}

	@Override()
	public TiposRevision update(TiposRevision tiposrevision) {
		String query = "UPDATE AA79B18S01 SET DESC_ES_018=?, DESC_EU_018=?, OBSERV_EU_018=?, OBSERV_ES_018=?, ESTADO_018=?, POR_PALABRAS_REV_018=?, POR_REL_REV_TRAD_018=? WHERE ID_018=?";
		this.getJdbcTemplate().update(query, tiposrevision.getDescEs018(), tiposrevision.getDescEu018(),
				tiposrevision.getObservEu018(), tiposrevision.getObservEs018(), tiposrevision.getEstado018(),
				tiposrevision.getPorPalabrasRev018(), tiposrevision.getPorRelTradRev018(), tiposrevision.getId018());
		return tiposrevision;
	}

	@Override()
	public void remove(TiposRevision tiposrevision) {
		String query = "DELETE FROM AA79B18S01 WHERE ID_018=?";
		this.getJdbcTemplate().update(query, tiposrevision.getId018());
	}

	/**
	 * The method getQuery.
	 *
	 * @return String OJO CON ESTE MÃ‰TOD
	 */
	@Override()
	protected String getSelect() {
		Locale es = new Locale("es");
		Locale eu = new Locale("eu");
		StringBuilder sb = new StringBuilder();

		sb.append("SELECT t1.ID_018 ID018, t1.DESC_EU_018 DESCEU018, t1.DESC_ES_018 DESCES018");
		sb.append(", t1.OBSERV_EU_018 OBSERVEU018, t1.OBSERV_ES_018 OBSERVES018, t1.ESTADO_018 ESTADO018");

		sb.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_EU_018")).append(" AS DESCNORMEU");
		sb.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_ES_018")).append(" AS DESCNORMES");

		sb.append(", DECODE(t1.ESTADO_018, 'A', '").append(this.msg.getMessage("estado.alta", null, es))
				.append("', 'B', '").append(this.msg.getMessage("estado.baja", null, es)).append("') AS ESTADODESCES");
		sb.append(", DECODE(t1.ESTADO_018, 'A', '").append(this.msg.getMessage("estado.alta", null, eu))
				.append("', 'B', '").append(this.msg.getMessage("estado.baja", null, eu)).append("') AS ESTADODESCEU");

		sb.append(", t1.POR_PALABRAS_REV_018 PORPALABRASREV018");
		sb.append(", t1.POR_REL_REV_TRAD_018 PORRELREVTRAD018");
		return sb.toString();
	}

	@Override()
	protected String getFrom() {
		return "  FROM AA79B18S01 t1 ";
	}

	@Override()
	protected RowMapper<TiposRevision> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return TiposRevisionDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return ID_018;
	}

	@Override()
	protected RowMapper<TiposRevision> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(TiposRevision bean, List<Object> params) {
		params.add(bean.getId018());
		return " WHERE t1.ID_018 = ? ";
	}

	@Override
	protected String getWhere(TiposRevision bean, List<Object> params) {

		StringBuilder where = new StringBuilder(TiposRevisionDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual(ID_018, bean.getId018(), params));
		where.append(SqlUtils.generarWhereLikeNormalizado("DESC_ES_018", bean.getDescEs018(), params, false));
		where.append(SqlUtils.generarWhereLikeNormalizado("DESC_EU_018", bean.getDescEu018(), params, false));
		where.append(SqlUtils.generarWhereLikeNormalizado("OBSERV_EU_018", bean.getObservEu018(), params, false));
		where.append(SqlUtils.generarWhereLikeNormalizado("OBSERV_ES_018", bean.getObservEs018(), params, false));
		where.append(SqlUtils.generarWhereIgual("ESTADO_018", bean.getEstado018(), params));
		where.append(SqlUtils.generarWhereIgual("POR_PALABRAS_REV_018", bean.getPorPalabrasRev018(), params));
		where.append(SqlUtils.generarWhereIgual("POR_REL_REV_TRAD_018", bean.getPorRelTradRev018(), params));

		return where.toString();
	}

	@Override
	protected String getWhereLike(TiposRevision bean, Boolean startsWith, List<Object> params, Boolean search) {

		StringBuilder where = new StringBuilder(TiposRevisionDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual(ID_018, bean.getId018(), params));
		where.append(SqlUtils.generarWhereLikeNormalizado("DESC_ES_018", bean.getDescEs018(), params, startsWith));
		where.append(SqlUtils.generarWhereLikeNormalizado("DESC_EU_018", bean.getDescEu018(), params, startsWith));
		where.append(SqlUtils.generarWhereLikeNormalizado("OBSERV_EU_018", bean.getObservEu018(), params, startsWith));
		where.append(SqlUtils.generarWhereLikeNormalizado("OBSERV_ES_018", bean.getObservEs018(), params, startsWith));
		where.append(SqlUtils.generarWhereIgual("ESTADO_018", bean.getEstado018(), params));
		where.append(SqlUtils.generarWhereIgual("POR_PALABRAS_REV_018", bean.getPorPalabrasRev018(), params));
		where.append(SqlUtils.generarWhereIgual("POR_REL_REV_TRAD_018", bean.getPorRelTradRev018(), params));
		return where.toString();
	}

}
