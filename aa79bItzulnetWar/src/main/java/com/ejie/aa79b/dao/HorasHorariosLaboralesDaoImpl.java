package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.HorasHorariosLaborales;

/**
 * HorasHorariosDaoImpl generated by UDA, 39-nov-2017 14:44:52.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class HorasHorariosLaboralesDaoImpl extends GenericoDaoImpl<HorasHorariosLaborales>
        implements HorasHorariosLaboralesDao {

    protected static final String INDVERANO039 = "INDVERANO039";
    protected static final String IDHORARIO039 = "IDHORARIO039";
    protected static final String[] ORDER_BY_WHITE_LIST = new String[] { IDHORARIO039, INDVERANO039, "HORAINILJM039",
            "HORAFINLJM039", "HORAINILJT039", "HORAFINLJT039", "HORAINIVM039", "HORAFINVM039", "HORAINIVT039",
            "HORAFINVT039" };  

    /*
     * ROW_MAPPERS
     */
    private RowMapper<HorasHorariosLaborales> rwMap = new RowMapper<HorasHorariosLaborales>() {
        @Override()
        public HorasHorariosLaborales mapRow(ResultSet resultSet, int rowNum) throws SQLException {

            HorasHorariosLaborales hhaAux = new HorasHorariosLaborales(resultSet.getLong(IDHORARIO039),
                    resultSet.getString(INDVERANO039));
            hhaAux.setHoraIniLjM039(resultSet.getString("HORAINILJM039"));
            hhaAux.setHoraFinLjM039(resultSet.getString("HORAFINLJM039"));
            hhaAux.setHoraIniLjT039(resultSet.getString("HORAINILJT039"));
            hhaAux.setHoraFinLjT039(resultSet.getString("HORAFINLJT039"));
            hhaAux.setHoraIniVM039(resultSet.getString("HORAINIVM039"));
            hhaAux.setHoraFinVM039(resultSet.getString("HORAFINVM039"));
            hhaAux.setHoraIniVT039(resultSet.getString("HORAINIVT039"));
            hhaAux.setHoraFinVT039(resultSet.getString("HORAFINVT039"));
            return hhaAux;
        }
    };

    private RowMapper<HorasHorariosLaborales> rwMapPK = new RowMapper<HorasHorariosLaborales>() {
        @Override()
        public HorasHorariosLaborales mapRow(ResultSet resultSet, int rowNum) throws SQLException {
            return new HorasHorariosLaborales(resultSet.getLong(IDHORARIO039), resultSet.getString(INDVERANO039));
        }
    };
    
    /**
     * Constructor
     */
    public HorasHorariosLaboralesDaoImpl() {
        super(HorasHorariosLaborales.class);
    }
    
    @Override()
    public HorasHorariosLaborales add(HorasHorariosLaborales horashorarios) {
        String query = "INSERT INTO AA79B39S01 (ID_HORARIO_039, IND_VERANO_039, HORA_INI_LJ_M_039, HORA_FIN_LJ_M_039, HORA_INI_LJ_T_039, HORA_FIN_LJ_T_039, HORA_INI_V_M_039, HORA_FIN_V_M_039, HORA_INI_V_T_039, HORA_FIN_V_T_039) VALUES (?,?,?,?,?,?,?,?,?,?)";
        this.getJdbcTemplate().update(query, horashorarios.getIdHorario039(), horashorarios.getIndVerano039(),
                horashorarios.getHoraIniLjM039(), horashorarios.getHoraFinLjM039(), horashorarios.getHoraIniLjT039(),
                horashorarios.getHoraFinLjT039(), horashorarios.getHoraIniVM039(), horashorarios.getHoraFinVM039(),
                horashorarios.getHoraIniVT039(), horashorarios.getHoraFinVT039());
        return horashorarios;
    }

    @Override()
    public HorasHorariosLaborales update(HorasHorariosLaborales horashorarios) {
        String query = "UPDATE AA79B39S01 SET HORA_INI_LJ_M_039=?, HORA_FIN_LJ_M_039=?, HORA_INI_LJ_T_039=?, HORA_FIN_LJ_T_039=?, HORA_INI_V_M_039=?, HORA_FIN_V_M_039=?, HORA_INI_V_T_039=?, HORA_FIN_V_T_039=? WHERE ID_HORARIO_039=? AND IND_VERANO_039=?";
        this.getJdbcTemplate().update(query, horashorarios.getHoraIniLjM039(), horashorarios.getHoraFinLjM039(),
                horashorarios.getHoraIniLjT039(), horashorarios.getHoraFinLjT039(), horashorarios.getHoraIniVM039(),
                horashorarios.getHoraFinVM039(), horashorarios.getHoraIniVT039(), horashorarios.getHoraFinVT039(),
                horashorarios.getIdHorario039(), horashorarios.getIndVerano039());
        return horashorarios;
    }

    @Override()
    public void remove(HorasHorariosLaborales horashorarios) {
        String query = "DELETE FROM AA79B39S01 WHERE ID_HORARIO_039=? AND IND_VERANO_039=?";
        this.getJdbcTemplate().update(query, horashorarios.getIdHorario039(), horashorarios.getIndVerano039());
    }

    @Override()
    protected String getSelect() {
        StringBuilder query = new StringBuilder(
                "SELECT t1.ID_HORARIO_039 IDHORARIO039, t1.IND_VERANO_039 INDVERANO039, t1.HORA_INI_LJ_M_039 HORAINILJM039, t1.HORA_FIN_LJ_M_039 HORAFINLJM039, t1.HORA_INI_LJ_T_039 HORAINILJT039, t1.HORA_FIN_LJ_T_039 HORAFINLJT039, t1.HORA_INI_V_M_039 HORAINIVM039, t1.HORA_FIN_V_M_039 HORAFINVM039, t1.HORA_INI_V_T_039 HORAINIVT039, t1.HORA_FIN_V_T_039 HORAFINVT039 ");
        return query.toString();
    }

    @Override()
    protected String getFrom() {
        return "  FROM AA79B39S01 t1 ";
    }

    @Override()
    protected RowMapper<HorasHorariosLaborales> getRwMap() {
        return this.rwMap;
    }

    @Override()
    protected String[] getOrderBy() {
        return HorasHorariosAtencionDaoImpl.ORDER_BY_WHITE_LIST;
    }

    @Override()
    protected String getPK() {
        return "ID_HORARIO_039 || '_' || IND_VERANO_039";
    }

    @Override()
    protected RowMapper<HorasHorariosLaborales> getRwMapPK() {
        return this.rwMapPK;
    }

    @Override()
    protected String getWherePK(HorasHorariosLaborales bean, List<Object> params) {
        params.add(bean.getIdHorario039());
        params.add(bean.getIndVerano039());
        return "  WHERE t1.ID_HORARIO_039 = ?   AND t1.IND_VERANO_039 = ?";
    }
    /*
     * MÃ‰TODOS PRIVADOS
     */

    @Override()
    protected String getWhere(HorasHorariosLaborales bean, List<Object> params) {

        StringBuilder where = new StringBuilder(HorasHorariosAtencionDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual("ID_039", bean.getIdHorario039(), params));
        where.append(SqlUtils.generarWhereIgual("IND_VERANO_039", bean.getIndVerano039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_M_039", bean.getHoraIniLjM039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_M_039", bean.getHoraFinLjM039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_T_039", bean.getHoraIniLjT039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_T_039", bean.getHoraFinLjT039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_V_M_039", bean.getHoraIniVM039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_V_M_039", bean.getHoraFinVM039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_V_T_039", bean.getHoraIniVT039(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_V_T_039", bean.getHoraFinVT039(), params));
        return where.toString();
    }

    @Override
    protected String getWhereLike(HorasHorariosLaborales bean, Boolean startsWith, List<Object> params,
            Boolean search) {

        StringBuilder whereLike = new StringBuilder(HorasHorariosAtencionDaoImpl.STRING_BUILDER_INIT);
        whereLike.append(SqlUtils.generarWhereIgual("ID_039", bean.getIdHorario039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("IND_VERANO_039", bean.getIndVerano039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_M_039", bean.getHoraIniLjM039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_M_039", bean.getHoraFinLjM039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_T_039", bean.getHoraIniLjT039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_T_039", bean.getHoraFinLjT039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_V_M_039", bean.getHoraIniVM039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_V_M_039", bean.getHoraFinVM039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_V_T_039", bean.getHoraIniVT039(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_V_T_039", bean.getHoraFinVT039(), params));
        // si recibe una lista de ids de HorariosAtencion...
        if (bean.getIdsHorariosLaborales() != null && !bean.getIdsHorariosLaborales().isEmpty()) {
            whereLike.append(SqlUtils.generarWhereIn("t1.ID_HORARIO_039", bean.getIdsHorariosLaborales(), params));
        }
        return whereLike.toString();
    }

}
