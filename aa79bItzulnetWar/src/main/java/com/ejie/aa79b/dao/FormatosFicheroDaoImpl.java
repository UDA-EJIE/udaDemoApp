package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.DBConstants;
import com.ejie.aa79b.common.DaoConstants;
import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.FormatosFichero;

/**
 * FormatosFicheroDaoImpl generated by UDA, 30-nov-2017 10:16:22.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class FormatosFicheroDaoImpl extends GenericoDaoImpl<FormatosFichero> implements FormatosFicheroDao {

	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

	public FormatosFicheroDaoImpl() {
		super(FormatosFichero.class);
	}

	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { DBConstants.ID011, DBConstants.FORMATO011,
			DBConstants.DESCES011, DBConstants.DESCEU011, DBConstants.OBSERVEU011, DBConstants.OBSERVES011,
			DBConstants.ESTADO011, DBConstants.DESCNORMEU, DBConstants.DESCNORMES, DBConstants.ESTADODESCES,
			DBConstants.ESTADODESCEU };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<FormatosFichero> rwMap = new RowMapper<FormatosFichero>() {
		@Override
		public FormatosFichero mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			FormatosFichero formato = new FormatosFichero(resultSet.getLong(DBConstants.ID011),
					resultSet.getString(DBConstants.FORMATO011), resultSet.getString(DBConstants.DESCES011),
					resultSet.getString(DBConstants.DESCEU011), resultSet.getString(DBConstants.OBSERVEU011),
					resultSet.getString(DBConstants.OBSERVES011), resultSet.getString(DBConstants.ESTADO011));

			formato.setEstadoDescEs(resultSet.getString(DBConstants.ESTADODESCES));
			formato.setEstadoDescEu(resultSet.getString(DBConstants.ESTADODESCEU));
			return formato;
		}
	};

	private RowMapper<FormatosFichero> rwMapPK = new RowMapper<FormatosFichero>() {
		@Override
		public FormatosFichero mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new FormatosFichero(resultSet.getLong(DBConstants.ID011));
		}
	};

	@Override
	public FormatosFichero add(FormatosFichero formatosfichero) {
		String query = "INSERT INTO AA79B11S01 (ID_011, FORMATO_011, DESC_ES_011, DESC_EU_011, OBSERV_EU_011, OBSERV_ES_011, ESTADO_011) VALUES (AA79B11Q00.NEXTVAL,?,?,?,?,?,?)";
		this.getJdbcTemplate().update(query, formatosfichero.getFormato011(), formatosfichero.getDescEs011(),
				formatosfichero.getDescEu011(), formatosfichero.getObservEu011(), formatosfichero.getObservEs011(),
				formatosfichero.getEstado011());
		return formatosfichero;
	}

	/**
	 * Updates a single row in the FormatosFichero table.
	 *
	 * @param formatosfichero
	 *            FormatosFichero
	 * @return FormatosFichero
	 */
	@Override
	public FormatosFichero update(FormatosFichero formatosfichero) {
		String query = "UPDATE AA79B11S01 SET FORMATO_011=?, DESC_ES_011=?, DESC_EU_011=?, OBSERV_EU_011=?, OBSERV_ES_011=?, ESTADO_011=? WHERE ID_011=?";
		this.getJdbcTemplate().update(query, formatosfichero.getFormato011(), formatosfichero.getDescEs011(),
				formatosfichero.getDescEu011(), formatosfichero.getObservEu011(), formatosfichero.getObservEs011(),
				formatosfichero.getEstado011(), formatosfichero.getId011());
		return formatosfichero;
	}

	/**
	 * Finds a single row in the FormatosFichero table.
	 *
	 * @param formatosfichero
	 *            FormatosFichero
	 * @return FormatosFichero
	 */

	@Override
	protected String getSelect() {
		Locale es = new Locale("es");
		Locale eu = new Locale("eu");
		StringBuilder selectFormatos = new StringBuilder();

		selectFormatos.append(DaoConstants.SELECT);
		selectFormatos.append("t1.ID_011 ").append(DBConstants.ID011);
		selectFormatos.append(", t1.DESC_EU_011 ").append(DBConstants.DESCEU011);
		selectFormatos.append(", t1.DESC_ES_011 ").append(DBConstants.DESCES011);
		selectFormatos.append(", t1.FORMATO_011 ").append(DBConstants.FORMATO011);
		selectFormatos.append(", t1.OBSERV_EU_011 ").append(DBConstants.OBSERVEU011);
		selectFormatos.append(", t1.OBSERV_ES_011 ").append(DBConstants.OBSERVES011);
		selectFormatos.append(", t1.ESTADO_011 ").append(DBConstants.ESTADO011);
		selectFormatos.append(", DECODE(t1.ESTADO_011, 'A', '").append(this.msg.getMessage("estado.alta", null, es))
				.append("', 'B', '").append(this.msg.getMessage("estado.baja", null, es))
				.append(DaoConstants.SIGNO_APOSTROFO).append(DaoConstants.CERRAR_PARENTESIS).append(DaoConstants.AS)
				.append(DBConstants.ESTADODESCES);
		selectFormatos.append(", DECODE(t1.ESTADO_011, 'A', '").append(this.msg.getMessage("estado.alta", null, eu))
				.append("', 'B', '").append(this.msg.getMessage("estado.baja", null, eu))
				.append(DaoConstants.SIGNO_APOSTROFO).append(DaoConstants.CERRAR_PARENTESIS).append(DaoConstants.AS)
				.append(DBConstants.ESTADODESCEU);
		selectFormatos.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_EU_011")).append(DaoConstants.AS)
				.append(DBConstants.DESCNORMEU);
		selectFormatos.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_ES_011")).append(DaoConstants.AS)
				.append(DBConstants.DESCNORMES);

		return selectFormatos.toString();
	}

	@Override()
	protected String getFrom() {
		StringBuilder from = new StringBuilder();

		from.append(DaoConstants.FROM);
		from.append(DaoConstants.BLANK);
		from.append(DBConstants.TABLA_11);
		from.append(DaoConstants.BLANK);
		from.append(DaoConstants.T1_MINUSCULA);
		from.append(DaoConstants.BLANK);

		return from.toString();
	}

	@Override()
	protected RowMapper<FormatosFichero> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return FormatosFicheroDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return " ID_011 ";
	}

	@Override()
	protected RowMapper<FormatosFichero> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(FormatosFichero bean, List<Object> params) {
		params.add(bean.getId011());
		return " WHERE t1.ID_011 = ? ";
	}

	@Override
	protected String getWhere(FormatosFichero bean, List<Object> params) {
		StringBuilder where = new StringBuilder(FormatosFicheroDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual("t1.ID_011", bean.getId011(), params));

		where.append(SqlUtils.generarWhereIgualCaseInsensitive("t1.FORMATO_011",
				bean.getFormato011() != null ? bean.getFormato011().toUpperCase() : bean.getFormato011(), params));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_011", bean.getDescEu011(), params, false));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_ES_011", bean.getDescEs011(), params, false));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.OBSERV_EU_011", bean.getObservEu011(), params, false));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.OBSERV_ES_011", bean.getObservEs011(), params, false));

		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_011", bean.getEstado011(), params));

		Map<String, Object> mapWhere = new HashMap<String, Object>();
		mapWhere.put("query", where);
		mapWhere.put("params", params);

		return where.toString();
	}

	@Override
	protected String getWhereLike(FormatosFichero bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(FormatosFicheroDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual("t1.ID_011", bean.getId011(), params));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.FORMATO_011", bean.getFormato011(), params, startsWith));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_011", bean.getDescEu011(), params, startsWith));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_ES_011", bean.getDescEs011(), params, startsWith));

		where.append(
				SqlUtils.generarWhereLikeNormalizado("t1.OBSERV_EU_011", bean.getObservEu011(), params, startsWith));

		where.append(
				SqlUtils.generarWhereLikeNormalizado("t1.OBSERV_ES_011", bean.getObservEs011(), params, startsWith));

		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_011", bean.getEstado011(), params));

		Map<String, Object> mapWhere = new HashMap<String, Object>();
		mapWhere.put("query", where);
		mapWhere.put("params", params);

		return where.toString();
	}

}
