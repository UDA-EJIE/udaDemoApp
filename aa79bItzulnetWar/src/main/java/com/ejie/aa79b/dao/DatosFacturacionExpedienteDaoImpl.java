package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.dao.mapper.DatosFacturacionExpedienteRowMapper;
import com.ejie.aa79b.model.ExpedienteInterpretacion;
import com.ejie.aa79b.model.ExpedienteTradRev;

/**
 * DatosFacturacionExpedienteDaoImpl generated by UDA, 28-nov-2017 15:23:30.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class DatosFacturacionExpedienteDaoImpl extends GenericoDaoImpl<ExpedienteTradRev>
		implements DatosFacturacionExpedienteDao {

	protected static final String ANYO_097 = "ANYO_097";
	protected static final String NUM_EXP_097 = "NUM_EXP_097";
	protected static final String IMPORTE_URGENCIA_097 = "IMPORTE_URGENCIA_097";

	protected static final String WHERE_1 = " WHERE 1=1 ";
	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { ANYO_097, NUM_EXP_097,
			"NUM_TOTAL_PAL_FACTURAR_097", "NUM_PAL_CONCOR_0_84_097", "NUM_PAL_CONCOR_85_94_097",
			"NUM_PAL_CONCOR_95_100_097", "ID_ORDEN_097", "IMPORTE_BASE_097", "IMPORTE_IVA_097", "IMPORTE_TOTAL_097",
			"IMPORTE_DIFICULTAD_097", IMPORTE_URGENCIA_097 };

	private RowMapper<ExpedienteTradRev> rwMap = new DatosFacturacionExpedienteRowMapper();

	private RowMapper<ExpedienteTradRev> rwMapPK = new RowMapper<ExpedienteTradRev>() {
		@Override
		public ExpedienteTradRev mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			return new ExpedienteTradRev(resultSet.getLong(ANYO_097), resultSet.getInt(NUM_EXP_097));
		}
	};

	/**
	 * Constructor de la clase.
	 */
	public DatosFacturacionExpedienteDaoImpl() {
		/* Constructor */
		super(ExpedienteTradRev.class);
	}
	/*
	 * OPERACIONES CRUD
	 */

	@Override()
	public ExpedienteTradRev add(ExpedienteTradRev expedienteTradRev) {

		String query = "INSERT INTO AA79B97S01 (ANYO_097, NUM_EXP_097, NUM_TOTAL_PAL_FACTURAR_097, NUM_PAL_CONCOR_0_84_097, NUM_PAL_CONCOR_85_94_097, NUM_PAL_CONCOR_95_100_097, ID_ORDEN_097, TARIFA_PAL_097, POR_IVA_097, IMPORTE_DIFICULTAD_097, IMPORTE_URGENCIA_097, IMPORTE_BASE_097, IMPORTE_IVA_097, IMPORTE_TOTAL_097, IND_REVISADO_097) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
		this.getJdbcTemplate().update(query, expedienteTradRev.getAnyo(), expedienteTradRev.getNumExp(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumTotalPalFacturar(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor084(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor8594(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor95100(),
				expedienteTradRev.getDatosFacturacionExpediente().getIdOrden(),
				expedienteTradRev.getDatosFacturacionExpediente().getTarifaPal(),
				expedienteTradRev.getDatosFacturacionExpediente().getPorcentajeIva(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteDificultad(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteUrgencia(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteBase(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteIva(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteTotal(),
				expedienteTradRev.getDatosFacturacionExpediente().getIndRevisado());
		return expedienteTradRev;
	}

	@Override
	public int updateReturnInt(ExpedienteTradRev expedienteTradRev) {
		String query = "UPDATE AA79B97S01 SET NUM_TOTAL_PAL_FACTURAR_097=?, NUM_PAL_CONCOR_0_84_097=?, NUM_PAL_CONCOR_85_94_097=?, NUM_PAL_CONCOR_95_100_097=?, ID_ORDEN_097=?, TARIFA_PAL_097=?, POR_IVA_097=?, IMPORTE_DIFICULTAD_097=?, IMPORTE_URGENCIA_097=?, IMPORTE_BASE_097=?, IMPORTE_IVA_097=?, IMPORTE_TOTAL_097=?, IND_REVISADO_097=? WHERE ANYO_097=? AND NUM_EXP_097=?";
		return this.getJdbcTemplate().update(query,
				expedienteTradRev.getDatosFacturacionExpediente().getNumTotalPalFacturar(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor084(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor8594(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor95100(),
				expedienteTradRev.getDatosFacturacionExpediente().getIdOrden(),
				expedienteTradRev.getDatosFacturacionExpediente().getTarifaPal(),
				expedienteTradRev.getDatosFacturacionExpediente().getPorcentajeIva(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteDificultad(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteUrgencia(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteBase(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteIva(),
				expedienteTradRev.getDatosFacturacionExpediente().getImporteTotal(),
				expedienteTradRev.getDatosFacturacionExpediente().getIndRevisado(), expedienteTradRev.getAnyo(),
				expedienteTradRev.getNumExp());
	}

	@Override
	public ExpedienteTradRev update(ExpedienteTradRev expedienteTradRev) {
		String query = "UPDATE AA79B97S01 SET NUM_TOTAL_PAL_FACTURAR_097=?, NUM_PAL_CONCOR_0_84_097=?, NUM_PAL_CONCOR_85_94_097=?, NUM_PAL_CONCOR_95_100_097=? WHERE ANYO_097=? AND NUM_EXP_097=?";
		this.getJdbcTemplate().update(query, expedienteTradRev.getDatosFacturacionExpediente().getNumTotalPalFacturar(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor084(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor8594(),
				expedienteTradRev.getDatosFacturacionExpediente().getNumPalConcor95100(), expedienteTradRev.getAnyo(),
				expedienteTradRev.getNumExp());
		return expedienteTradRev;
	}

	@Override()
	public void remove(ExpedienteTradRev expedienteTradRev) {
		String query = "DELETE FROM AA79B97S01 WHERE ANYO_097=? AND NUM_EXP_097=?";
		this.getJdbcTemplate().update(query, expedienteTradRev.getAnyo(), expedienteTradRev.getNumExp());
	}

	/**
	 * The method getQuery.
	 * 
	 * @return String OJO CON ESTE MÃ‰TOD
	 */
	@Override()
	protected String getSelect() {
		StringBuilder sb = new StringBuilder();
		sb.append("SELECT ANYO_097 ANYO_097, " + "NUM_EXP_097, " + "NUM_TOTAL_PAL_FACTURAR_097, "
				+ "NUM_PAL_CONCOR_0_84_097, " + "NUM_PAL_CONCOR_85_94_097," + "NUM_PAL_CONCOR_95_100_097,"
				+ "ID_ORDEN_097, " + "IMPORTE_BASE_097, " + "IMPORTE_IVA_097, " + "IMPORTE_TOTAL_097, "
				+ "IMPORTE_DIFICULTAD_097, " + IMPORTE_URGENCIA_097);
		return sb.toString();
	}

	@Override()
	protected String getFrom() {
		return "  FROM AA79B97S01 t1 ";
	}

	@Override()
	protected RowMapper<ExpedienteTradRev> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return DatosFacturacionExpedienteDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ANYO_097, NUM_EXP_097";
	}

	@Override()
	protected RowMapper<ExpedienteTradRev> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(ExpedienteTradRev bean, List<Object> params) {
		params.add(bean.getAnyo());
		params.add(bean.getNumExp());
		return " WHERE ANYO_097 = ? AND NUM_EXP_097=? ";
	}

	@Override
	protected String getWhere(ExpedienteTradRev bean, List<Object> params) {

		StringBuilder where = new StringBuilder(DatosFacturacionExpedienteDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual(ANYO_097, bean.getDatosFacturacionExpediente().getAnyo(), params));
		where.append(SqlUtils.generarWhereIgual(NUM_EXP_097, bean.getDatosFacturacionExpediente().getNumExp(), params));

		return where.toString();
	}

	@Override
	protected String getWhereLike(ExpedienteTradRev bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(DatosFacturacionExpedienteDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual(ANYO_097, bean.getDatosFacturacionExpediente().getAnyo(), params));
		where.append(SqlUtils.generarWhereIgual(NUM_EXP_097, bean.getDatosFacturacionExpediente().getNumExp(), params));
		return where.toString();
	}

	@Override
	public int updateDatosFactInter(ExpedienteInterpretacion expedienteInterpretacion, Long anyo, Integer numExp) {
		String query = "UPDATE AA79BA3S01 SET NUM_INTERPRETES_0A3=?, HORAS_INTERPRETACION_0A3=?, IMPORTE_BASE_0A3=?, IMPORTE_IVA_0A3=?, IMPORTE_TOTAL_0A3=?, IND_REVISADO_0A3=? WHERE ANYO_0A3=? AND NUM_EXP_0A3=?";
		return this.getJdbcTemplate().update(query, expedienteInterpretacion.getDatosFacturacion().getNumInterpretes(),
				expedienteInterpretacion.getDatosFacturacion().getHorasInterpretacion(),
				expedienteInterpretacion.getDatosFacturacion().getImporteBase(),
				expedienteInterpretacion.getDatosFacturacion().getImporteIva(),
				expedienteInterpretacion.getDatosFacturacion().getImporteTotal(),
				expedienteInterpretacion.getDatosFacturacion().getIndRevisado(), anyo, numExp);
	}

}
