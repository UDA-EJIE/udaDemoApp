package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.apache.commons.lang.StringUtils;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.Constants;
import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ConfigLibroRegistro;

/**
 * LibroRegistroDaoImpl generated by UDA, 05-dic-2017 10:05:03.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class ConfigLibroRegistroDaoImpl extends GenericoDaoImpl<ConfigLibroRegistro> implements ConfigLibroRegistroDao {

	/**
	 * Constructor
	 */
	public ConfigLibroRegistroDaoImpl() {
		super(ConfigLibroRegistro.class);
	}
	
	public static final String[] ORDER_BY_WHITE_LIST = new String[] { "ID016", "INDACTIVO016" };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<ConfigLibroRegistro> rwMap = new RowMapper<ConfigLibroRegistro>() {
		@Override()
		public ConfigLibroRegistro mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			ConfigLibroRegistro libroRegistro = new ConfigLibroRegistro();
			libroRegistro.setId(resultSet.getInt("ID016"));
			libroRegistro.setIndActivo(resultSet.getString("INDACTIVO016"));
			return libroRegistro;
		}
	};

	private RowMapper<ConfigLibroRegistro> rwMapPK = new RowMapper<ConfigLibroRegistro>() {
		@Override()
		public ConfigLibroRegistro mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ConfigLibroRegistro(resultSet.getInt("ID016"));
		}
	};

	/**
	 * Updates a single row in the LibroRegistro table.
	 *
	 * @param libroregistro
	 *            LibroRegistro
	 * @return LibroRegistro
	 */
	@Override()
	public ConfigLibroRegistro update(ConfigLibroRegistro libroregistro) {
		if (StringUtils.isBlank(libroregistro.getIndActivo())) {
			libroregistro.setIndActivo(Constants.NO);
		}
		String query = "UPDATE AA79B16S01 SET IND_ACTIVO_016=? WHERE ID_016=?";
		this.getJdbcTemplate().update(query, libroregistro.getIndActivo(), libroregistro.getId());
		return libroregistro;
	}




	@Override()
	protected String getSelect() {
		StringBuilder query = new StringBuilder("SELECT  t1.ID_016 ID016, t1.IND_ACTIVO_016 INDACTIVO016");
	return query.toString();
	}

	@Override
	protected String getFrom() {
		return " FROM AA79B16S01 t1";
	}

	@Override()
	protected RowMapper<ConfigLibroRegistro> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ConfigLibroRegistroDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_016";
	}

	@Override()
	protected RowMapper<ConfigLibroRegistro> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(ConfigLibroRegistro bean, List<Object> params) {
		params.add(bean.getId());
		return " WHERE t1.ID_016 = ?";
	}

	@Override()
	protected String getWhere(ConfigLibroRegistro bean, List<Object> params) {
		StringBuilder where = new StringBuilder(ConfigLibroRegistroDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("t1.ID_016", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("t1.IND_ACTIVO_016", bean.getIndActivo(), params));
		return where.toString();
	}

	@Override()
	protected String getWhereLike(ConfigLibroRegistro bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(ConfigLibroRegistroDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("t1.ID_016", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("t1.IND_ACTIVO_016", bean.getIndActivo(), params));
		return where.toString();
	}
}
