package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;
import java.util.Locale;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.i18n.LocaleContextHolder;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.TiposAviso;
import com.ejie.aa79b.model.enums.DestinatarioEnum;

/**
 * TiposAvisoDaoImpl generated by UDA, 05-dic-2017 15:17:18.
 * @author UDA
 */

@Repository()
@Transactional()
public class TiposAvisoDaoImpl extends GenericoDaoImpl<TiposAviso> implements TiposAvisoDao {

	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

    public TiposAvisoDaoImpl() {
		super(TiposAviso.class);
	}

	public static final String[] ORDER_BY_WHITE_LIST = new String[] {"ID_041", "DESC_ES_041", "DESC_EU_041", "DESTINATARIO041", "ESTADO_041"};

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<TiposAviso> rwMap = new RowMapper<TiposAviso>() {
		@Override()
		public TiposAviso mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			TiposAviso bean = new TiposAviso();
			bean.setId(resultSet.getLong("ID041"));
			bean.setDescEs(resultSet.getString("DESCES041"));
			bean.setDescEu(resultSet.getString("DESCEU041"));
			bean.setDestinatario(resultSet.getInt("DESTINATARIO041"));
			bean.setDestinatarioDesc(resultSet.getString("DESTINATARIODESC"));
			bean.setEstado(resultSet.getString("ESTADO041"));
           return bean;
		} 
	};

	private RowMapper<TiposAviso> rwMapPK = new RowMapper<TiposAviso>() {
		@Override()
		public TiposAviso mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			TiposAviso bean = new TiposAviso();
			bean.setId(resultSet.getLong("ID041"));
           return bean;
		}
	};

	@Override()
	public TiposAviso add(TiposAviso tiposaviso) {
    	String query = "INSERT INTO AA79B41S01 (ID_041, DESC_ES_041, DESC_EU_041, DESTINATARIO_041, ESTADO_041) VALUES (?,?,?,?,?)";
		this.getJdbcTemplate().update(query, tiposaviso.getId(), tiposaviso.getDescEs(), tiposaviso.getDescEu(), tiposaviso.getDestinatario(), tiposaviso.getEstado());
		return tiposaviso;
	}

    @Override()
	public TiposAviso update(TiposAviso tiposaviso) {
		String query = "UPDATE AA79B41S01 SET DESC_ES_041=?, DESC_EU_041=?, DESTINATARIO_041=?, ESTADO_041=? WHERE ID_041=?";
		this.getJdbcTemplate().update(query,tiposaviso.getDescEs(), tiposaviso.getDescEu(), tiposaviso.getDestinatario(), tiposaviso.getEstado(), tiposaviso.getId());
		return tiposaviso;
	}

    @Override()
	public void remove(TiposAviso tiposaviso) {
		String query = "DELETE FROM AA79B41S01 WHERE ID_041=?";
		this.getJdbcTemplate().update(query, tiposaviso.getId());
    }

	@Override()
	protected String getSelect() {
		Locale locale = LocaleContextHolder.getLocale();
		StringBuilder selectTiposAviso = new StringBuilder();
		selectTiposAviso.append("SELECT ID_041 ID041, DESC_ES_041 DESCES041, DESC_EU_041 DESCEU041, DESTINATARIO_041 DESTINATARIO041, ESTADO_041 ESTADO041");
		selectTiposAviso.append(", CASE DESTINATARIO_041");
		for (DestinatarioEnum destinatario : DestinatarioEnum.values()) {
			selectTiposAviso.append(" WHEN ").append(destinatario.getValue()).append(" THEN '").append(this.msg.getMessage(destinatario.getLabel(), null, locale)).append("'");
		}
		selectTiposAviso.append(" ELSE NULL END DESTINATARIODESC");
		return selectTiposAviso.toString();
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B41S01 t1";
	}

	@Override()
	protected RowMapper<TiposAviso> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_041";
	}

	@Override()
	protected RowMapper<TiposAviso> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(TiposAviso bean, List<Object> params) {
		params.add(bean.getId());
		return " WHERE t1.ID_041 = ?";
	}

	@Override()
	protected String getWhere(TiposAviso bean, List<Object> params) {
		StringBuilder where = new StringBuilder(TiposAvisoDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_041", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("DESC_ES_041", bean.getDescEs(), params));
		where.append(SqlUtils.generarWhereIgual("DESC_EU_041", bean.getDescEu(), params));
		where.append(SqlUtils.generarWhereIgual("DESTINATARIO041", bean.getDestinatario(), params));
		where.append(SqlUtils.generarWhereIgual("ESTADO_041", bean.getEstado(), params));
		return where.toString();
	}

	@Override()
	protected String getWhereLike(TiposAviso bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(TiposAvisoDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_041", bean.getId(), params));
		where.append(SqlUtils.generarWhereLikeNormalizado("DESC_ES_041", bean.getDescEs(), params, startsWith));
		where.append(SqlUtils.generarWhereLikeNormalizado("DESC_EU_041", bean.getDescEu(), params, startsWith));
		where.append(SqlUtils.generarWhereIgual("DESTINATARIO041", bean.getDestinatario(), params));
		where.append(SqlUtils.generarWhereIgual("ESTADO_041", bean.getEstado(), params));
		return where.toString();
	}
}

