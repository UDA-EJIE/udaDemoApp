package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.apache.commons.lang.StringUtils;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.Constants;
import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ConfigPagoProveedores;

/**
 * ConfigPagoProveedoresDaoImpl generated by UDA, 05-dic-2017 15:17:18.
 * @author UDA
 */

@Repository
@Transactional
public class ConfigPagoProveedoresDaoImpl extends GenericoDaoImpl<ConfigPagoProveedores> implements ConfigPagoProveedoresDao {


    public ConfigPagoProveedoresDaoImpl() {
		super(ConfigPagoProveedores.class);
	}

	public static final String[] ORDER_BY_WHITE_LIST = new String[] {"ID005", "PORIVA005", "FECHADESDE005", "FECHAHASTA005", "VIGENTE005"};

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<ConfigPagoProveedores> rwMap = new RowMapper<ConfigPagoProveedores>() {
		@Override()
		public ConfigPagoProveedores mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			ConfigPagoProveedores bean = new ConfigPagoProveedores();
			bean.setId(resultSet.getLong("ID005"));
			bean.setPorIva(resultSet.getLong("PORIVA005"));
			bean.setFechaDesde(resultSet.getDate("FECHADESDE005"));
			bean.setFechaHasta(resultSet.getDate("FECHAHASTA005"));
			bean.setVigente(resultSet.getString("VIGENTE005"));
           return bean;
		}
	};

	private RowMapper<ConfigPagoProveedores> rwMapPK = new RowMapper<ConfigPagoProveedores>() {
		@Override()
		public ConfigPagoProveedores mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ConfigPagoProveedores(resultSet.getLong("ID005"));
		}
	};

	@Override()
	public ConfigPagoProveedores add(ConfigPagoProveedores bean) {
		bean.setId(this.getNextVal("AA79B05Q00"));
		if (StringUtils.isBlank(bean.getVigente())) {
			bean.setVigente(Constants.NO);
		}
    	String query = "INSERT INTO AA79B05S01 (ID_005, POR_IVA_005, FECHA_DESDE_005, FECHA_HASTA_005, VIGENTE_005) VALUES (?,?,?,?,?)";
		this.getJdbcTemplate().update(query, bean.getId(), bean.getPorIva(), bean.getFechaDesde(), bean.getFechaHasta(), bean.getVigente());
		return bean;
	}

    @Override()
	public ConfigPagoProveedores update(ConfigPagoProveedores bean) {
		String query = "UPDATE AA79B05S01 SET POR_IVA_005=?, FECHA_DESDE_005=?, FECHA_HASTA_005=?, VIGENTE_005=? WHERE ID_005=?";
		if (StringUtils.isBlank(bean.getVigente())) {
			bean.setVigente(Constants.NO);
		}
		this.getJdbcTemplate().update(query, bean.getPorIva(), bean.getFechaDesde(), bean.getFechaHasta(), bean.getVigente(), bean.getId());
		return bean;
	}
    
    @Override()
    public void updateVigente(ConfigPagoProveedores bean) {
    	String query = "UPDATE AA79B05S01 SET VIGENTE_005=? WHERE ID_005!=?";
    	this.getJdbcTemplate().update(query, Constants.NO, bean.getId());
    }

    @Override()
	public void remove(ConfigPagoProveedores bean) {
		String query = "DELETE FROM AA79B05S01 WHERE ID_005=?";
		this.getJdbcTemplate().update(query, bean.getId());
    }

	@Override()
	protected String getSelect() {
		return "SELECT t1.ID_005 ID005, t1.POR_IVA_005 PORIVA005, t1.FECHA_DESDE_005 FECHADESDE005, t1.FECHA_HASTA_005 FECHAHASTA005, VIGENTE_005 VIGENTE005";
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B05S01 t1";
	}

	@Override()
	protected RowMapper<ConfigPagoProveedores> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_005";
	}

	@Override()
	protected RowMapper<ConfigPagoProveedores> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(ConfigPagoProveedores bean, List<Object> params) {
		params.add(bean.getId());
		return " WHERE t1.ID_005 = ?";
	}

	@Override()
	protected String getWhere(ConfigPagoProveedores bean, List<Object> params) {
		StringBuilder where = new StringBuilder(ConfigPagoProveedoresDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_005", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("POR_IVA_005", bean.getPorIva(), params));
		where.append(SqlUtils.generarWhereIgual("FECHA_DESDE_005", bean.getFechaDesde(), params));
		where.append(SqlUtils.generarWhereIgual("FECHA_HASTA_005", bean.getFechaHasta(), params));
		where.append(SqlUtils.generarWhereIgual("VIGENTE_005", bean.getVigente(), params));
		return where.toString();
	}

	@Override()
	protected String getWhereLike(ConfigPagoProveedores bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder whereLike = new StringBuilder(ConfigPagoProveedoresDaoImpl.STRING_BUILDER_INIT);
		whereLike.append(SqlUtils.generarWhereIgual("ID_005", bean.getId(), params));
		whereLike.append(SqlUtils.generarWhereIgual("POR_IVA_005", bean.getPorIva(), params));
		whereLike.append(SqlUtils.generarWhereIgual("FECHA_DESDE_005", bean.getFechaDesde(), params));
		whereLike.append(SqlUtils.generarWhereIgual("FECHA_HASTA_005", bean.getFechaHasta(), params));
		whereLike.append(SqlUtils.generarWhereIgual("VIGENTE_005", bean.getVigente(), params));
		return whereLike.toString();
	}
}

