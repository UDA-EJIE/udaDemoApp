package com.ejie.aa79b.service;

import java.util.LinkedHashMap;
import java.util.Locale;
import java.util.Map;

import org.apache.commons.lang.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.stereotype.Service;

import com.ejie.aa79b.common.Constants;
import com.ejie.aa79b.dao.CuantiaInterDao;
import com.ejie.aa79b.dao.GenericoDao;
import com.ejie.aa79b.dao.RegistroAccionesDao;
import com.ejie.aa79b.model.CuantiaInter;
import com.ejie.aa79b.model.RegistroAcciones;
import com.ejie.aa79b.utils.Utils;

/**
 * CuantiaInterServiceImpl generated by UDA, 15-dic-2017 14:11:45.
 * 
 * @author UDA
 */

@Service(value = "cuantiaInterService")
public class CuantiaInterServiceImpl extends GenericoServiceImpl<CuantiaInter> implements CuantiaInterService {

    protected static final String PRECIOMEDJORN = "label.precioMedJornada";
    protected static final String PRECIOJORN = "label.precioJornada"; 
    protected static final String PRECIOHORAOFRAC = "label.precioHoraOFrac";
    protected static final String ORDENPRECIOSPUBLICOS = "menu.ordenPreciosPublicos";
    protected static final String NOENCAE = "label.noencae";
    protected static final String ENCAE = "label.encae";
    
    protected static final String MEDIAJORNADA = "label.mediaJornada";
    protected static final String JORNADACOMPLETA = "label.jornadaCompleta";
    protected static final String HORASDESDE = "label.horasDesde";
    protected static final String HORASINCLUSIVE = "label.horasInclusive";
    protected static final String Y = "comun.y";

    
     
    @Autowired
    private CuantiaInterDao cuantiaInterDao;
    @Autowired()
    private RegistroAccionesDao registroAccionesDao;
    @Autowired()
    private ReloadableResourceBundleMessageSource msg;
    
    @Override
    protected GenericoDao<CuantiaInter> getDao() {
        return this.cuantiaInterDao;
    }

    @Override()
    public CuantiaInter add(CuantiaInter bean) {
             
        CuantiaInter cuantiaInterAux = this.cuantiaInterDao.add(bean);
        
        RegistroAcciones regAcciones = new RegistroAcciones();
        regAcciones.setIdPuntoMenu(Constants.PUNTO_MENU_ORDEN_PRECIOS);
        regAcciones.setIdAccion(Constants.ACCION_ALTA);
        Locale locale = new Locale(Constants.LANG_EUSKERA);
        
        StringBuilder observ = new StringBuilder();
        
        observ.append(this.msg.getMessage(ORDENPRECIOSPUBLICOS, null, locale)).append(" id: ").append(cuantiaInterAux.getIdOrden()).append(" \n");
        observ.append(this.msg.getMessage("label.cuantias.serviciosInterpretacion", null, locale)).append(": \n");
        
        observ.append(this.msg.getMessage(JORNADACOMPLETA, null, locale)+", ").append(this.msg.getMessage(HORASDESDE, null, locale)).append(": ").append(cuantiaInterAux.getJornCompHorasDesde()).append(". ");
        observ.append(this.msg.getMessage(JORNADACOMPLETA, null, locale)+", ").append(this.msg.getMessage(HORASINCLUSIVE, null, locale)).append(": ").append(cuantiaInterAux.getJornCompHorasHasta()).append(" \n");
        observ.append(this.msg.getMessage(MEDIAJORNADA, null, locale)+", ").append(this.msg.getMessage(HORASDESDE, null, locale)).append(": ").append(cuantiaInterAux.getJornMediaHorasDesde()).append(". ");
        observ.append(this.msg.getMessage(MEDIAJORNADA, null, locale)+", ").append(this.msg.getMessage(HORASINCLUSIVE, null, locale)).append(": ").append(cuantiaInterAux.getJornMediaHorasHasta()).append(" \n");
        
        observ.append(this.msg.getMessage("label.precioMinInterp", null, locale)+", ").append(this.msg.getMessage(ENCAE, null, locale)).append(": ").append(cuantiaInterAux.getPrecMinCae()).append(". ");
        observ.append(this.msg.getMessage("label.precioMinInterp", null, locale)+", ").append(this.msg.getMessage(NOENCAE, null, locale)).append(": ").append(cuantiaInterAux.getPrecMinNoCae()).append(" \n");
        observ.append(this.msg.getMessage("label.interpretacionReunion", null, locale)+", ").append(this.msg.getMessage(ENCAE, null, locale)).append(": ").append(cuantiaInterAux.getPrecHoraReunionCae()).append(". ");
        observ.append(this.msg.getMessage("label.interpretacionReunion", null, locale)+", ").append(this.msg.getMessage(NOENCAE, null, locale)).append(": ").append(cuantiaInterAux.getPrecHoraReunionNoCae()).append(" \n");
        
        observ.append(this.msg.getMessage("label.congresosPluriling", null, locale)+": ").append(this.msg.getMessage(PRECIOJORN, null, locale)).append(": ").append(cuantiaInterAux.getPrecJornCongresoEu()).append(". ");
        observ.append(this.msg.getMessage(PRECIOMEDJORN, null, locale)).append(": ").append(cuantiaInterAux.getPrecMediaCongresoEu()).append(". ");
        observ.append(this.msg.getMessage(PRECIOHORAOFRAC, null, locale)).append(": ").append(cuantiaInterAux.getPrecHoraCongresoEu()).append(". \n");
        
        observ.append(this.msg.getMessage("label.congresosPlurilingNoEus", null, locale)+": ").append(this.msg.getMessage(PRECIOJORN, null, locale)).append(": ").append(cuantiaInterAux.getPrecJornCongresoNoEu()).append(". ");
        observ.append(this.msg.getMessage(PRECIOMEDJORN, null, locale)).append(": ").append(cuantiaInterAux.getPrecMediaCongresoNoEu()).append(". ");
        observ.append(this.msg.getMessage(PRECIOHORAOFRAC, null, locale)).append(": ").append(cuantiaInterAux.getPrecHoraCongresoNoEu()).append(". \n");              
                      
        regAcciones.setObserv(observ.toString());
        this.registroAccionesDao.add(regAcciones);        
        
        return cuantiaInterAux;
    }

    @Override()
    public CuantiaInter update(CuantiaInter bean) {
        CuantiaInter original = this.cuantiaInterDao.find(bean);
        
        CuantiaInter cuantiaInterAux =  this.cuantiaInterDao.update(bean);
        
        RegistroAcciones regAcciones = new RegistroAcciones();
        regAcciones.setIdPuntoMenu(Constants.PUNTO_MENU_ORDEN_PRECIOS);
        regAcciones.setIdAccion(Constants.ACCION_MODIFICACION);
        
        Map<String, String> paramAcciones = new LinkedHashMap<String, String>();
        paramAcciones.put("idOrden", ORDENPRECIOSPUBLICOS);
        paramAcciones.put("jornCompHorasDesde", HORASDESDE);
        paramAcciones.put("jornCompHorasHasta", HORASINCLUSIVE);
        paramAcciones.put("jornMediaHorasDesde", HORASDESDE);
        paramAcciones.put("jornMediaHorasHasta", HORASINCLUSIVE);
        paramAcciones.put("precMinCae", ENCAE);
        paramAcciones.put("precMinNoCae", NOENCAE);
        paramAcciones.put("precHoraReunionCae", ENCAE);
        paramAcciones.put("precHoraReunionNoCae", NOENCAE);
        paramAcciones.put("precJornCongresoEu", PRECIOJORN);
        paramAcciones.put("precMediaCongresoEu", PRECIOMEDJORN);
        paramAcciones.put("precHoraCongresoEu", PRECIOHORAOFRAC);
        paramAcciones.put("precJornCongresoNoEu", PRECIOJORN);
        paramAcciones.put("precMediaCongresoNoEu", PRECIOMEDJORN);
        paramAcciones.put("precHoraCongresoNoEu", PRECIOHORAOFRAC);
        
        Locale locale = new Locale(Constants.LANG_EUSKERA);
        String aux = Utils.observacionesRegistro(bean, original, paramAcciones, this.msg, locale);
        if (StringUtils.isNotBlank(aux)) {
            StringBuilder observ = new StringBuilder();
            observ.append(this.msg.getMessage(ORDENPRECIOSPUBLICOS, null, locale)).append(" id: ").append(original.getIdOrden()).append(" \n");
            observ.append(this.msg.getMessage("label.cuantias.serviciosInterpretacion", null, locale)).append(": \n");
            observ.append(aux);
            regAcciones.setObserv(observ.toString());
            this.registroAccionesDao.add(regAcciones);
        }
        
        return cuantiaInterAux;
    }
    
}