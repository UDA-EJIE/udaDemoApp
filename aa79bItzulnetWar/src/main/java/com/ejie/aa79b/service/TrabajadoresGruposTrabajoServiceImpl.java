package com.ejie.aa79b.service;

import java.util.List;
import java.util.Locale;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.Constants;
import com.ejie.aa79b.dao.GenericoDao;
import com.ejie.aa79b.dao.PersonalIZODao;
import com.ejie.aa79b.dao.RegistroAccionesDao;
import com.ejie.aa79b.dao.TrabajadoresGruposTrabajoDao;
import com.ejie.aa79b.model.RegistroAcciones;
import com.ejie.aa79b.model.TrabajadoresGruposTrabajo;

/**
 * TrabajadoresGruposTrabajoServiceImpl generated by UDA, 24-nov-2017 10:10:29.
 * 
 * @author UDA
 */

@Service(value = "trabajadoresGruposTrabajoService")
public class TrabajadoresGruposTrabajoServiceImpl extends GenericoServiceImpl<TrabajadoresGruposTrabajo>
		implements TrabajadoresGruposTrabajoService {

	@Autowired()
	private TrabajadoresGruposTrabajoDao trabajadoresGruposTrabajoDao;
	@Autowired()
	private RegistroAccionesDao registroAccionesDao;
	@Autowired()
	private PersonalIZODao personalIZODao;
	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

	@Override()
	protected GenericoDao<TrabajadoresGruposTrabajo> getDao() {
		return this.trabajadoresGruposTrabajoDao;
	}

	@Override()
	@Transactional(rollbackFor = Throwable.class)
	public TrabajadoresGruposTrabajo add(TrabajadoresGruposTrabajo bean) {
		super.add(bean);
		this.personalIZODao.guardarFoto(bean);

		TrabajadoresGruposTrabajo original = this.trabajadoresGruposTrabajoDao.find(bean);

		RegistroAcciones regGruposTrabajo = new RegistroAcciones();
		regGruposTrabajo.setIdPuntoMenu(Constants.PUNTO_MENU_GESTION_GRUPOS);
		regGruposTrabajo.setIdAccion(Constants.ACCION_MODIFICACION);
		Locale locale = new Locale(Constants.LANG_EUSKERA);
		StringBuilder aux = new StringBuilder();
		aux.append(this.msg.getMessage("label.asociarTrabajador", null, locale)).append(": ");
		aux.append(original.getDniCompleto()).append(" - ").append(original.getNombreCompleto());
		regGruposTrabajo.setObserv(aux.toString());
		this.registroAccionesDao.add(regGruposTrabajo);

		return bean;
	}

	@Override()
	@Transactional(rollbackFor = Throwable.class)
	public void remove(TrabajadoresGruposTrabajo bean) {
		TrabajadoresGruposTrabajo original = this.trabajadoresGruposTrabajoDao.find(bean);
		super.remove(bean);

		RegistroAcciones regGruposTrabajo = new RegistroAcciones();
		regGruposTrabajo.setIdPuntoMenu(Constants.PUNTO_MENU_GESTION_GRUPOS);
		regGruposTrabajo.setIdAccion(Constants.ACCION_MODIFICACION);
		Locale locale = new Locale(Constants.LANG_EUSKERA);
		StringBuilder aux = new StringBuilder();
		aux.append(this.msg.getMessage("label.desasociarTrabajador", null, locale)).append(": ");
		aux.append(original.getDniCompleto()).append(" - ").append(original.getNombreCompleto());
		regGruposTrabajo.setObserv(aux.toString());
		this.registroAccionesDao.add(regGruposTrabajo);
	}

	@Override()
	@Transactional(rollbackFor = Throwable.class)
	public List<TrabajadoresGruposTrabajo> findAllSinRepetidos(TrabajadoresGruposTrabajo bean) {
		return this.trabajadoresGruposTrabajoDao.findAllSinRepetidos(bean);
	}

}
