package com.ejie.aa79b.service;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.ejie.aa79b.dao.EstadosExpedienteDao;
import com.ejie.aa79b.dao.GenericoDao;
import com.ejie.aa79b.model.EstadosExpediente;
import com.ejie.aa79b.model.enums.EstadoExpedienteEnum;
import com.ejie.aa79b.model.enums.FaseExpedienteEnum;
import com.ejie.aa79b.model.enums.TipoExpedienteEnum;

/**
 * EstadosExpedienteServiceImpl generated by UDA, 02-feb-2018 10:27:12.
 * 
 * @author UDA
 */

@Service(value = "estadosExpedienteService")
public class EstadosExpedienteServiceImpl extends GenericoServiceImpl<EstadosExpediente>
		implements EstadosExpedienteService {

	@Autowired
	private EstadosExpedienteDao estadosExpedienteDao;

	@Override
	protected GenericoDao<EstadosExpediente> getDao() {
		return this.estadosExpedienteDao;
	}

	@Override
	public List<EstadosExpediente> findAllEstadosExp(Long idEstadoExp, String tipoExp) {
		List<EstadosExpediente> listEstados;

		if (EstadoExpedienteEnum.EN_ESTUDIO.getValue() == idEstadoExp) {
			listEstados = this.estadosExpedienteDao.findAllEstadosExpRechAnulado();
		} else if (EstadoExpedienteEnum.EN_CURSO.getValue() == idEstadoExp) {
			listEstados = this.estadosExpedienteDao
					.getEstados(new ArrayList<Integer>(Arrays.asList(EstadoExpedienteEnum.EN_ESTUDIO.getValue(),
							EstadoExpedienteEnum.RECHAZADO.getValue(), EstadoExpedienteEnum.ANULADO.getValue())));
		} else if (EstadoExpedienteEnum.RECHAZADO.getValue() == idEstadoExp
				|| EstadoExpedienteEnum.ANULADO.getValue() == idEstadoExp) {
			if (TipoExpedienteEnum.INTERPRETACION.getValue().equals(tipoExp)) {
				listEstados = this.estadosExpedienteDao.findAllEstadosExpEnCurso();
			} else {
				listEstados = this.estadosExpedienteDao.findAllEstadosExpEnEstudioCurso();
			}
		} else {
			if (TipoExpedienteEnum.INTERPRETACION.getValue().equals(tipoExp)) {
				List<Integer> listaEstados = new ArrayList<Integer>();
				listaEstados.add(EstadoExpedienteEnum.ALTA_EXPEDIENTE.getValue());
				listaEstados.add(EstadoExpedienteEnum.EN_ESTUDIO.getValue());
				listEstados = this.estadosExpedienteDao.findAllSinEstados(listaEstados);
			} else {
				listEstados = this.estadosExpedienteDao.findAllSinAltaExp();
			}
		}

		return listEstados;
	}

	@Override
	public List<EstadosExpediente> findAllEstadosExp(Long idEstadoExp, Long idfaseExp, String tipoExp) {
		List<EstadosExpediente> listEstados;
		if (EstadoExpedienteEnum.EN_CURSO.getValue() == idEstadoExp
				&& FaseExpedienteEnum.PDTE_TRAM_CLIENTE.getValue() == idfaseExp) {
			listEstados = this.estadosExpedienteDao.getEstados(new ArrayList<Integer>(
					Arrays.asList(EstadoExpedienteEnum.RECHAZADO.getValue(), EstadoExpedienteEnum.ANULADO.getValue())));
		} else {
			listEstados = this.findAllEstadosExp(idEstadoExp, tipoExp);
		}
		return listEstados;
	}

	@Override
	public List<EstadosExpediente> findAllSinAltaExp() {
		return this.estadosExpedienteDao.findAllSinAltaExp();
	}

	@Override
	public List<EstadosExpediente> getEstados(List<Integer> listaEstados) {
		return this.estadosExpedienteDao.getEstados(listaEstados);
	}

}
