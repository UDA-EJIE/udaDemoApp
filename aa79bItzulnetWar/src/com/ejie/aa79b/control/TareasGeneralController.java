package com.ejie.aa79b.control;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Locale;

import javax.servlet.http.HttpServletRequest;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.i18n.LocaleContextHolder;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

import com.ejie.aa79b.model.DatosPagoProveedores;
import com.ejie.aa79b.model.DocumentoTarea;
import com.ejie.aa79b.model.DocumentosExpediente;
import com.ejie.aa79b.model.EjecucionTareas;
import com.ejie.aa79b.model.ExpTareasResumen;
import com.ejie.aa79b.model.ExpedienteTradRev;
import com.ejie.aa79b.model.Fichero;
import com.ejie.aa79b.model.Lotes;
import com.ejie.aa79b.model.TareaIdaba;
import com.ejie.aa79b.model.TareaTrados;
import com.ejie.aa79b.model.Tareas;
import com.ejie.aa79b.model.TareasGestionInterpretacion;
import com.ejie.aa79b.model.TareasTrabajo;
import com.ejie.aa79b.model.enums.TipoExpedienteEnum;
import com.ejie.aa79b.security.Usuario;
import com.ejie.aa79b.service.TareasGeneralService;
import com.ejie.aa79b.service.TareasService;
import com.ejie.aa79b.service.TareasTrabajoService;
import com.ejie.x38.control.bind.annotation.RequestJsonBody;
import com.ejie.x38.dto.JQGridRequestDto;
import com.ejie.x38.dto.JQGridResponseDto;
import com.ejie.x38.reports.ReportData;

/**
 * TiposRevisionController generated by UDA, 28-nov-2017 15:23:30.
 *
 * @author UDA
 */

@Controller
@RequestMapping(value = "/ejecuciontarea")

public class TareasGeneralController {

	private static final Logger LOGGER = LoggerFactory.getLogger(TareasGeneralController.class);

	@Autowired
	private TareasGeneralService tareasGeneralService;
	@Autowired
	private TareasService tareasService;
	@Autowired()
	private TareasTrabajoService tareasTrabajoService;
	/*
	 * **** Tareas tipo TAREA DE REVISION DE DATOS DE PAGO A PROVEEDOR ****
	 */

	/*
	 * **** Tareas tipo TAREA DE REVISION DE DATOS DE PAGO A PROVEEDOR ****
	 */

	/*
	 * ********************************* Tareas tipo CORREDACCION
	 * ******************************************************
	 */

	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterTiposRevision
	 *            TiposRevision Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<TiposRevision> Dto que contiene el resultado
	 *         del filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/corredactar/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosCorredaccion(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosCorredaccion");

		return this.tareasGeneralService.filterCorredaccion(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterTiposRevision
	 *            TiposRevision Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<TiposRevision> Dto que contiene el resultado
	 *         del filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/corredactar/xliff/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosCorredaccionXliff(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosCorredaccion");

		return this.tareasGeneralService.filterCorredaccionXliff(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/*
	 * ********************************* Finalizar tarea
	 * ******************************************************
	 */
	@RequestMapping(value = "/finalizarTarea", method = RequestMethod.POST)
	public @ResponseBody() Tareas finalizarTarea(@RequestBody() Tareas tarea, HttpServletRequest request) {
		TareasGeneralController.LOGGER.info("[POST] : finalizarTarea");
		// Se introduce el usuario. Se hace desde aquí, por si hay que llamar a
		// algún ws que haga el fin tarea desde aa06a y no interfiera.
		Usuario credentials = (Usuario) SecurityContextHolder.getContext().getAuthentication().getCredentials();
		if (tarea.getEjecucionTareas() == null) {
			tarea.setEjecucionTareas(new EjecucionTareas());
		}
		tarea.getEjecucionTareas().setDniRecurso(credentials.getNif());
		this.tareasGeneralService.finalizarTarea(tarea, request);
		return tarea;
	}

	/*
	 * ********************************* Finalizar tarea
	 * ******************************************************
	 */
	@RequestMapping(value = "/finalizarTareaTrabajo", method = RequestMethod.POST)
	public @ResponseBody() TareasTrabajo finalizarTareaTrabajo(@RequestBody() TareasTrabajo tarea, HttpServletRequest request) {
		TareasGeneralController.LOGGER.info("[POST] : finalizarTareaTrabajo");
		return this.tareasTrabajoService.finalizarTarea(tarea);
	}

	/*
	 * ********************************* Tareas tipo sin gestión asociada
	 * ******************************************************
	 */

	/**
	 * Genera CSV metadatos de tarea sin gestión asociada
	 */
	@RequestMapping(value = "/csvReportSinGestionAsociada/{idExpediente}/{idTarea}/{idTipoTarea}/{anyoExpediente}", method = RequestMethod.GET)

	protected ModelAndView getCSVReport(@PathVariable Long idExpediente, @PathVariable BigDecimal idTarea,
			@PathVariable Long idTipoTarea, @PathVariable Long anyoExpediente, ModelMap modelMap) {
		// Nombre fichero
		modelMap.put("fileName", "datosCSVSinGestionAsociada");
		// Modelo del que obtendra los datos
		List<TareaIdaba> listTareas = new ArrayList<TareaIdaba>();
		TareaIdaba tarea = this.tareasGeneralService.getTareasIdaba(idExpediente, idTarea, idTipoTarea, anyoExpediente);
		listTareas.add(tarea);
		ReportData<Tareas> reportData = new ReportData<Tareas>();
		Locale locale = LocaleContextHolder.getLocale();
		LinkedHashMap<String, String> mapa = new LinkedHashMap<String, String>();
		mapa.put("descEntidad" + locale, "Jatorri erakundea");
		mapa.put("nombreTradCompleto", "Itzultzailea");
		mapa.put("tituloExpediente", "Dokumentuaren izena");
		mapa.put("numExpediente", "Espediente zenbakia");
		mapa.put("descRel" + locale, "Dokumentu-maila");
		mapa.put("descDoc" + locale, "Dokumentu-mota");
		mapa.put("date", "Data");
		reportData.setModelData(listTareas);
		reportData.setHeaderNames(mapa);
		// Fija los datos del csv
		modelMap.put("reportData", reportData);
		return new ModelAndView("csvReport", modelMap);
	}

	/*
	 * ********************************* Tareas tipo No conformidad
	 * ******************************************************
	 */

	@RequestMapping(value = "/tareas/findTarea/{idTarea}", method = RequestMethod.GET)
	public @ResponseBody Tareas findTarea(@PathVariable BigDecimal idTarea) {
		TareasGeneralController.LOGGER.info("[POST - filter] : Obtener findTarea");
		return this.tareasGeneralService.findTareaBasica(idTarea);
	}

	@RequestMapping(value = "/datosPagoProveedor/{idTarea}/{anyo}/{numExp}", method = RequestMethod.GET)
	public @ResponseBody ExpTareasResumen datosPagoProveedor(@PathVariable BigDecimal idTarea, @PathVariable Long anyo,
			@PathVariable Integer numExp) {
		TareasGeneralController.LOGGER.info("[POST - filter] : Obtener findTarea");
		return this.tareasGeneralService.findDatosPagoProveedor(idTarea);
	}

	@RequestMapping(value = "/datosPagoProveedor/guardarTarea", method = RequestMethod.POST)
	@ResponseBody()
	public Integer guardarTarea(
			@RequestBody() Tareas tareas) {
		try {
			DatosPagoProveedores datosPagoProveedores = tareas.getDatosPagoProveedores();
			datosPagoProveedores.setIdTarea(tareas.getIdTarea());
			this.tareasGeneralService.updateDatosPagoProveedor(datosPagoProveedores);
		} catch (Exception e) {
			TareasGeneralController.LOGGER.error("[POST - subm]: /datosPagoProveedor/guardarTarea ", e);
			throw new RuntimeException(e);
		}

		return 1;
	}

	@RequestMapping(value = "/findTareaInterpretacion/{idTarea}", method = RequestMethod.GET)
	public @ResponseBody TareasGestionInterpretacion findTareaInterpretacion(@PathVariable BigDecimal idTarea) {
		TareasGeneralController.LOGGER.info("[POST - filter] : Obtener findTarea");
		return this.tareasGeneralService.findTareaInterpretacion(idTarea);
	}

	/*
	 * ********************************* Tareas tipo TRADUCCION - INICIO
	 * ******************************************************
	 */
	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<TiposRevision> Dto que contiene el resultado
	 *         del filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/traducir/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosTraduccion(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosTraduccion");
		return this.tareasGeneralService.filterTraduccion(filterDocumentoTarea, jqGridRequestDto, false);
	}

	@RequestMapping(value = "/traducir/xliff/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosTraduccionXliff(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosTraduccionXliff");
		return this.tareasGeneralService.filterTraduccionXliff(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<TiposRevision> Dto que contiene el resultado
	 *         del filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/traducirEntregaCliente/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosTraduccionEntregaCliente(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosTraduccion");
		return this.tareasGeneralService.filterTraduccionEntregaCliente(filterDocumentoTarea, jqGridRequestDto, false);
	}
	/*
	 * ********************************* Tareas tipo TRADUCCION - FIN
	 * ******************************************************
	 */

	/*
	 * ********************************* Tareas tipo REVISION - INICIO
	 * ******************************************************
	 */
	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<TiposRevision> Dto que contiene el resultado
	 *         del filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/revisar/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosRevision(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosTraduccion");
		return this.tareasGeneralService.filterRevision(filterDocumentoTarea, jqGridRequestDto, false);
	}
	/*
	 * ********************************* Tareas tipo REVISION - FIN
	 * ******************************************************
	 */

	/**
	 * valida si los documentos originales de la tarea tienen ficheros de
	 * traduccion asociados
	 *
	 * @param idTarea
	 *            BigDecimal
	 * @return Boolean
	 */
	@RequestMapping(value = "/validarDocumentosTareaFinalizar/{idTarea}/{idTipoTarea}", method = RequestMethod.GET)
	public @ResponseBody Boolean validarTareaTraduccionFinalizar(@PathVariable() BigDecimal idTarea,
			@PathVariable() Long idTipoTarea) {
		TareasGeneralController.LOGGER.info("[GET - validarTareaTraduccionFinalizar]");
		return this.tareasGeneralService.validarDocumentosTareaFinalizar(idTarea, idTipoTarea);
	}
	/**
	 * Validacion específica para tareas de entrega de traducción
	 * Comprueba además que todos los docs de trad/rev del expdte están incluidos en la tarea de entrega
	 * @param idTarea
	 * @return
	 */
	@RequestMapping(value = "/validarDocumentosTareaFinalizarEntregaTrad/{idTarea}/{iFirmaNecesaria}", method = RequestMethod.GET)
	public @ResponseBody Boolean validarTareaTraduccionFinalizar(@PathVariable() BigDecimal idTarea, @PathVariable() Integer iFirmaNecesaria) {
		TareasGeneralController.LOGGER.info("[GET - validarTareaTraduccionFinalizar]");
		return this.tareasGeneralService.validarDocumentosTareaFinalizarEntregaTrad(idTarea, iFirmaNecesaria);
	}


	/**
	 * Validación extra para entrega cliente traducción y revisión (tipos 19 y 20)
	 * @param idTarea
	 * @return boolean
	 */
	@RequestMapping(value = "/comprobarFirmaDocumentos/{tipoExp}/{idTarea}", method = RequestMethod.GET)
	public @ResponseBody Boolean comprobarFirmaDocumentos(@PathVariable() String tipoExp,@PathVariable() BigDecimal idTarea) {
		TareasGeneralController.LOGGER.info("[GET - validarTareaTraduccionFinalizar]");

		Boolean correcto=false;
		//recuperar los docs de la tarea
		DocumentoTarea filterDocumentoTarea = new DocumentoTarea();
		filterDocumentoTarea.setIdTarea(idTarea);
		List<Tareas> listaDocs;
		if (TipoExpedienteEnum.TRADUCCION.getValue().equals(tipoExp)){
			listaDocs = this.tareasGeneralService.findDocsTraduccionEntregaCliente(filterDocumentoTarea, null, false);
		}else{
			listaDocs = this.tareasGeneralService.findDocsRevisionEntregaCliente(filterDocumentoTarea, null, false);
		}

		try{
			correcto = this.tareasGeneralService.comprobarFirmaDocumentosTareaEntrega(listaDocs);
		}catch ( Exception e){
			TareasGeneralController.LOGGER.error("comprobarFirmaDocumentos excepcion: ",e);
		}
		return correcto;
	}

	/**
	 * Validación extra para entrega cliente traducción y revisión (tipos 19 y 20)
	 * @param idTarea
	 * @return boolean
	 */
	@RequestMapping(value = "/comprobarWSIzoberri/{tipoExp}/{idTarea}", method = RequestMethod.GET)
	public @ResponseBody String comprobarWSIzoberri(@PathVariable() String tipoExp,@PathVariable() BigDecimal idTarea) {
		TareasGeneralController.LOGGER.info("[GET - validarTareaTraduccionFinalizar]");

		String rdo = "";
		//recuperar los datos del expediente
		ExpedienteTradRev expTradRev = this.tareasGeneralService.findDatosExpFinIzoberri( idTarea );
		//recuperar los docs de la tarea
		DocumentoTarea filterDocumentoTarea = new DocumentoTarea();
		filterDocumentoTarea.setIdTarea(idTarea);
		List<Tareas> listaDocs;
		if (TipoExpedienteEnum.TRADUCCION.getValue().equals(tipoExp)){
			listaDocs = this.tareasGeneralService.findDocsTraduccionEntregaCliente(filterDocumentoTarea, null, false);
		}else{
			listaDocs = this.tareasGeneralService.findDocsRevisionEntregaCliente(filterDocumentoTarea, null, false);
		}
		try{
			rdo = this.tareasGeneralService.comprobarWSIzoberri(expTradRev,listaDocs );
		}catch ( Exception e){
			TareasGeneralController.LOGGER.error("comprobarFirmaDocumentos excepcion: ",e);
			rdo = e.getLocalizedMessage();
			if (rdo.contains("[TAGEND]")){
				rdo = "1";
			}
		}
		return rdo;
	}




	@RequestMapping(value = "/datosTablaTotalPalabras/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentosExpediente> datosTablaTotalPalabras(
			@RequestJsonBody(param = "filter") Tareas filterTareas,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : Obtener datosTablaTotalPalabras");
		return this.tareasGeneralService.findDocumentosTarea(filterTareas, jqGridRequestDto, false);

	}

	/*
	 * ********************************* Tareas tipo TRADOS - INICIO
	 * ******************************************************
	 */

	@RequestMapping(value = "/cargaInicialTareaTrados/{anyoExp}/{numExp}/{idTarea}", method = RequestMethod.GET)
	public @ResponseBody TareaTrados cargaInicialTareaTrados(@PathVariable() Long anyoExp,
			@PathVariable() Integer numExp, @PathVariable() BigDecimal idTarea) {
		TareasGeneralController.LOGGER.info("[GET - get] : cargaInicialTareaTrados");
		return this.tareasGeneralService.cargaInicialTareaTrados(anyoExp, numExp, idTarea);
	}

	/*
	 * ********************************* Tareas tipo TRADOS - FIN
	 * ******************************************************
	 */

	/**
	 * Se crea la tarea notificar una correccion al proveedor
	 *
	 * @param tarea
	 *            Tareas
	 * @param fichero
	 *            Fichero
	 * @return int
	 */
	@RequestMapping(value = "/notificarCorreccionProveedor", method = RequestMethod.POST)
	public @ResponseBody int notificarCorreccionProveedor(
			@RequestJsonBody(required = false, param = "tarea") Tareas tarea,
			@RequestJsonBody(required = false, param = "fichero") Fichero fichero) {
		return this.tareasService.notificarCorreccionProveedor(tarea, fichero);
	}

	/**
	 * Se crea la tarea notificar una correccion al proveedor
	 *
	 * @param tarea
	 *            Tareas
	 * @param fichero
	 *            Fichero
	 * @return int
	 */
	@RequestMapping(value = "/notificarCorreccionProvTradExt", method = RequestMethod.POST)
	public @ResponseBody int notificarCorreccionProvTradExt(
			@RequestJsonBody(required = false, param = "tarea") Tareas tarea,
			@RequestJsonBody(required = false, param = "fichero") Fichero fichero) {
		return this.tareasService.notificarCorreccionProvTradExt(tarea, fichero);
	}

	/**
	 * Se crea la tarea generar una no conformidad con el trabajo entregado por
	 * el proveeedor
	 *
	 * @param tarea
	 *            Tareas
	 * @param documentosSelect
	 *            String
	 * @param idTareaRel
	 *            BigDecimal
	 * @return int
	 */
	@RequestMapping(value = "/generarNoConformidad", method = RequestMethod.POST)
	public @ResponseBody int generarNoConformidad(@RequestJsonBody(required = false, param = "tarea") Tareas tarea,
			@RequestJsonBody(required = false, param = "documentosSelect") String documentosSelect,
			@RequestJsonBody(required = false, param = "idTareaRel") BigDecimal idTareaRel,
			@RequestJsonBody(required = false, param = "fichero") Fichero fichero) {
		return this.tareasService.generarNoConformidad(tarea, documentosSelect, idTareaRel, fichero);
	}

	/**
	 * Se crea la tarea generar una no conformidad con el trabajo realizado por
	 * el traductor
	 *
	 * @param tarea
	 *            Tareas
	 * @param documentosSelect
	 *            String
	 * @param idTareaRel
	 *            BigDecimal
	 * @return int
	 */
	@RequestMapping(value = "/generarNoConformidadRevInterna", method = RequestMethod.POST)
	public @ResponseBody int generarNoConformidadRevInterna(@RequestJsonBody(required = false, param = "tarea") Tareas tarea,
			@RequestJsonBody(required = false, param = "documentosSelect") String documentosSelect,
			@RequestJsonBody(required = false, param = "idTareaRel") BigDecimal idTareaRel) {
		return this.tareasService.generarNoConformidadRevInterna(tarea, documentosSelect, idTareaRel);
	}

	/**
	 * Se crea la tarea generar una no conformidad con el trabajo entregado por
	 * el proveeedor asociada a la tarea de revisión con entrega a cliente
	 *
	 * @param tarea
	 *            Tareas
	 * @param documentosSelect
	 *            String
	 * @return int
	 */
	@RequestMapping(value = "/noConformidadRevEntregaClte/{orden}", method = RequestMethod.POST)
	public @ResponseBody int noConformidadRevEntregaClte(
			@RequestJsonBody(required = false, param = "tarea") Tareas tarea,
			@RequestJsonBody(required = false, param = "documentosSelect") String documentosSelect,
			@RequestJsonBody(required = false, param = "fichero") Fichero fichero,
			@PathVariable Integer orden) {
		return this.tareasService.noConformidadRevEntregaClte(tarea, documentosSelect, orden, fichero);
	}

	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<Tareas> Dto que contiene el resultado del
	 *         filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/docsRevisionTraduccionExterna/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<Tareas> getDocsRevisionTraduccionExterna(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocsRevisionTraduccionExterna");
		return this.tareasGeneralService.getDocsRevisionTraduccionExterna(filterDocumentoTarea, jqGridRequestDto,
				false);
	}

	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<Tareas> Dto que contiene el resultado del
	 *         filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/docsRevisionTraduccionInterna/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<Tareas> getDocsRevisionTraduccionInterna(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocsRevisionTraduccionInterna");
		return this.tareasGeneralService.getDocsRevisionTraduccionInterna(filterDocumentoTarea, jqGridRequestDto,
				false);
	}

	@RequestMapping(value = "/cargarDatosTareaAsignadas", method = RequestMethod.POST)
	public @ResponseBody Tareas cargarDatosLoteAsignado(@RequestJsonBody Tareas tarea) {
		Lotes lotes = this.tareasGeneralService.cargarDatosLoteAsignado(tarea);
		DatosPagoProveedores datosPagoProveedores = this.tareasGeneralService.cargarDatosDePagoAProveedorAsignado(tarea);
		Tareas tareas = new Tareas();
		tareas.setLotes(lotes);
		tareas.setDatosPagoProveedores(datosPagoProveedores);
		return tareas;
	}

	@RequestMapping(value = "/cargarDatosTareaAsignadasRevisionExterna", method = RequestMethod.POST)
	public @ResponseBody Tareas cargarDatosTareaAsignadasRevisionExterna(@RequestJsonBody Tareas tarea) {
		Lotes lotes = this.tareasGeneralService.cargarDatosLoteAsignadoRevisionExterna(tarea);
		DatosPagoProveedores datosPagoProveedores = this.tareasGeneralService.cargarDatosDePagoAProveedorAsignadoRevisionExterna(tarea);
		Tareas tareas = new Tareas();
		tareas.setLotes(lotes);
		tareas.setDatosPagoProveedores(datosPagoProveedores);
		return tareas;
	}

	/**
	 * Se obtiene el lote asignado a la tarea de revisión externa. En caso de
	 * que no exista tarea de revisión externa, se devuelve 0.
	 *
	 * @param tarea
	 *            Tareas
	 */
	@RequestMapping(value = "/findLoteTareaRevisionEjec", method = RequestMethod.POST)
	public @ResponseBody int findLoteTareaRevisionEjec(
			@RequestJsonBody(required = false, param = "tarea") Tareas tarea) {
		return this.tareasService.findLoteTareaRevisionEjec(tarea);
	}

	/**
	 * Operacion de filtrado del componente RUP_TABLE.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea Bean que contiene los parametros de filtrado a
	 *            emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<Tareas> Dto que contiene el resultado del
	 *         filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/docsRevisionEntregaCliente/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<Tareas> getDocsRevisionEntregaCliente(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocsRevisionEntregaCliente");
		return this.tareasGeneralService.getDocsRevisionEntregaCliente(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 * Obtiene los datos de la pestaña revisiones realizadas de la pantalla de
	 * ejecución de la tarea de revisión con entrega a cliente
	 *
	 * @param filterTareas
	 *            Tareas Bean que contiene los parametros de filtrado a emplear.
	 * @param jqGridRequestDto
	 *            Dto que contiene los parametros de configuracion propios del
	 *            RUP_TABLE a aplicar en el filtrado.
	 * @return JQGridResponseDto<Tareas> Dto que contiene el resultado del
	 *         filtrado realizado por el componente RUP_TABLE.
	 */
	@RequestMapping(value = "/docsRevisadosEntregaClte/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<Tareas> getDocsRevisadosEntregaClte(
			@RequestJsonBody(param = "filter") Tareas filterTareas,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocsRevisadosEntregaClte");
		return this.tareasGeneralService.getDocsRevisadosEntregaClte(filterTareas, jqGridRequestDto, false);
	}

	@RequestMapping(value = "/entregacltetrad/xliff/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosEntregaClteTradXliff(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosEntregaClteTradXliff");
		return this.tareasGeneralService.filterEntregaClteTradXliff(filterDocumentoTarea, jqGridRequestDto, false);
	}

	@RequestMapping(value = "/docsTraducidosEntregaClte/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<Tareas> getDocsTraducidosEntregaClte(
			@RequestJsonBody(param = "filter") Tareas filterTareas,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocsTraducidosEntregaClte");
		return this.tareasGeneralService.getDocsTraducidosEntregaClte(filterTareas, jqGridRequestDto, false);
	}

	/**
	 * Obtiene los documentos xliff asociados a la tarea de ejecución de la
	 * tarea de revisión externa.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea
	 * @param jqGridRequestDto
	 *            JQGridRequestDto
	 * @return JQGridResponseDto<DocumentoTarea>
	 */
	@RequestMapping(value = "/docsRevTradExt/xliff/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosRevTradExtXliff(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosRevTradExtXliff");
		return this.tareasGeneralService.getDocumentosRevTradExtXliff(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 * Obtiene los documentos xliff asociados a la tarea de ejecución de la
	 * tarea de revisión interna.
	 *
	 * @param filterDocumentoTarea
	 *            DocumentoTarea
	 * @param jqGridRequestDto
	 *            JQGridRequestDto
	 * @return JQGridResponseDto<DocumentoTarea>
	 */
	@RequestMapping(value = "/docsRevTradInt/xliff/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosRevTradIntXliff(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosRevTradIntXliff");
		return this.tareasGeneralService.getDocumentosRevTradIntXliff(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 *
	 * @param filterDocumentoTarea DocumentoTarea
	 * @param jqGridRequestDto JQGridRequestDto
	 * @return JQGridResponseDto<DocumentoTarea>
	 */
	@RequestMapping(value = "/getDocumentosNoConformidadProveedorTrad/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosNoConformidadProveedorTrad(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosNoConformidadProveedorTrad");

		return this.tareasGeneralService.filterNoConformidadProveedorTrad(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 *
	 * @param filterDocumentoTarea DocumentoTarea
	 * @param jqGridRequestDto JQGridRequestDto
	 * @return JQGridResponseDto<DocumentoTarea>
	 */
	@RequestMapping(value = "/getDocumentosXliffNoConformidadProveedorTrad/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosXliffNoConformidadProveedorTrad(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : filterXliffNoConformidadProveedorTrad");

		return this.tareasGeneralService.filterXliffNoConformidadProveedorTrad(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 *
	 * @param filterDocumentoTarea DocumentoTarea
	 * @param jqGridRequestDto JQGridRequestDto
	 * @return JQGridResponseDto<DocumentoTarea>
	 */
	@RequestMapping(value = "/getDocumentosNoConformidadProveedorRev/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosNoConformidadProveedorRev(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosNoConformidadProveedorRev");

		return this.tareasGeneralService.filterNoConformidadProveedorRev(filterDocumentoTarea, jqGridRequestDto, false);
	}

	/**
	 *
	 * @param filterDocumentoTarea DocumentoTarea
	 * @param jqGridRequestDto JQGridRequestDto
	 * @return JQGridResponseDto<DocumentoTarea>
	 */
	@RequestMapping(value = "/docsNoConformidadTraductor/filter", method = RequestMethod.POST)
	public @ResponseBody JQGridResponseDto<DocumentoTarea> getDocumentosNoConformidadTraductor(
			@RequestJsonBody(param = "filter") DocumentoTarea filterDocumentoTarea,
			@RequestJsonBody JQGridRequestDto jqGridRequestDto) {
		TareasGeneralController.LOGGER.info("[POST - filter] : getDocumentosNoConformidadTraductor");

		return this.tareasGeneralService.filterNoConformidadTraductor(filterDocumentoTarea, jqGridRequestDto, false);
	}

}
