package com.ejie.aa79b.service;
import java.util.LinkedHashMap;
import java.util.Locale;
import java.util.Map;

import org.apache.commons.lang.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.Constants;
import com.ejie.aa79b.dao.GenericoDao;
import com.ejie.aa79b.dao.RegistroAccionesDao;
import com.ejie.aa79b.dao.TiposInterpretacionDao;
import com.ejie.aa79b.model.RegistroAcciones;
import com.ejie.aa79b.model.TiposInterpretacion;
import com.ejie.aa79b.utils.Utils;

/**
 * TiposInterpretacionServiceImpl generated by UDA, 24-nov-2017 13:50:22.
 * @author UDA
 */

@Service(value = "tiposInterpretacionService")
public class TiposInterpretacionServiceImpl extends GenericoServiceImpl<TiposInterpretacion> implements TiposInterpretacionService {

	@Autowired
	private TiposInterpretacionDao tiposInterpretacionDao;

	@Autowired()
    private ReloadableResourceBundleMessageSource msg;
	
	@Autowired
    private RegistroAccionesDao registroAccionesDao;
	
	@Override
	protected GenericoDao<TiposInterpretacion> getDao() {
		// TODO Auto-generated method stub
		return this.tiposInterpretacionDao;
	}
	
	@Override()
    @Transactional(rollbackFor = Throwable.class)
    public TiposInterpretacion update(TiposInterpretacion bean) {
	    TiposInterpretacion original = this.tiposInterpretacionDao.find(bean);
        this.tiposInterpretacionDao.update(bean);
        
        RegistroAcciones regTiposInterpretacion = new RegistroAcciones();
        regTiposInterpretacion.setIdPuntoMenu(Constants.PUNTO_MENU_TIPOS_INTERPRETACION);
        regTiposInterpretacion.setIdAccion(Constants.ACCION_MODIFICACION);
        Map<String, String> paramLibroRegistro = new LinkedHashMap<String, String>();
        paramLibroRegistro.put("tipoFacturacion008", "label.facturacion");
        
        Locale locale = new Locale(Constants.LANG_EUSKERA);
        String aux = Utils.observacionesRegistro(bean, original, paramLibroRegistro, this.msg, locale);
        if (StringUtils.isNotBlank(aux)) {
            StringBuilder observ = new StringBuilder();
            observ.append(original.getDescEu008()).append(" (id=").append(original.getId008()).append("): \n");
            observ.append(aux);
            regTiposInterpretacion.setObserv(observ.toString());
            this.registroAccionesDao.add(regTiposInterpretacion);
        }
        return bean;
    }
}

