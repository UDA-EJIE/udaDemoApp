package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.dao.support.DataAccessUtils;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.TiposAusencia;

/**
 * TiposAusenciaDaoImpl generated by UDA, 27-dic-2017 15:09:49.
 * @author UDA
 */

@Repository
@Transactional
public class TiposAusenciaDaoImpl extends GenericoDaoImpl<TiposAusencia> implements TiposAusenciaDao {
    
    public TiposAusenciaDaoImpl() {
        /* Constructor */
        super(TiposAusencia.class);
    }


    protected static final String[] ORDER_BY_WHITE_LIST = new String[] {"ID040", "DESCES040", "DESCEU040", "ESTADO040"};

   
	private RowMapper<TiposAusencia> rwMap = new RowMapper<TiposAusencia>() {
		@Override
        public TiposAusencia mapRow(ResultSet resultSet, int rowNum) throws SQLException {
           return new TiposAusencia(
               resultSet.getString("ID040"), resultSet.getString("DESCES040"), resultSet.getString("DESCEU040"), resultSet.getString("ESTADO040")
           );
		}
	};

	private RowMapper<TiposAusencia> rwMapPK = new RowMapper<TiposAusencia>() {
		@Override
        public TiposAusencia mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new TiposAusencia(
				resultSet.getString("ID040")
           ); 
		}
	};

	/*
	 * OPERACIONES CRUD
	 */

    @Override()
	public TiposAusencia add(TiposAusencia tiposausencia) {
    	String query = "INSERT INTO AA79B40S01 (ID_040, DESC_ES_040, DESC_EU_040, ESTADO_040) VALUES (?,?,?,?)";
		this.getJdbcTemplate().update(query, tiposausencia.getId040(), tiposausencia.getDescEs040(), tiposausencia.getDescEu040(), tiposausencia.getEstado040());
		return tiposausencia;
	}

    @Override()
    public TiposAusencia update(TiposAusencia tiposausencia) {
		String query = "UPDATE AA79B40S01 SET DESC_ES_040=?, DESC_EU_040=?, ESTADO_040=? WHERE ID_040=?";
		this.getJdbcTemplate().update(query, tiposausencia.getDescEs040(), tiposausencia.getDescEu040(), tiposausencia.getEstado040(), tiposausencia.getId040());
		return tiposausencia;
	}
    @Override()
    public void remove(TiposAusencia tiposausencia) {
        String query = "DELETE FROM AA79B40S01 WHERE ID_040=?";
        this.getJdbcTemplate().update(query, tiposausencia.getId040());
    }
    
    @Override()
    @Transactional (readOnly = true)
    public TiposAusencia find(TiposAusencia tiposausencia) {
		String query = " ";

		List<TiposAusencia> tiposausenciaList = this.getJdbcTemplate().query(query, this.rwMap, tiposausencia.getId040());
		return DataAccessUtils.uniqueResult(tiposausenciaList);
    }

   
    @Override()
    protected String getSelect() {
        StringBuilder sb = new StringBuilder();
        sb.append("SELECT t1.ID_040 ID040, t1.DESC_ES_040 DESCES040, t1.DESC_EU_040 DESCEU040, t1.ESTADO_040 ESTADO040 ");
        return sb.toString();
    }

    @Override()
    protected String getFrom() {
        return " FROM AA79B40S01 t1 ";
    }

    @Override()
    protected RowMapper<TiposAusencia> getRwMap() {
        return this.rwMap;
    }

    @Override()
    protected String[] getOrderBy() {
        return TiposAusenciaDaoImpl.ORDER_BY_WHITE_LIST;
    }

    @Override()
    protected String getPK() {
        return "ID_040";
    }

    @Override()
    protected RowMapper<TiposAusencia> getRwMapPK() {
        return this.rwMapPK;
    }

    @Override()
    protected String getWherePK(TiposAusencia bean, List<Object> params) {
        params.add(bean.getId040());
        return "  WHERE t1.ID_040 = ? ";
    }
	
    
    @Override
    protected String getWhere(TiposAusencia bean, List<Object> params) {

        StringBuilder where = new StringBuilder(TiposAusenciaDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual("ID_040", bean.getId040(), params));
        where.append(SqlUtils.generarWhereLikeNormalizado("DESC_ES_040", bean.getDescEs040(), params, false));
        where.append(SqlUtils.generarWhereLikeNormalizado("DESC_EU_040", bean.getDescEu040(), params, false));
        where.append(SqlUtils.generarWhereLikeNormalizado("ESTADO_040", bean.getEstado040(), params, false));
        
        return where.toString();
    }
    
    @Override
    protected String getWhereLike(TiposAusencia bean, Boolean startsWith, List<Object> params, Boolean search) {

        StringBuilder where = new StringBuilder(TiposAusenciaDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual("ID_040", bean.getId040(), params));
        where.append(SqlUtils.generarWhereLikeNormalizado("DESC_ES_040", bean.getDescEs040(), params, false));
        where.append(SqlUtils.generarWhereLikeNormalizado("DESC_EU_040", bean.getDescEu040(), params, false));
        where.append(SqlUtils.generarWhereLikeNormalizado("ESTADO_040", bean.getEstado040(), params, false));
        return where.toString();
    }
}

