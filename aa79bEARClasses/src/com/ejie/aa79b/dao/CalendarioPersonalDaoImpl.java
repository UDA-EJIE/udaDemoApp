package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.CalendarioPersonal;

/**
 * CalendarioPersonalDaoImpl generated by UDA, 17-nov-2017 12:37:45.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class CalendarioPersonalDaoImpl extends GenericoDaoImpl<CalendarioPersonal> implements CalendarioPersonalDao {

    protected static final String DNI024 = "DNI024";
    protected static final String DNI_024 = "DNI_024";
    protected static final String[] ORDER_BY_WHITE_LIST = new String[] { DNI024, 
            "INDTELETRABAJO024", "OBSERVHORARIO024", "HORASGESTIONEXP024" };
    
    
    
	


	private RowMapper<CalendarioPersonal> rwMap = new RowMapper<CalendarioPersonal>() {
		@Override
        public CalendarioPersonal mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new CalendarioPersonal(resultSet.getString(DNI024),
					resultSet.getString("INDTELETRABAJO024"), resultSet.getString("OBSERVHORARIO024"),
					resultSet.getLong("HORASGESTIONEXP024"));
		}
	};

	private RowMapper<CalendarioPersonal> rwMapPK = new RowMapper<CalendarioPersonal>() {
		@Override
        public CalendarioPersonal mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new CalendarioPersonal(resultSet.getString(DNI024));
		}
	};
	/**
     * Constructor
     */
	public CalendarioPersonalDaoImpl() {
        
        super(CalendarioPersonal.class);
    }	

	/*
	 * OPERACIONES CRUD
	 */

	@Override
    public CalendarioPersonal add(CalendarioPersonal calendariopersonal) {
		String query = "INSERT INTO AA79B24S01 (DNI_024, IND_TELETRABAJO_024, OBSERV_HORARIO_024, HORAS_GESTION_EXP_024) VALUES (?,?,?,?)";
		this.getJdbcTemplate().update(query, calendariopersonal.getDni(),
		        (calendariopersonal.getIndTeletrabajo() != null) ? calendariopersonal.getIndTeletrabajo() : "N",
		        calendariopersonal.getObservHorario(),
				calendariopersonal.getHorasGestionExp());
		return calendariopersonal;
	}

	@Override
    public CalendarioPersonal update(CalendarioPersonal calendariopersonal) {
		String query = "UPDATE AA79B24S01 SET IND_TELETRABAJO_024=?, OBSERV_HORARIO_024=?, HORAS_GESTION_EXP_024=? WHERE DNI_024=?";
		this.getJdbcTemplate().update(query, (calendariopersonal.getIndTeletrabajo() != null) ? calendariopersonal.getIndTeletrabajo() : "N", 
		        calendariopersonal.getObservHorario(),
				calendariopersonal.getHorasGestionExp(), calendariopersonal.getDni());
		return calendariopersonal;
	}

	@Override
    public void remove(CalendarioPersonal calendariopersonal) {
        String query = "DELETE FROM AA79B24S01 WHERE DNI_024=?";
        this.getJdbcTemplate().update(query, calendariopersonal.getDni());
    }
	
	@Override()
    protected String getSelect() {     
        StringBuilder sb = new StringBuilder();

        sb.append("SELECT t1.DNI_024 DNI024, t1.IND_TELETRABAJO_024 INDTELETRABAJO024, t1.OBSERV_HORARIO_024 OBSERVHORARIO024, t1.HORAS_GESTION_EXP_024 HORASGESTIONEXP024 ");        
        return sb.toString();
    }

    @Override()
    protected String getFrom() {
        return "  FROM AA79B24S01 t1   ";
    }

    @Override()
    protected RowMapper<CalendarioPersonal> getRwMap() {
        return this.rwMap;
    }

    @Override()
    protected String[] getOrderBy() {
        return CalendarioPersonalDaoImpl.ORDER_BY_WHITE_LIST;
    }

    @Override()
    protected String getPK() {
        return DNI_024;
    }

    @Override()
    protected RowMapper<CalendarioPersonal> getRwMapPK() {
        return this.rwMapPK;
    }

    @Override()
    protected String getWherePK(CalendarioPersonal bean, List<Object> params) {
        params.add(bean.getDni());
        return "  WHERE t1.DNI_024 = ? ";
        //  AND t1.ANYO_024 = ? creo q no hace falta el a√±o...
    }	
	
    @Override()
    protected String getWhere(CalendarioPersonal bean, List<Object> params) {

        StringBuilder where = new StringBuilder(CalendarioPersonalDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual(DNI_024, bean.getDni(), params));        
        where.append(SqlUtils.generarWhereIgual("IND_TELETRABAJO_024", bean.getIndTeletrabajo(), params));
        where.append(SqlUtils.generarWhereIgual("OBSERV_HORARIO_024", bean.getObservHorario(), params));
        where.append(SqlUtils.generarWhereIgual("HORAS_GESTION_EXP_024", bean.getHorasGestionExp(), params));        
        
        return where.toString();
    }
	
    @Override()
    protected String getWhereLike(CalendarioPersonal bean, Boolean startsWith, List<Object> params,
            Boolean search) {
        StringBuilder where = new StringBuilder(CalendarioPersonalDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual(DNI_024, bean.getDni(), params));        
        where.append(SqlUtils.generarWhereIgual("IND_TELETRABAJO_024", bean.getIndTeletrabajo(), params));
        where.append(SqlUtils.generarWhereIgual("OBSERV_HORARIO_024", bean.getObservHorario(), params));
        where.append(SqlUtils.generarWhereIgual("HORAS_GESTION_EXP_024", bean.getHorasGestionExp(), params));        
       
        return where.toString();
    }	

}
