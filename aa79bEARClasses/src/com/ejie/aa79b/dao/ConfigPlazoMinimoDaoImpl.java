package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ConfigPlazoMinimo;

/**
 * ConfigPlazoMinimoDaoImpl generated by UDA, 05-dic-2017 15:17:18.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class ConfigPlazoMinimoDaoImpl extends GenericoDaoImpl<ConfigPlazoMinimo> implements ConfigPlazoMinimoDao {

	public ConfigPlazoMinimoDaoImpl() {
		super(ConfigPlazoMinimo.class);
	}
	
	public static final String[] ORDER_BY_WHITE_LIST = new String[] { "ID001", "NIVELUSUARIO001", "PALABRASTRADHORA001",
			"PALABRASREVHORA001", "HORASGESTIONTRAD001", "HORASGESTIONREV001", "HORASEMISIONPRESUPUESTO001",
			"HORASACEPTPRESUPUESTO001" };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<ConfigPlazoMinimo> rwMap = new RowMapper<ConfigPlazoMinimo>() {
		@Override()
		public ConfigPlazoMinimo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			ConfigPlazoMinimo bean = new ConfigPlazoMinimo();
			bean.setId(resultSet.getInt("ID001"));
			bean.setNivelUsuario(resultSet.getString("NIVELUSUARIO001"));
			bean.setPalabrasTradHora(resultSet.getLong("PALABRASTRADHORA001"));
			bean.setPalabrasRevHora(resultSet.getLong("PALABRASREVHORA001"));
			bean.setHorasGestionTrad(resultSet.getLong("HORASGESTIONTRAD001"));
			bean.setHorasGestionRev(resultSet.getLong("HORASGESTIONREV001"));
			bean.setHorasEmisionPresupuesto(resultSet.getLong("HORASEMISIONPRESUPUESTO001"));
			bean.setHorasAceptPresupuesto(resultSet.getLong("HORASACEPTPRESUPUESTO001"));
			return bean;
		}
	};

	private RowMapper<ConfigPlazoMinimo> rwMapPK = new RowMapper<ConfigPlazoMinimo>() {
		@Override()
		public ConfigPlazoMinimo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			ConfigPlazoMinimo bean = new ConfigPlazoMinimo();
			bean.setId(resultSet.getInt("ID001"));
			bean.setNivelUsuario(resultSet.getString("NIVELUSUARIO001"));
			return bean;
		}
	};

	@Override()
	public ConfigPlazoMinimo update(ConfigPlazoMinimo configplazominimo) {
		String query = "UPDATE AA79B01S01 SET PALABRAS_TRAD_HORA_001=?, PALABRAS_REV_HORA_001=?, HORAS_GESTION_TRAD_001=?, HORAS_GESTION_REV_001=?, HORAS_EMISION_PRESUPUESTO_001=?, HORAS_ACEPT_PRESUPUESTO_001=? WHERE ID_001=? AND NIVEL_USUARIO_001=?";
		this.getJdbcTemplate().update(query, configplazominimo.getPalabrasTradHora(),
				configplazominimo.getPalabrasRevHora(), configplazominimo.getHorasGestionTrad(),
				configplazominimo.getHorasGestionRev(), configplazominimo.getHorasEmisionPresupuesto(),
				configplazominimo.getHorasAceptPresupuesto(), configplazominimo.getId(),
				configplazominimo.getNivelUsuario());
		return configplazominimo;
	}

	@Override()
	protected String getSelect() {
		StringBuilder query = new StringBuilder(
				"SELECT  t1.ID_001 ID001,t1.NIVEL_USUARIO_001 NIVELUSUARIO001,t1.PALABRAS_TRAD_HORA_001 PALABRASTRADHORA001,t1.PALABRAS_REV_HORA_001 PALABRASREVHORA001,t1.HORAS_GESTION_TRAD_001 HORASGESTIONTRAD001,t1.HORAS_GESTION_REV_001 HORASGESTIONREV001,t1.HORAS_EMISION_PRESUPUESTO_001 HORASEMISIONPRESUPUESTO001,t1.HORAS_ACEPT_PRESUPUESTO_001 HORASACEPTPRESUPUESTO001 ");
		return query.toString();
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B01S01 t1";
	}

	@Override()
	protected RowMapper<ConfigPlazoMinimo> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ConfigPlazoMinimoDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_001 || '_' || NIVEL_USUARIO_001";
	}

	@Override()
	protected RowMapper<ConfigPlazoMinimo> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(ConfigPlazoMinimo bean, List<Object> params) {
		params.add(bean.getId());
		params.add(bean.getNivelUsuario());
		return " WHERE t1.ID_001 = ? AND t1.NIVEL_USUARIO_001 = ?";
	}

	@Override
	protected String getWhere(ConfigPlazoMinimo bean, List<Object> params) {

		StringBuilder where = new StringBuilder(ConfigPlazoMinimoDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual("ID_001", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("NIVEL_USUARIO_001", bean.getNivelUsuario(), params));
		where.append(SqlUtils.generarWhereIgual("PALABRAS_TRAD_HORA_001", bean.getPalabrasTradHora(), params));
		where.append(SqlUtils.generarWhereIgual("PALABRAS_REV_HORA_001", bean.getPalabrasRevHora(), params));
		where.append(SqlUtils.generarWhereIgual("HORAS_GESTION_TRAD_001", bean.getHorasGestionTrad(), params));
		where.append(SqlUtils.generarWhereIgual("HORAS_GESTION_REV_001", bean.getHorasGestionRev(), params));
		where.append(SqlUtils.generarWhereIgual("HORAS_EMISION_PRESUPUESTO_001", bean.getHorasEmisionPresupuesto(), params));
		where.append(SqlUtils.generarWhereIgual("HORAS_ACEPT_PRESUPUESTO_001", bean.getHorasAceptPresupuesto(), params));

		return where.toString();
	}

	@Override
	protected String getWhereLike(ConfigPlazoMinimo bean, Boolean startsWith, List<Object> params, Boolean search) {

		StringBuilder whereLike = new StringBuilder(ConfigPlazoMinimoDaoImpl.STRING_BUILDER_INIT);
		
		whereLike.append(SqlUtils.generarWhereIgual("ID_001", bean.getId(), params));
		whereLike.append(SqlUtils.generarWhereIgual("NIVEL_USUARIO_001", bean.getNivelUsuario(), params));
		whereLike.append(SqlUtils.generarWhereIgual("PALABRAS_TRAD_HORA_001", bean.getPalabrasTradHora(), params));
		whereLike.append(SqlUtils.generarWhereIgual("PALABRAS_REV_HORA_001", bean.getPalabrasRevHora(), params));
		whereLike.append(SqlUtils.generarWhereIgual("HORAS_GESTION_TRAD_001", bean.getHorasGestionTrad(), params));
		whereLike.append(SqlUtils.generarWhereIgual("HORAS_GESTION_REV_001", bean.getHorasGestionRev(), params));
		whereLike.append(SqlUtils.generarWhereIgual("HORAS_EMISION_PRESUPUESTO_001", bean.getHorasEmisionPresupuesto(), params));
		whereLike.append(SqlUtils.generarWhereIgual("HORAS_ACEPT_PRESUPUESTO_001", bean.getHorasAceptPresupuesto(), params));

		return whereLike.toString();
	}
}
