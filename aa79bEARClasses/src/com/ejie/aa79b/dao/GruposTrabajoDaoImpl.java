package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Locale;

import org.apache.commons.lang.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.i18n.LocaleContextHolder;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.Constants;
import com.ejie.aa79b.common.DBConstants;
import com.ejie.aa79b.common.PropertiesConstants;
import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.dao.mapper.CamposBusqGenRM;
import com.ejie.aa79b.dao.mapper.GruposTrabajoRowMapper;
import com.ejie.aa79b.model.Entidad;
import com.ejie.aa79b.model.GruposTrabajo;
import com.ejie.aa79b.model.PersonalIZO;
import com.ejie.aa79b.model.enums.EstadoEnum;
import com.ejie.aa79b.model.enums.TipoEntidadEnum;
import com.ejie.aa79b.model.enums.TipoExpedienteGrupoEnum;

/**
 * GruposTrabajoDaoImpl generated by UDA, 24-nov-2017 10:10:28.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class GruposTrabajoDaoImpl extends GenericoDaoImpl<GruposTrabajo> implements GruposTrabajoDao {

	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

	public GruposTrabajoDaoImpl() {
		super(GruposTrabajo.class);
	}

	public static final String[] ORDER_BY_WHITE_LIST = new String[] { DBConstants.ID026, "IDTIPOEXPEDIENTE026",
			"DESCEU026", "INDBOPV026", "INDPREVISTOBOPV026", "DNIRESPONSABLE026", "PALABRASDESDE026",
			"PALABRASHASTA026", "ESTADO026", "FECHAALTA026", "FECHABAJA026", "ENTIDADESIDGRUPO027",
			"ENTIDADESIDENTIDAD027", "TRABAJADORESIDGRUPO028", "TRABAJADORESCODTRABAJADOR028", "TIPOEXPEDIENTEDESC",
			DBConstants.BOPVDESC, DBConstants.PREVISTOBOPVDESC, DBConstants.ESTADODESC, DBConstants.NOMBRECOMPLETO };

	/*
	 * ROW_MAPPERS
	 */

	private class GruposTrabajoRM implements RowMapper<GruposTrabajo> {
		@Override()
		public GruposTrabajo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			GruposTrabajo bean = new GruposTrabajo();
			bean.setId(resultSet.getLong(DBConstants.ID026));
			bean.setIdTipoExpediente(resultSet.getInt("IDTIPOEXPEDIENTE026"));
			bean.setTipoExpedienteDesc(resultSet.getString("TIPOEXPEDIENTEDESC"));
			bean.setDescEu(resultSet.getString("DESCEU026"));
			bean.setIndBopv(resultSet.getString("INDBOPV026"));
			bean.setBopvDesc(resultSet.getString(DBConstants.BOPVDESC));
			bean.setIndPrevistoBopv(resultSet.getString("INDPREVISTOBOPV026"));
			bean.setPrevistoBopvDesc(resultSet.getString(DBConstants.PREVISTOBOPVDESC));
			PersonalIZO responsable = new PersonalIZO();
			responsable.setDni(resultSet.getString(DBConstants.DNI));
			responsable.setNombre(resultSet.getString(DBConstants.NOMBRE));
			responsable.setApellido1(resultSet.getString(DBConstants.APEL1));
			responsable.setApellido2(resultSet.getString(DBConstants.APEL2));
			responsable.setTipIden(resultSet.getInt(DBConstants.TIPIDEN));
			responsable.setPreDni(resultSet.getString(DBConstants.PREDNI));
			responsable.setSufDni(resultSet.getString(DBConstants.SUFDNI));
			bean.setResponsable(responsable);
			bean.setPalabrasDesde(SqlUtils.getLong(resultSet, "PALABRASDESDE026"));
			bean.setPalabrasHasta(SqlUtils.getLong(resultSet, "PALABRASHASTA026"));
			bean.setEstado(resultSet.getString("ESTADO026"));
			bean.setEstadoDesc(resultSet.getString(DBConstants.ESTADODESC));
			bean.setFechaAlta(resultSet.getDate("FECHAALTA026"));
			bean.setFechaBaja(resultSet.getDate("FECHABAJA026"));
			return bean;
		}
	}

	private RowMapper<GruposTrabajo> rwMapGruposTrabajo = new GruposTrabajoRM();

	private RowMapper<GruposTrabajo> rwMapPK = new RowMapper<GruposTrabajo>() {
		@Override()
		public GruposTrabajo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new GruposTrabajo(resultSet.getLong(DBConstants.ID026));
		}
	};

	private RowMapper<GruposTrabajo> rwMapCampos = new CamposBusqGenRM();

	private RowMapper<GruposTrabajo> rwMap = new GruposTrabajoRowMapper();

	/*
	 * OPERACIONES CRUD
	 */

	@Override()
	public GruposTrabajo add(GruposTrabajo bean) {
		bean.setId(this.getNextVal("AA79B26Q00"));
		bean.setFechaAlta(new Date());
		if (Constants.BAJA.equals(bean.getEstado())) {
			bean.setFechaBaja(new Date());
		}
		if (StringUtils.isBlank(bean.getIndBopv())) {
			bean.setIndBopv(Constants.NO);
		}
		if (StringUtils.isBlank(bean.getIndPrevistoBopv())) {
			bean.setIndPrevistoBopv(Constants.NO);
		}
		String query = "INSERT INTO AA79B26S01 (ID_026, ID_TIPO_EXPEDIENTE_026, DESC_EU_026, IND_BOPV_026, IND_PREVISTO_BOPV_026, DNI_RESPONSABLE_026, PALABRAS_DESDE_026, PALABRAS_HASTA_026, ESTADO_026, FECHA_ALTA_026, FECHA_BAJA_026) VALUES (?,?,?,?,?,?,?,?,?,?,?)";
		this.getJdbcTemplate().update(query, bean.getId(), bean.getIdTipoExpediente(), bean.getDescEu(),
				bean.getIndBopv(), bean.getIndPrevistoBopv(), bean.getResponsable().getDni(), bean.getPalabrasDesde(),
				bean.getPalabrasHasta(), bean.getEstado(), bean.getFechaAlta(), bean.getFechaBaja());
		return bean;
	}

	/**
	 * Updates a single row in the GruposTrabajo table.
	 *
	 * @param bean GruposTrabajo
	 * @return GruposTrabajo
	 */
	@Override()
	public GruposTrabajo update(GruposTrabajo bean) {
		if (StringUtils.isBlank(bean.getIndBopv())) {
			bean.setIndBopv(Constants.NO);
		}
		if (StringUtils.isBlank(bean.getIndPrevistoBopv())) {
			bean.setIndPrevistoBopv(Constants.NO);
		}
		String query = "UPDATE AA79B26S01 SET ID_TIPO_EXPEDIENTE_026=?, DESC_EU_026=?, IND_BOPV_026=?, IND_PREVISTO_BOPV_026=?, DNI_RESPONSABLE_026=?, PALABRAS_DESDE_026=?, PALABRAS_HASTA_026=?, ESTADO_026=? WHERE ID_026=?";
		this.getJdbcTemplate().update(query, bean.getIdTipoExpediente(), bean.getDescEu(), bean.getIndBopv(),
				bean.getIndPrevistoBopv(), bean.getResponsable().getDni(), bean.getPalabrasDesde(),
				bean.getPalabrasHasta(), bean.getEstado(), bean.getId());

		if (Constants.BAJA.equals(bean.getEstado())) {
			this.getJdbcTemplate().update("UPDATE AA79B26S01 SET FECHA_BAJA_026=SYSDATE WHERE ID_026=?", bean.getId());
		} else {
			this.getJdbcTemplate().update("UPDATE AA79B26S01 SET FECHA_BAJA_026=NULL WHERE ID_026=?", bean.getId());
		}

		return bean;
	}

	@Override()
	public void remove(GruposTrabajo grupostrabajo) {
		String query = "DELETE FROM AA79B26S01 WHERE ID_026=?";
		this.getJdbcTemplate().update(query, grupostrabajo.getId());
	}

	@Override()
	protected String getSelect() {

		Locale locale = LocaleContextHolder.getLocale();
		StringBuilder selectGrupos = new StringBuilder();
		selectGrupos.append("SELECT  DISTINCT(t1.ID_026) ID026");
		selectGrupos.append(",t1.ID_TIPO_EXPEDIENTE_026 IDTIPOEXPEDIENTE026");
		selectGrupos.append(",t1.DESC_EU_026 DESCEU026");
		selectGrupos.append(",t1.IND_BOPV_026 INDBOPV026");
		selectGrupos.append(",t1.IND_PREVISTO_BOPV_026 INDPREVISTOBOPV026");
		selectGrupos.append(",t1.DNI_RESPONSABLE_026 DNIRESPONSABLE026");
		selectGrupos.append(",t1.PALABRAS_DESDE_026 PALABRASDESDE026");
		selectGrupos.append(",t1.PALABRAS_HASTA_026 PALABRASHASTA026");
		selectGrupos.append(",t1.ESTADO_026 ESTADO026");
		selectGrupos.append(",t1.FECHA_ALTA_026 FECHAALTA026");
		selectGrupos.append(",t1.FECHA_BAJA_026 FECHABAJA026");
		selectGrupos.append(", t1.DNI_RESPONSABLE_026 DNI");
		selectGrupos.append(
				", t2.NOMBRE_077 NOMBRE, t2.APEL1_077 APEL1, t2.APEL2_077 APEL2, t2.TIPIDEN_077 TIPIDEN, t2.PREDNI_077 PREDNI, t2.SUFDNI_077 SUFDNI");
		selectGrupos.append(", t2.APEL1_077 || ' ' || t2.APEL2_077 || ', ' || t2.NOMBRE_077 AS NOMBRECOMPLETO");
		selectGrupos.append(", DECODE(t1.ID_TIPO_EXPEDIENTE_026");
		for (TipoExpedienteGrupoEnum tipoExpediente : TipoExpedienteGrupoEnum.values()) {
			selectGrupos.append(", ").append(tipoExpediente.getValue());
			selectGrupos.append(", '").append(tipoExpediente.getCode()).append("'");
		}
		selectGrupos.append(") AS TIPOEXPEDIENTEDESC");
		selectGrupos.append(SqlUtils.generarDecodeSN("IND_BOPV_026", DBConstants.BOPVDESC, this.msg, locale));
		selectGrupos.append(
				SqlUtils.generarDecodeSN("IND_PREVISTO_BOPV_026", DBConstants.PREVISTOBOPVDESC, this.msg, locale));
		selectGrupos.append(SqlUtils.generarDecodeEstado("ESTADO_026", DBConstants.ESTADODESC, this.msg, locale));

		return selectGrupos.toString();
	}

	@Override()
	protected String getFrom() {
		StringBuilder fromGruposTrabajo = new StringBuilder();
		fromGruposTrabajo.append(" FROM AA79B26S01 t1");
		fromGruposTrabajo.append(" LEFT JOIN AA79B77S01 t2 ON t1.DNI_RESPONSABLE_026 = T2.DNI_077");
		return fromGruposTrabajo.toString();

	}

	@Override()
	protected RowMapper<GruposTrabajo> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_026";
	}

	@Override()
	protected RowMapper<GruposTrabajo> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(GruposTrabajo bean, List<Object> params) {
		params.add(bean.getId());
		return " WHERE ID_026 = ?";
	}

	@Override()
	protected String getWhere(GruposTrabajo bean, List<Object> params) {
		StringBuilder where = new StringBuilder(GruposTrabajoDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("t1.ID_026", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("t1.ID_TIPO_EXPEDIENTE_026", bean.getIdTipoExpediente(), params));
		where.append(SqlUtils.generarWhereIgual("t1.DESC_EU_026", bean.getDescEu(), params));
		where.append(SqlUtils.generarWhereIgual("t1.IND_BOPV_026", bean.getIndBopv(), params));
		where.append(SqlUtils.generarWhereIgual("t1.IND_PREVISTO_BOPV_026", bean.getIndPrevistoBopv(), params));
		where.append(SqlUtils.generarWhereIgual("t1.DNI_RESPONSABLE_026", bean.getResponsable().getDni(), params));
		where.append(SqlUtils.generarWhereIgual("t1.PALABRAS_DESDE_026", bean.getPalabrasDesde(), params));
		where.append(SqlUtils.generarWhereIgual("t1.PALABRAS_HASTA_026", bean.getPalabrasHasta(), params));
		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_026", bean.getEstado(), params));
		where.append(SqlUtils.generarWhereIgual("t1.FECHA_ALTA_026", bean.getFechaAlta(), params));
		where.append(SqlUtils.generarWhereIgual("t1.FECHA_BAJA_026", bean.getFechaBaja(), params));
		if (bean.isExcluirBOE()) {
			where.append(generarWhereNotInBOE(params));
		}

		return where.toString();
	}

	@Override()
	protected String getWhereLike(GruposTrabajo bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder whereLike = new StringBuilder(GruposTrabajoDaoImpl.STRING_BUILDER_INIT);
		whereLike.append(SqlUtils.generarWhereIgual("t1.ID_026", bean.getId(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.ID_TIPO_EXPEDIENTE_026", bean.getIdTipoExpediente(), params));
		whereLike.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_026", bean.getDescEu(), params, startsWith));
		whereLike.append(SqlUtils.generarWhereIgual("t1.IND_BOPV_026", bean.getIndBopv(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.IND_PREVISTO_BOPV_026", bean.getIndPrevistoBopv(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.DNI_RESPONSABLE_026", bean.getResponsable().getDni(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.PALABRAS_DESDE_026", bean.getPalabrasDesde(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.PALABRAS_HASTA_026", bean.getPalabrasHasta(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.ESTADO_026", bean.getEstado(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.FECHA_ALTA_026", bean.getFechaAlta(), params));
		whereLike.append(SqlUtils.generarWhereIgual("t1.FECHA_BAJA_026", bean.getFechaBaja(), params));

		Entidad entidadSolicitante = bean.getEntidadSolicitante();
		if (entidadSolicitante != null && StringUtils.isNotBlank(entidadSolicitante.getCodigoCompleto())) {
			whereLike.append(" AND ID_026 IN (SELECT NVL(ID_GRUPO_027, 0)");
			whereLike.append(" FROM X54JAPI_ENTIDADES_SOLIC");
			whereLike.append(" LEFT JOIN AA79B27S01 ON TIPO = TIPO_ENTIDAD_027 AND CODIGO = ID_ENTIDAD_027");
			whereLike.append(" WHERE TIPO = ? AND CODIGO = ?)");
			params.add(entidadSolicitante.getTipo());
			params.add(entidadSolicitante.getCodigo());
		}

		PersonalIZO traductor = bean.getTraductor();
		if (traductor != null && StringUtils.isNotBlank(traductor.getDni())) {
			whereLike.append(" AND ID_026 IN (SELECT ID_GRUPO_028 FROM AA79B28S01 WHERE DNI_TRABAJADOR_028 = ?)");
			params.add(traductor.getDni());
		}

		return whereLike.toString();
	}

	@Override()
	public Long countExiste(GruposTrabajo bean) {
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder("SELECT COUNT(1)");
		query.append(this.getFrom(bean, params));

		query.append(GruposTrabajoDaoImpl.DEFAULT_WHERE);
		query.append(SqlUtils.generarWhereDistinto("ID_026", bean.getId(), params));
		query.append(SqlUtils.generarWhereIgual("t1.ID_TIPO_EXPEDIENTE_026", bean.getIdTipoExpediente(), params));
		query.append(SqlUtils.generarWhereIgual("t1.IND_BOPV_026", bean.getIndBopv(), params));
		query.append(SqlUtils.generarWhereIgual("t1.IND_PREVISTO_BOPV_026", bean.getIndPrevistoBopv(), params));
		query.append(SqlUtils.generarWhereIgual("t1.ESTADO_026", bean.getEstado(), params));

		return this.getJdbcTemplate().queryForObject(query.toString(), params.toArray(), Long.class);
	}

	@Override()
	public Integer borrarEntidadesAsociadas(GruposTrabajo bean) {
		return this.getJdbcTemplate().update("DELETE FROM AA79B27S01 WHERE ID_GRUPO_027=?", bean.getId());
	}

	@Override()
	public List<GruposTrabajo> findAllLikeResponsable(GruposTrabajo bean) {
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder(this.getSelect());
		query.append(this.getFrom(bean, params));

		query.append(GenericoDaoImpl.DEFAULT_WHERE);
		query.append(this.getWhereLike(bean, false, params, false));

		if (Constants.BAJA.equals(bean.getResponsable().getEstado())) {
			query.append(" AND DNI_RESPONSABLE_026 NOT IN (SELECT DNI FROM X54JAPI_PERSONAL_IZO WHERE ASIGNADOR = ?)");
			params.add(Constants.SI);
		}

		query.append(" ORDER BY NOMBRECOMPLETO, DNI_RESPONSABLE_026, ID_026");

		return this.getJdbcTemplate().query(query.toString(), this.rwMapGruposTrabajo, params.toArray());
	}

	private class GruposTrabajoTradInterpRM extends GruposTrabajoRM {
		@Override()
		public GruposTrabajo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			GruposTrabajo bean = super.mapRow(resultSet, rowNum);
			PersonalIZO traductor = new PersonalIZO();
			traductor.setTipIden(resultSet.getInt("TIPIDEN028"));
			traductor.setPreDni(resultSet.getString("PREDNI028"));
			traductor.setDni(resultSet.getString("DNITRABAJADOR028"));
			traductor.setSufDni(resultSet.getString("SUFDNI028"));
			traductor.setNombre(resultSet.getString("NOMBRE028"));
			traductor.setApellido1(resultSet.getString("APEL1028"));
			traductor.setApellido2(resultSet.getString("APEL2028"));
			bean.setTraductor(traductor);
			return bean;
		}
	}

	private RowMapper<GruposTrabajo> rwMapTradInt = new GruposTrabajoTradInterpRM();

	@Override()
	public List<GruposTrabajo> findAllLikeTradInterp(GruposTrabajo bean) {
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder(this.getSelect());
		query.append(", ID_GRUPO_028 IDGRUPO028");
		query.append(", DNI_TRABAJADOR_028 DNITRABAJADOR028");
		query.append(
				", TRAD.TIPIDEN_077 TIPIDEN028, TRAD.PREDNI_077 PREDNI028, TRAD.DNI_077 DNI028, TRAD.SUFDNI_077 SUFDNI028, TRAD.NOMBRE_077 NOMBRE028, TRAD.APEL1_077 APEL1028, TRAD.APEL2_077 APEL2028");

		query.append(this.getFrom(bean, params));
		query.append(" JOIN AA79B28S01 t1 ON ID_GRUPO_028 = ID_026");
		query.append(" LEFT JOIN AA79B77S01 TRAD ON TRAD.DNI_077 = DNI_TRABAJADOR_028");

		query.append(GenericoDaoImpl.DEFAULT_WHERE);
		query.append(this.getWhereLike(bean, false, params, false));

		if (Constants.BAJA.equals(bean.getTraductor().getEstado())) {
			query.append(
					" AND DNI_TRABAJADOR_028 NOT IN (SELECT DNI FROM X54JAPI_PERSONAL_IZO WHERE TRADUCTOR = ? OR INTERPRETE = ?)");
			params.add(Constants.SI);
			params.add(Constants.SI);
		}

		query.append(" ORDER BY TRAD.APEL1_077, TRAD.APEL2_077, TRAD.NOMBRE_077, TRAD.DNI_077, ID_026");

		return this.getJdbcTemplate().query(query.toString(), this.rwMapTradInt, params.toArray());
	}

	private class GruposTrabajoEntidadesRM extends GruposTrabajoRM {
		@Override()
		public GruposTrabajo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			GruposTrabajo bean = super.mapRow(resultSet, rowNum);
			Entidad entidadSolicitante = new Entidad();
			entidadSolicitante.setTipo(resultSet.getString("TIPOENTIDAD027"));
			entidadSolicitante.setTipoDesc(resultSet.getString("TIPODESC"));
			entidadSolicitante.setCodigo(resultSet.getInt("IDENTIDAD027"));
			entidadSolicitante.setDescEs(resultSet.getString(DBConstants.DESCES));
			entidadSolicitante.setDescEu(resultSet.getString(DBConstants.DESCEU));
			bean.setEntidadSolicitante(entidadSolicitante);
			return bean;
		}
	}

	private RowMapper<GruposTrabajo> rwMapEnt = new GruposTrabajoEntidadesRM();

	@Override()
	public List<GruposTrabajo> findAllLikeEntidades(GruposTrabajo bean) {
		Locale locale = LocaleContextHolder.getLocale();
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder(this.getSelect());
		query.append(", TIPO TIPOENTIDAD027");
		query.append(", CODIGO IDENTIDAD027");
		query.append(", DESC_ES DESCES");
		query.append(", DESC_EU DESCEU");
		query.append(", DECODE(TIPO");
		for (TipoEntidadEnum tipo : TipoEntidadEnum.values()) {
			query.append(", '").append(tipo.getValue()).append("'");
			query.append(", '").append(this.msg.getMessage(tipo.getLabel(), null, locale)).append("'");
		}
		query.append(") AS TIPODESC");

		query.append(this.getFrom(bean, params));
		query.append(" JOIN AA79B27S01 t1 ON ID_GRUPO_027 = ID_026");
		query.append(" JOIN X54JAPI_ENTIDADES_SOLIC ENT ON TIPO = TIPO_ENTIDAD_027 AND CODIGO = ID_ENTIDAD_027");

		query.append(GenericoDaoImpl.DEFAULT_WHERE);
		query.append(this.getWhereLike(bean, false, params, false));

		query.append(SqlUtils.generarWhereIgual("ENT.ESTADO", bean.getEntidadSolicitante().getEstado(), params));

		query.append(" ORDER BY DESCEU, TIPO, CODIGO, ID_026");

		return this.getJdbcTemplate().query(query.toString(), this.rwMapEnt, params.toArray());
	}

	@Override
	public GruposTrabajo informarCamposGrupoTrabajo(GruposTrabajo gruposTrabajo) {
		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder();
		query.append("SELECT ");
		query.append("ID_TIPO_EXPEDIENTE_026 IDTIPOEXPEDIENTE, ");
		query.append("IND_BOPV_026 INDBOPV, ");
		query.append("IND_PREVISTO_BOPV_026 INDPREVBOPV, ");
		query.append("DNI_RESPONSABLE_026 DNIRESPOSNABLE, ");
		query.append("PALABRAS_DESDE_026 PALABRASDESDE, ");
		query.append("PALABRAS_HASTA_026 PALABRASHASTA ");
		query.append("FROM AA79B26S01 ");
		query.append("WHERE ID_026 = ?");
		params.add(gruposTrabajo.getId());
		return this.getJdbcTemplate().queryForObject(query.toString(), params.toArray(), this.rwMapCampos);
	}

	@Override()
	public List<GruposTrabajo> findAllLikeGruposTrabajo(GruposTrabajo gruposTrabajo) {
		List<GruposTrabajo> lstGruposTrabajo = new ArrayList<GruposTrabajo>();
		if (gruposTrabajo.getResponsable() != null && gruposTrabajo.getResponsable().getDni() != null) {
			List<Object> params = new ArrayList<Object>();
			StringBuilder query = new StringBuilder(this.getSelect());
			query.append(this.getFrom());
			query.append(GenericoDaoImpl.DEFAULT_WHERE);
			query.append(" AND t1.ESTADO_026 = '").append(EstadoEnum.ALTA.getValue()).append("'");
			query.append(" AND t1.DNI_RESPONSABLE_026 = ? ");
			params.add(gruposTrabajo.getResponsable().getDni());
			query.append(SqlUtils.generarWhereIgual(" t1.ID_TIPO_EXPEDIENTE_026 ", gruposTrabajo.getIdTipoExpediente(),
					params));
			lstGruposTrabajo = this.getJdbcTemplate().query(query.toString(), this.rwMap, params.toArray());
		}

		return lstGruposTrabajo;
	}

	private String generarWhereNotInBOE(List<Object> params) {
		StringBuilder whereNoBOE = new StringBuilder();
		whereNoBOE.append(" AND NOT EXISTS  (SELECT id_entidad_027 FROM AA79B27T00 WHERE ");
		whereNoBOE.append(" id_entidad_027 =  (select valor_000 from AA79B00T00 where id_000 = ?) ");
		whereNoBOE.append(" AND TIPO_ENTIDAD_027 ='B' AND id_GRUPO_027 = ID_026) ");
		params.add(PropertiesConstants.COD_ENTIDAD_BOE);
		return whereNoBOE.toString();
	}

}
