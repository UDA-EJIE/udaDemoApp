package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.TiposInterpretacion;

/**
 * TiposInterpretacionDaoImpl generated by UDA, 22-nov-2017 10:22:35.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class TiposInterpretacionDaoImpl extends GenericoDaoImpl<TiposInterpretacion> implements TiposInterpretacionDao {

	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

	public TiposInterpretacionDaoImpl() {
		super(TiposInterpretacion.class);
	}

	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { "ID008", "DESCES008", "DESCEU008", "ESTADO008",
			"TIPOFACTURACION008", "ESTADODESCES", "ESTADODESCEU", "DESCFACTURAES", "DESCFACTURAEU", "DESCNORMEU",
			"DESCNORMES" };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<TiposInterpretacion> rwMap = new RowMapper<TiposInterpretacion>() {
		@Override
		public TiposInterpretacion mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			TiposInterpretacion tipo = new TiposInterpretacion(resultSet.getLong("ID008"),
					resultSet.getString("DESCES008"), resultSet.getString("DESCEU008"),
					resultSet.getString("ESTADO008"), resultSet.getString("TIPOFACTURACION008"));

			tipo.setDescEstadoEs(resultSet.getString("ESTADODESCES"));
			tipo.setDescEstadoEu(resultSet.getString("ESTADODESCEU"));
			tipo.setDescFacturaEs(resultSet.getString("DESCFACTURAES"));
			tipo.setDescFacturaEu(resultSet.getString("DESCFACTURAEU"));
			return tipo;
		}
	};

	private RowMapper<TiposInterpretacion> rwMapPK = new RowMapper<TiposInterpretacion>() {
		@Override
		public TiposInterpretacion mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new TiposInterpretacion(resultSet.getLong("ID008"), resultSet.getString("DESCES008"),
					resultSet.getString("DESCEU008"), resultSet.getString("ESTADO008"),
					resultSet.getString("TIPOFACTURACION008"));
		}
	};

	@Override
	public TiposInterpretacion add(TiposInterpretacion tiposinterpretacion) {
		String query = "INSERT INTO AA79B08S01 (ID_008, DESC_ES_008, DESC_EU_008, ESTADO_008, TIPO_FACTURACION_008) VALUES (AA79B08Q00.NEXTVAL,?,?,?,?)";
		this.getJdbcTemplate().update(query, tiposinterpretacion.getDescEs008(), tiposinterpretacion.getDescEu008(),
				tiposinterpretacion.getEstado008(), tiposinterpretacion.getTipoFacturacion008());
		return tiposinterpretacion;
	}

	/**
	 * Updates a single row in the TiposInterpretacion table.
	 *
	 * @param tiposinterpretacion
	 *            TiposInterpretacion
	 * @return TiposInterpretacion
	 */
	@Override
	public TiposInterpretacion update(TiposInterpretacion tiposinterpretacion) {
		String query = "UPDATE AA79B08S01 SET DESC_EU_008=?, DESC_ES_008=?, ESTADO_008=?, TIPO_FACTURACION_008=? WHERE ID_008=?";
		this.getJdbcTemplate().update(query, tiposinterpretacion.getDescEu008(), tiposinterpretacion.getDescEs008(),
				tiposinterpretacion.getEstado008(), tiposinterpretacion.getTipoFacturacion008(),
				tiposinterpretacion.getId008());
		return tiposinterpretacion;
	}

	@Override
	protected String getSelect() {
		Locale es = new Locale("es");
		Locale eu = new Locale("eu");
		StringBuilder selectTiposInterpretacion = new StringBuilder();

		selectTiposInterpretacion.append("SELECT  t1.ID_008 ID008");
		selectTiposInterpretacion.append(",  t1.DESC_EU_008 DESCEU008");
		selectTiposInterpretacion.append(", t1.DESC_ES_008 DESCES008");
		selectTiposInterpretacion.append(", t1.ESTADO_008 ESTADO008");
		selectTiposInterpretacion.append(", t1.TIPO_FACTURACION_008 TIPOFACTURACION008");
		selectTiposInterpretacion.append(", DECODE(t1.ESTADO_008, 'A', '")
				.append(this.msg.getMessage("estado.alta", null, es)).append("', 'B', '")
				.append(this.msg.getMessage("estado.baja", null, es)).append("') AS ESTADODESCES");
		selectTiposInterpretacion.append(", DECODE(t1.ESTADO_008, 'A', '")
				.append(this.msg.getMessage("estado.alta", null, eu)).append("', 'B', '")
				.append(this.msg.getMessage("estado.baja", null, eu)).append("') AS ESTADODESCEU");

		selectTiposInterpretacion.append(", DECODE(t1.TIPO_FACTURACION_008, 'I', '")
				.append(this.msg.getMessage("facturacion.eurointerprete", null, es)).append("', 'H', '")
				.append(this.msg.getMessage("facturacion.eurohorainterprete", null, es)).append("') AS DESCFACTURAES");
		selectTiposInterpretacion.append(", DECODE(t1.TIPO_FACTURACION_008, 'I', '")
				.append(this.msg.getMessage("facturacion.eurointerprete", null, eu)).append("', 'H', '")
				.append(this.msg.getMessage("facturacion.eurohorainterprete", null, eu)).append("') AS DESCFACTURAEU");
		selectTiposInterpretacion.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_EU_008"))
				.append(" AS DESCNORMEU");
		selectTiposInterpretacion.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_ES_008"))
				.append(" AS DESCNORMES");

		return selectTiposInterpretacion.toString();
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B08S01 t1";
	}

	@Override()
	protected RowMapper<TiposInterpretacion> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return TiposInterpretacionDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_008";
	}

	@Override()
	protected RowMapper<TiposInterpretacion> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(TiposInterpretacion bean, List<Object> params) {
		params.add(bean.getId008());
		return " WHERE t1.ID_008 = ?";
	}

	@Override
	protected String getWhere(TiposInterpretacion bean, List<Object> params) {
		StringBuilder where = new StringBuilder(TiposInterpretacionDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual("t1.ID_008", bean.getId008(), params));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_ES_008", bean.getDescEs008(), params, false));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_008", bean.getDescEu008(), params, false));

		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_008", bean.getEstado008(), params));

		where.append(SqlUtils.generarWhereIgual("t1.TIPO_FACTURACION_008", bean.getTipoFacturacion008(), params));

		Map<String, Object> mapWhere = new HashMap<String, Object>();
		mapWhere.put("query", where);
		mapWhere.put("params", params);

		return where.toString();
	}

	@Override
	protected String getWhereLike(TiposInterpretacion bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(TiposInterpretacionDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("t1.ID_008", bean.getId008(), params));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_ES_008", bean.getDescEs008(), params, startsWith));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_008", bean.getDescEu008(), params, startsWith));

		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_008", bean.getEstado008(), params));

		where.append(SqlUtils.generarWhereIgual("t1.TIPO_FACTURACION_008", bean.getTipoFacturacion008(), params));

		Map<String, Object> mapWhere = new HashMap<String, Object>();
		mapWhere.put("query", where);
		mapWhere.put("params", params);

		return where.toString();
	}

}
