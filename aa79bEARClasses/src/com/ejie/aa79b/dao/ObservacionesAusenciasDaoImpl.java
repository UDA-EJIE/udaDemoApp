package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.dao.support.DataAccessUtils;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ObservacionesAusencias;

/**
 * ObservacionesAusenciasDaoImpl generated by UDA, 25-ene-2018 13:44:11.
 * @author UDA
 */

@Repository
@Transactional
public class ObservacionesAusenciasDaoImpl extends GenericoDaoImpl<ObservacionesAusencias> implements ObservacionesAusenciasDao {

    public ObservacionesAusenciasDaoImpl() {
        /* Constructor */
        super(ObservacionesAusencias.class);
    }
    
    protected static final String[] ORDER_BY_WHITE_LIST = new String[] {"IDAUSENCIA076", "OBSERVDIA076"};

    /*
	 * ROW_MAPPERS
	 */
	private RowMapper<ObservacionesAusencias> rwMap = new RowMapper<ObservacionesAusencias>() {
		@Override
        public ObservacionesAusencias mapRow(ResultSet resultSet, int rowNum) throws SQLException {
           return new ObservacionesAusencias(
               resultSet.getInt("IDAUSENCIA076"), resultSet.getString("OBSERVDIA076")
           ); 
       } 
	} ;

	private RowMapper<ObservacionesAusencias> rwMapPK = new RowMapper<ObservacionesAusencias>() {
		@Override
        public ObservacionesAusencias mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ObservacionesAusencias(
				resultSet.getInt("IDAUSENCIA076")
           ); 
		}
	} ;

	
	/*
	 * OPERACIONES CRUD
	 */

    /**
     * Inserts a single row in the ObservacionesAusencias table.
     *
     * @param observacionesausencias ObservacionesAusencias
     * @return ObservacionesAusencias
     */
	@Override
    public ObservacionesAusencias add(ObservacionesAusencias observacionesausencias) {
    	String query = "INSERT INTO AA79B76S01 (ID_AUSENCIA_076, OBSERV_DIA_076) VALUES (?,?)";
		this.getJdbcTemplate().update(query, observacionesausencias.getIdAusencia076(), observacionesausencias.getObservDia076());
		return observacionesausencias;
	}

    /**
     * Updates a single row in the ObservacionesAusencias table.
     *
     * @param observacionesausencias ObservacionesAusencias
     * @return ObservacionesAusencias
     */
    @Override
    public ObservacionesAusencias update(ObservacionesAusencias observacionesausencias) {
		String query = "UPDATE AA79B76S01 SET OBSERV_DIA_076=? WHERE ID_AUSENCIA_076=?";
		this.getJdbcTemplate().update(query, observacionesausencias.getObservDia076(), observacionesausencias.getIdAusencia076());
		return observacionesausencias;
	}
    
    /**
     * Removes a single row in the ObservacionesAusencias table.
     *
     * @param observacionesausencias ObservacionesAusencias
     * @return
     */
    @Override
    public void remove(ObservacionesAusencias observacionesausencias) {
        String query = "DELETE FROM AA79B76S01 WHERE ID_AUSENCIA_076=?";
        this.getJdbcTemplate().update(query, observacionesausencias.getIdAusencia076());
    }
    /**
     * Finds a single row in the ObservacionesAusencias table.
     *
     * @param observacionesausencias ObservacionesAusencias
     * @return ObservacionesAusencias
     */
    @Override
    @Transactional (readOnly = true)
    public ObservacionesAusencias find(ObservacionesAusencias observacionesausencias) {
		String query = "FROM AA79B76S01 t1  WHERE t1.ID_AUSENCIA_076 = ?  ";

		List<ObservacionesAusencias> observacionesausenciasList = this.getJdbcTemplate().query(query, this.rwMap, observacionesausencias.getIdAusencia076());
		return DataAccessUtils.uniqueResult(observacionesausenciasList);
    }

    @Override()
    protected String getSelect() {
        StringBuilder sb = new StringBuilder();
        sb.append("SELECT t1.ID_AUSENCIA_076 IDAUSENCIA076, t1.OBSERV_DIA_076 OBSERVDIA076 ");       
        return sb.toString();
    }
    @Override()
    protected String getFrom() {
        return "  FROM AA79B76S01 t1 ";
    }

    @Override()
    protected RowMapper<ObservacionesAusencias> getRwMap() {
        return this.rwMap;
    }

    @Override()
    protected String[] getOrderBy() {
        return TiposRevisionDaoImpl.ORDER_BY_WHITE_LIST;
    }

    @Override()
    protected String getPK() {
        return "ID_AUSENCIA_076";
    }

    @Override()
    protected RowMapper<ObservacionesAusencias> getRwMapPK() {
        return this.rwMapPK;
    }

    @Override()
    protected String getWherePK(ObservacionesAusencias bean, List<Object> params) {
        params.add(bean.getIdAusencia076());
        return " WHERE t1.ID_AUSENCIA_076 = ? ";
    }

    @Override
    protected String getWhere(ObservacionesAusencias bean, List<Object> params) {

        StringBuilder where = new StringBuilder(ObservacionesAusenciasDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual("ID_AUSENCIA_076", bean.getIdAusencia076(), params));
        where.append(SqlUtils.generarWhereLikeNormalizado("OBSERV_DIA_076", bean.getObservDia076(), params, false));
      
        return where.toString();
    }

    @Override
    protected String getWhereLike(ObservacionesAusencias bean, Boolean startsWith, List<Object> params, Boolean search) {
        StringBuilder where = new StringBuilder(TiposRevisionDaoImpl.STRING_BUILDER_INIT);
        where.append(SqlUtils.generarWhereIgual("ID_AUSENCIA_076", bean.getIdAusencia076(), params));
        where.append(SqlUtils.generarWhereLikeNormalizado("OBSERV_DIA_076", bean.getObservDia076(), params, startsWith));
        return where.toString();
    }

}

