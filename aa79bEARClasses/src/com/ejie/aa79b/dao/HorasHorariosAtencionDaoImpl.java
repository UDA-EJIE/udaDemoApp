package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.HorasHorariosAtencion;

/**
 * HorasHorariosDaoImpl generated by UDA, 21-nov-2017 14:44:52.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class HorasHorariosAtencionDaoImpl extends GenericoDaoImpl<HorasHorariosAtencion>
        implements HorasHorariosAtencionDao {    

    protected static final String INDVERANO021 = "INDVERANO021";
    protected static final String IDHORARIO021 = "IDHORARIO021";
    protected static final String[] ORDER_BY_WHITE_LIST = new String[] { IDHORARIO021, INDVERANO021, "HORAINILJM021",
            "HORAFINLJM021", "HORAINILJT021", "HORAFINLJT021", "HORAINIVM021", "HORAFINVM021", "HORAINIVT021",
            "HORAFINVT021" };  

    /*
     * ROW_MAPPERS
     */
    private RowMapper<HorasHorariosAtencion> rwMap = new RowMapper<HorasHorariosAtencion>() {
        @Override()
        public HorasHorariosAtencion mapRow(ResultSet resultSet, int rowNum) throws SQLException {

            HorasHorariosAtencion hhaAux = new HorasHorariosAtencion(resultSet.getLong(IDHORARIO021),
                    resultSet.getString(INDVERANO021));
            hhaAux.setHoraIniLjM021(resultSet.getString("HORAINILJM021"));
            hhaAux.setHoraFinLjM021(resultSet.getString("HORAFINLJM021"));
            hhaAux.setHoraIniLjT021(resultSet.getString("HORAINILJT021"));
            hhaAux.setHoraFinLjT021(resultSet.getString("HORAFINLJT021"));
            hhaAux.setHoraIniVM021(resultSet.getString("HORAINIVM021"));
            hhaAux.setHoraFinVM021(resultSet.getString("HORAFINVM021"));
            hhaAux.setHoraIniVT021(resultSet.getString("HORAINIVT021"));
            hhaAux.setHoraFinVT021(resultSet.getString("HORAFINVT021"));
            return hhaAux;
        }
    };

    private RowMapper<HorasHorariosAtencion> rwMapPK = new RowMapper<HorasHorariosAtencion>() {
        @Override()
        public HorasHorariosAtencion mapRow(ResultSet resultSet, int rowNum) throws SQLException {
            return new HorasHorariosAtencion(resultSet.getLong(IDHORARIO021), resultSet.getString(INDVERANO021));
        }
    };
    
    /**
     * Constructor
     */
    public HorasHorariosAtencionDaoImpl() {
        super(HorasHorariosAtencion.class);
    }
    
    @Override()
    public HorasHorariosAtencion add(HorasHorariosAtencion horashorarios) {
        String query = "INSERT INTO AA79B21S01 (ID_HORARIO_021, IND_VERANO_021, HORA_INI_LJ_M_021, HORA_FIN_LJ_M_021, HORA_INI_LJ_T_021, HORA_FIN_LJ_T_021, HORA_INI_V_M_021, HORA_FIN_V_M_021, HORA_INI_V_T_021, HORA_FIN_V_T_021) VALUES (?,?,?,?,?,?,?,?,?,?)";
        this.getJdbcTemplate().update(query, horashorarios.getIdHorario021(), horashorarios.getIndVerano021(),
                horashorarios.getHoraIniLjM021(), horashorarios.getHoraFinLjM021(), horashorarios.getHoraIniLjT021(),
                horashorarios.getHoraFinLjT021(), horashorarios.getHoraIniVM021(), horashorarios.getHoraFinVM021(),
                horashorarios.getHoraIniVT021(), horashorarios.getHoraFinVT021());
        return horashorarios;
    }

    @Override()
    public HorasHorariosAtencion update(HorasHorariosAtencion horashorarios) {
        String query = "UPDATE AA79B21S01 SET HORA_INI_LJ_M_021=?, HORA_FIN_LJ_M_021=?, HORA_INI_LJ_T_021=?, HORA_FIN_LJ_T_021=?, HORA_INI_V_M_021=?, HORA_FIN_V_M_021=?, HORA_INI_V_T_021=?, HORA_FIN_V_T_021=? WHERE ID_HORARIO_021=? AND IND_VERANO_021=?";
        this.getJdbcTemplate().update(query, horashorarios.getHoraIniLjM021(), horashorarios.getHoraFinLjM021(),
                horashorarios.getHoraIniLjT021(), horashorarios.getHoraFinLjT021(), horashorarios.getHoraIniVM021(),
                horashorarios.getHoraFinVM021(), horashorarios.getHoraIniVT021(), horashorarios.getHoraFinVT021(),
                horashorarios.getIdHorario021(), horashorarios.getIndVerano021());
        return horashorarios;
    }

    @Override()
    public void remove(HorasHorariosAtencion horashorarios) {
        String query = "DELETE FROM AA79B21S01 WHERE ID_HORARIO_021=? AND IND_VERANO_021=?";
        this.getJdbcTemplate().update(query, horashorarios.getIdHorario021(), horashorarios.getIndVerano021());
    }

    @Override()
    protected String getSelect() {
        StringBuilder query = new StringBuilder(
                "SELECT t1.ID_HORARIO_021 IDHORARIO021, t1.IND_VERANO_021 INDVERANO021, t1.HORA_INI_LJ_M_021 HORAINILJM021, t1.HORA_FIN_LJ_M_021 HORAFINLJM021, t1.HORA_INI_LJ_T_021 HORAINILJT021, t1.HORA_FIN_LJ_T_021 HORAFINLJT021, t1.HORA_INI_V_M_021 HORAINIVM021, t1.HORA_FIN_V_M_021 HORAFINVM021, t1.HORA_INI_V_T_021 HORAINIVT021, t1.HORA_FIN_V_T_021 HORAFINVT021 ");
        return query.toString();
    }

    @Override()
    protected String getFrom() {
        return " FROM AA79B21S01 t1 ";
    }

    @Override()
    protected RowMapper<HorasHorariosAtencion> getRwMap() {
        return this.rwMap;
    }

    @Override()
    protected String[] getOrderBy() {
        return HorasHorariosAtencionDaoImpl.ORDER_BY_WHITE_LIST;
    }

    @Override()
    protected String getPK() {
        return "ID_HORARIO_021 || '_' || IND_VERANO_021";
    }

    @Override()
    protected RowMapper<HorasHorariosAtencion> getRwMapPK() {
        return this.rwMapPK;
    }

    @Override()
    protected String getWherePK(HorasHorariosAtencion bean, List<Object> params) {
        params.add(bean.getIdHorario021());
        params.add(bean.getIndVerano021());
        return " WHERE t1.ID_HORARIO_021 = ? AND t1.IND_VERANO_021 = ?";
    }
    /*
     * MÃ‰TODOS PRIVADOS
     */

    @Override()
    protected String getWhere(HorasHorariosAtencion bean, List<Object> params) {

        StringBuilder where = new StringBuilder(HorasHorariosAtencionDaoImpl.STRING_BUILDER_INIT);

        where.append(SqlUtils.generarWhereIgual("ID_021", bean.getIdHorario021(), params));
        where.append(SqlUtils.generarWhereIgual("IND_VERANO_021", bean.getIndVerano021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_M_021", bean.getHoraIniLjM021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_M_021", bean.getHoraFinLjM021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_T_021", bean.getHoraIniLjT021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_T_021", bean.getHoraFinLjT021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_V_M_021", bean.getHoraIniVM021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_V_M_021", bean.getHoraFinVM021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_INI_V_T_021", bean.getHoraIniVT021(), params));
        where.append(SqlUtils.generarWhereIgual("HORA_FIN_V_T_021", bean.getHoraFinVT021(), params));
        return where.toString();
    }

    @Override
    protected String getWhereLike(HorasHorariosAtencion bean, Boolean startsWith, List<Object> params, Boolean search) {

        StringBuilder whereLike = new StringBuilder(HorasHorariosAtencionDaoImpl.STRING_BUILDER_INIT);
        whereLike.append(SqlUtils.generarWhereIgual("ID_021", bean.getIdHorario021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("IND_VERANO_021", bean.getIndVerano021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_M_021", bean.getHoraIniLjM021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_M_021", bean.getHoraFinLjM021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_LJ_T_021", bean.getHoraIniLjT021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_LJ_T_021", bean.getHoraFinLjT021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_V_M_021", bean.getHoraIniVM021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_V_M_021", bean.getHoraFinVM021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_INI_V_T_021", bean.getHoraIniVT021(), params));
        whereLike.append(SqlUtils.generarWhereIgual("HORA_FIN_V_T_021", bean.getHoraFinVT021(), params));
        // si recibe una lista de ids de HorariosAtencion...
        if ( bean.getIdsHorariosAtencion() != null && !bean.getIdsHorariosAtencion().isEmpty()) {
            whereLike.append(SqlUtils.generarWhereIn("t1.ID_HORARIO_021", bean.getIdsHorariosAtencion(), params));
        }
        return whereLike.toString();
    }

}
