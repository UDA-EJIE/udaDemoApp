package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.Motivosrechazo;

/**
 * MotivosrechazoDaoImpl generated by UDA, 08-nov-2017 13:51:14.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class MotivosrechazoDaoImpl extends GenericoDaoImpl<Motivosrechazo> implements MotivosrechazoDao {

	@Autowired()
	private ReloadableResourceBundleMessageSource msg;

	public MotivosrechazoDaoImpl() {
		super(Motivosrechazo.class);
	}

	protected static final String[] ORDER_BY_WHITE_LIST = new String[] { "ID013", "ESTADO013", "DESCES013", "DESCEU013",
			"ESTADODESCES", "ESTADODESCEU", "DESCNORMEU", "DESCNORMES" };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<Motivosrechazo> rwMap = new RowMapper<Motivosrechazo>() {
		@Override
		public Motivosrechazo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			Motivosrechazo motivo = new Motivosrechazo(resultSet.getLong("ID013"), resultSet.getString("ESTADO013"),
					resultSet.getString("DESCES013"), resultSet.getString("DESCEU013"));

			motivo.setDescEstadoEs(resultSet.getString("ESTADODESCES"));
			motivo.setDescEstadoEu(resultSet.getString("ESTADODESCEU"));
			return motivo;
		}
	};

	private RowMapper<Motivosrechazo> rwMapPK = new RowMapper<Motivosrechazo>() {
		@Override
		public Motivosrechazo mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new Motivosrechazo(resultSet.getLong("ID013"), resultSet.getString("ESTADO013"),
					resultSet.getString("DESCES013"), resultSet.getString("DESCEU013"));
		}
	};

	/*
	 * OPERACIONES CRUD
	 */

	/**
	 * Inserts a single row in the Motivosrechazo table.
	 *
	 * @param motivosrechazo
	 *            Motivosrechazo
	 * @return Motivosrechazo
	 */
	@Override
	public Motivosrechazo add(Motivosrechazo motivosrechazo) {
		String query = "INSERT INTO AA79B13S01 (ID_013, ESTADO_013, DESC_ES_013, DESC_EU_013) VALUES (AA79B13Q00.NEXTVAL,?,?,?)";
		this.getJdbcTemplate().update(query, motivosrechazo.getEstado013(), motivosrechazo.getDescEs013(),
				motivosrechazo.getDescEu013());
		return motivosrechazo;
	}

	/**
	 * Updates a single row in the Motivosrechazo table.
	 *
	 * @param motivosrechazo
	 *            Motivosrechazo
	 * @return Motivosrechazo
	 */
	@Override
	public Motivosrechazo update(Motivosrechazo motivosrechazo) {
		String query = "UPDATE AA79B13S01 SET ESTADO_013=?, DESC_ES_013=?, DESC_EU_013=? WHERE ID_013=?";
		this.getJdbcTemplate().update(query, motivosrechazo.getEstado013(), motivosrechazo.getDescEs013(),
				motivosrechazo.getDescEu013(), motivosrechazo.getId013());
		return motivosrechazo;
	}

	/**
	 * Finds a single row in the Motivosrechazo table.
	 *
	 * @param motivosrechazo
	 *            Motivosrechazo
	 * @return Motivosrechazo
	 */
	@Override()
	protected String getSelect() {
		Locale es = new Locale("es");
		Locale eu = new Locale("eu");
		StringBuilder selectMotivosRechazo = new StringBuilder();

		selectMotivosRechazo.append("SELECT  t1.ID_013 ID013");
		selectMotivosRechazo.append(",  t1.DESC_EU_013 DESCEU013");
		selectMotivosRechazo.append(", t1.DESC_ES_013 DESCES013");
		selectMotivosRechazo.append(", t1.ESTADO_013 ESTADO013");
		selectMotivosRechazo.append(", DECODE(t1.ESTADO_013, 'A', '")
				.append(this.msg.getMessage("estado.alta", null, es)).append("', 'B', '")
				.append(this.msg.getMessage("estado.baja", null, es)).append("') AS ESTADODESCES");
		selectMotivosRechazo.append(", DECODE(t1.ESTADO_013, 'A', '")
				.append(this.msg.getMessage("estado.alta", null, eu)).append("', 'B', '")
				.append(this.msg.getMessage("estado.baja", null, eu)).append("') AS ESTADODESCEU");
		selectMotivosRechazo.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_EU_013"))
				.append(" AS DESCNORMEU");
		selectMotivosRechazo.append(", ").append(SqlUtils.normalizarCampoSql("t1.DESC_ES_013"))
				.append(" AS DESCNORMES");

		return selectMotivosRechazo.toString();
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B13S01 t1";
	}

	@Override()
	protected RowMapper<Motivosrechazo> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return MotivosrechazoDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_013";
	}

	@Override()
	protected RowMapper<Motivosrechazo> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(Motivosrechazo bean, List<Object> params) {
		params.add(bean.getId013());
		return " WHERE t1.ID_013 = ?";
	}

	@Override
	protected String getWhere(Motivosrechazo bean, List<Object> params) {
		StringBuilder where = new StringBuilder(MotivosrechazoDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual("t1.ID_013", bean.getId013(), params));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_013", bean.getDescEu013(), params, false));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_ES_013", bean.getDescEs013(), params, false));

		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_013", bean.getEstado013(), params));
		Map<String, Object> mapWhere = new HashMap<String, Object>();
		mapWhere.put("query", where);
		mapWhere.put("params", params);
		return where.toString();

	}

	@Override
	protected String getWhereLike(Motivosrechazo bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(MotivosrechazoDaoImpl.STRING_BUILDER_INIT);

		where.append(SqlUtils.generarWhereIgual("t1.ID_013", bean.getId013(), params));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_EU_013", bean.getDescEu013(), params, startsWith));

		where.append(SqlUtils.generarWhereLikeNormalizado("t1.DESC_ES_013", bean.getDescEs013(), params, startsWith));

		where.append(SqlUtils.generarWhereIgual("t1.ESTADO_013", bean.getEstado013(), params));
		Map<String, Object> mapWhere = new HashMap<String, Object>();
		mapWhere.put("query", where);
		mapWhere.put("params", params);

		return where.toString();
	}
}
