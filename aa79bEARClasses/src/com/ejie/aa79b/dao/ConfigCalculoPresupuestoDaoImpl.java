package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ConfigCalculoPresupuesto;

/**
 * ConfigCalculoPresupuestoDaoImpl generated by UDA, 05-dic-2017 15:17:18.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class ConfigCalculoPresupuestoDaoImpl extends GenericoDaoImpl<ConfigCalculoPresupuesto>
		implements ConfigCalculoPresupuestoDao {

	public ConfigCalculoPresupuestoDaoImpl() {
		super(ConfigCalculoPresupuesto.class);
	}

	public static final String[] ORDER_BY_WHITE_LIST = new String[] { "ID003", "PALPRESUPUESTO003", "PALTRADOS003",
			"PORDESVIACIONPAL003" };

	/*
	 * ROW_MAPPERS
	 */
	private RowMapper<ConfigCalculoPresupuesto> rwMap = new RowMapper<ConfigCalculoPresupuesto>() {
		@Override
		public ConfigCalculoPresupuesto mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ConfigCalculoPresupuesto(resultSet.getInt("ID003"), resultSet.getInt("PALPRESUPUESTO003"),
					resultSet.getInt("PALTRADOS003"), resultSet.getLong("PORDESVIACIONPAL003"));
		}
	};

	private RowMapper<ConfigCalculoPresupuesto> rwMapPK = new RowMapper<ConfigCalculoPresupuesto>() {
		@Override
		public ConfigCalculoPresupuesto mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ConfigCalculoPresupuesto(resultSet.getInt("ID003"));
		}
	};

	@Override()
	public ConfigCalculoPresupuesto add(ConfigCalculoPresupuesto configcalculopresupuesto) {
		String query = "INSERT INTO AA79B03S01 (ID_003, PAL_PRESUPUESTO_003, PAL_TRADOS_003, POR_DESVIACION_PAL_003) VALUES (?,?,?)";
		this.getJdbcTemplate().update(query, configcalculopresupuesto.getId(),
				configcalculopresupuesto.getPalPresupuesto(), configcalculopresupuesto.getPalTrados(),
				configcalculopresupuesto.getPorDesviacionPal());
		return configcalculopresupuesto;
	}

	@Override()
	public ConfigCalculoPresupuesto update(ConfigCalculoPresupuesto configcalculopresupuesto) {
		String query = "UPDATE AA79B03S01 SET PAL_PRESUPUESTO_003=?, PAL_TRADOS_003=?, POR_DESVIACION_PAL_003=? WHERE ID_003=?";
		this.getJdbcTemplate().update(query, configcalculopresupuesto.getPalPresupuesto(),
				configcalculopresupuesto.getPalTrados(), configcalculopresupuesto.getPorDesviacionPal(),
				configcalculopresupuesto.getId());
		return configcalculopresupuesto;
	}

	@Override()
	public void remove(ConfigCalculoPresupuesto configcalculopresupuesto) {
		String query = "DELETE FROM AA79B03S01 WHERE ID_003=?";
		this.getJdbcTemplate().update(query, configcalculopresupuesto.getId());
	}

	@Override()
	protected String getSelect() {
		return "SELECT t1.ID_003 ID003, t1.PAL_PRESUPUESTO_003 PALPRESUPUESTO003, t1.PAL_TRADOS_003 PALTRADOS003, t1.POR_DESVIACION_PAL_003 PORDESVIACIONPAL003";
	}

	@Override()
	protected String getFrom() {
		return " FROM AA79B03S01 t1";
	}

	@Override()
	protected RowMapper<ConfigCalculoPresupuesto> getRwMap() {
		return this.rwMap;
	}

	@Override()
	protected String[] getOrderBy() {
		return ORDER_BY_WHITE_LIST;
	}

	@Override()
	protected String getPK() {
		return "ID_003";
	}

	@Override()
	protected RowMapper<ConfigCalculoPresupuesto> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override()
	protected String getWherePK(ConfigCalculoPresupuesto bean, List<Object> params) {
		params.add(bean.getId());
		return " WHERE t1.ID_003 = ?";
	}

	@Override()
	protected String getWhere(ConfigCalculoPresupuesto bean, List<Object> params) {
		StringBuilder where = new StringBuilder(ConfigCalculoPresupuestoDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_003", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("PAL_PRESUPUESTO_003", bean.getPalPresupuesto(), params));
		where.append(SqlUtils.generarWhereIgual("PAL_TRADOS_003", bean.getPalTrados(), params));
		where.append(SqlUtils.generarWhereIgual("POR_DESVIACION_PAL_003", bean.getPorDesviacionPal(), params));
		return where.toString();
	}

	@Override()
	protected String getWhereLike(ConfigCalculoPresupuesto bean, Boolean startsWith, List<Object> params,
			Boolean search) {
		StringBuilder where = new StringBuilder(ConfigCalculoPresupuestoDaoImpl.STRING_BUILDER_INIT);
		where.append(SqlUtils.generarWhereIgual("ID_003", bean.getId(), params));
		where.append(SqlUtils.generarWhereIgual("PAL_PRESUPUESTO_003", bean.getPalPresupuesto(), params));
		where.append(SqlUtils.generarWhereIgual("PAL_TRADOS_003", bean.getPalTrados(), params));
		where.append(SqlUtils.generarWhereIgual("POR_DESVIACION_PAL_003", bean.getPorDesviacionPal(), params));
		return where.toString();
	}
}
