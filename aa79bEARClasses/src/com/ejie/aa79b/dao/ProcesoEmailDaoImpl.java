package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.model.ProcesoEmail;

/**
 * DocumentoTareaDaoImpl generated by UDA, 14-Jul-18 15:23:30.
 * 
 * @author UDA
 */

@Repository
@Transactional
public class ProcesoEmailDaoImpl extends GenericoDaoImpl<ProcesoEmail> implements ProcesoEmailDao {

	public ProcesoEmailDaoImpl() {
		// Constructor
		super(ProcesoEmail.class);
	}

	private RowMapper<ProcesoEmail> rwMap = new RowMapper<ProcesoEmail>() {
		@Override()
		public ProcesoEmail mapRow(ResultSet resultSet, int rowNum) throws SQLException {

			ProcesoEmail bean = new ProcesoEmail();

			bean.setIdProceso(resultSet.getInt("ID_PROCESO"));
			bean.setNumEmail(resultSet.getInt("NUM_EMAIL"));
			bean.setIdTipoAviso(resultSet.getInt("TIPO_AVISO"));
			bean.setAnyo(resultSet.getLong("ANYO"));
			bean.setNumExp(resultSet.getInt("NUM_EXP"));
			bean.setTituloExp(resultSet.getString("TITULO_EXP"));
			bean.setIdTarea(resultSet.getLong("ID_TAREA"));
			bean.setIdTipoTarea(resultSet.getLong("TIPO_TAREA"));
			bean.setDescTipoTareaEs(resultSet.getString("TAREA_DESC_ES"));
			bean.setDescTipoTareaEu(resultSet.getString("TAREA_DESC_EU"));
			bean.setDniDestinatario(resultSet.getString("DNI_DESTINATARIO"));
			bean.setEmailDestinatario(resultSet.getString("EMAIL_DESTINATARIO"));

			return bean;
		}
	};

	@Override
	protected String getSelect() {
		StringBuilder query = new StringBuilder("SELECT ");

		query.append("ID_PROCESO_EMAIL_0B2 ID_PROCESO, ");
		query.append("NUM_EMAIL_0B2 NUM_EMAIL, ");
		query.append("ID_TIPO_AVISO_0B2 TIPO_AVISO, ");
		query.append("ANYO_0B2 ANYO, ");
		query.append("NUM_EXP_0B2 NUM_EXP, ");
		query.append("TITULO_EXP_0B2 TITULO_EXP, ");
		query.append("ID_TAREA_0B2 ID_TAREA, ");
		query.append("ID_TIPO_TAREA_0B2 TIPO_TAREA, ");
		query.append("DESC_TAREA_ES_0B2 TAREA_DESC_ES, ");
		query.append("DESC_TAREA_EU_0B2 TAREA_DESC_EU, ");
		query.append("DNI_DESTINATARIO_0B2 DNI_DESTINATARIO, ");
		query.append("EMAIL_DESTINATARIO_0B2 EMAIL_DESTINATARIO ");

		return query.toString();
	}

	@Override
	protected String getFrom() {

		StringBuilder from = new StringBuilder("FROM ");
		from.append("AA79BB2T00 ");

		return from.toString();
	}

	@Override
	protected RowMapper<ProcesoEmail> getRwMap() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	protected String[] getOrderBy() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	protected String getPK() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	protected RowMapper<ProcesoEmail> getRwMapPK() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	protected String getWherePK(ProcesoEmail bean, List<Object> params) {
		params.add(bean.getIdProceso());
		StringBuilder wherePK = new StringBuilder("WHERE ");
		wherePK.append("ID_PROCESO_EMAIL_0B2 = ? ");
		return wherePK.toString();
	}

	@Override
	protected String getWhere(ProcesoEmail bean, List<Object> params) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	protected String getWhereLike(ProcesoEmail bean, Boolean startsWith, List<Object> params, Boolean search) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override()
	public List<ProcesoEmail> findProcesoEmail(ProcesoEmail bean) {

		List<Object> params = new ArrayList<Object>();
		StringBuilder query = new StringBuilder(this.getSelect());
		query.append(this.getFrom());
		query.append(this.getWherePK(bean, params));
		query.append("ORDER BY ");
		query.append("ANYO, NUM_EXP, TIPO_AVISO, DNI_DESTINATARIO ");
		return this.getJdbcTemplate().query(query.toString(), this.rwMap, params.toArray());
	}

}
