package com.ejie.aa79b.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.ejie.aa79b.common.DBConstants;
import com.ejie.aa79b.common.DaoConstants;
import com.ejie.aa79b.common.SqlUtils;
import com.ejie.aa79b.model.ObservacionesAnulExp;

/**
 * ObservacionesAnulExpDaoImpl generated by UDA, 02-oct-2018 13:36:57.
 * 
 * @author UDA
 */

@Repository()
@Transactional()
public class ObservacionesAnulExpDaoImpl extends GenericoDaoImpl<ObservacionesAnulExp>
		implements ObservacionesAnulExpDao {

	public static final String[] ORDER_BY_WHITE_LIST = new String[] { DBConstants.ID, DBConstants.OBSVANULACION };

	private RowMapper<ObservacionesAnulExp> rwMap = new RowMapper<ObservacionesAnulExp>() {
		public ObservacionesAnulExp mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ObservacionesAnulExp(resultSet.getLong(DBConstants.ID),
					resultSet.getString(DBConstants.OBSVANULACION));
		}
	};

	private RowMapper<ObservacionesAnulExp> rwMapPK = new RowMapper<ObservacionesAnulExp>() {
		public ObservacionesAnulExp mapRow(ResultSet resultSet, int rowNum) throws SQLException {
			return new ObservacionesAnulExp(resultSet.getLong(DBConstants.ID));
		}
	};

	public ObservacionesAnulExpDaoImpl() {
		super(ObservacionesAnulExp.class);
	}

	/**
	 * Inserts a single row in the ObservacionesAnulExp table.
	 *
	 * @param observacionesanulexp
	 *            ObservacionesAnulExp
	 * @return ObservacionesAnulExp
	 */
	public ObservacionesAnulExp add(ObservacionesAnulExp observacionesanulexp) {
		String query = "INSERT INTO AA79BA2S01 (ID_0A2, OBSV_ANULACION_0A2) VALUES (?,?)";
		this.getJdbcTemplate().update(query, observacionesanulexp.getId(), observacionesanulexp.getObsvAnulacion());
		return observacionesanulexp;
	}

	/**
	 * Updates a single row in the ObservacionesAnulExp table.
	 *
	 * @param observacionesanulexp
	 *            ObservacionesAnulExp
	 * @return ObservacionesAnulExp
	 */
	public ObservacionesAnulExp update(ObservacionesAnulExp observacionesanulexp) {
		String query = "UPDATE AA79BA2S01 SET OBSV_ANULACION_0A2=? WHERE ID_0A2=?";
		this.getJdbcTemplate().update(query, observacionesanulexp.getObsvAnulacion(), observacionesanulexp.getId());
		return observacionesanulexp;
	}

	/**
	 * Removes a single row in the ObservacionesAnulExp table.
	 *
	 * @param observacionesanulexp
	 *            ObservacionesAnulExp
	 * @return
	 */
	public void remove(ObservacionesAnulExp observacionesanulexp) {
		String query = "DELETE FROM AA79BA2S01 WHERE ID_0A2=?";
		this.getJdbcTemplate().update(query, observacionesanulexp.getId());
	}

	@Override
	protected String getSelect() {
		StringBuilder query = new StringBuilder();
		query.append(DaoConstants.SELECT);
		query.append(DaoConstants.T1_MINUSCULA);
		query.append(DaoConstants.SIGNO_PUNTO);
		query.append(DBConstants.ID_0A2);
		query.append(DaoConstants.BLANK);
		query.append(DBConstants.ID);
		query.append(DaoConstants.BLANK);
		query.append(DaoConstants.SIGNO_COMA);
		query.append(DaoConstants.T1_MINUSCULA);
		query.append(DaoConstants.SIGNO_PUNTO);
		query.append(DBConstants.OBSV_ANULACION_0A2);
		query.append(DaoConstants.BLANK);
		query.append(DBConstants.OBSVANULACION);
		query.append(DaoConstants.BLANK);

		return query.toString();
	}

	@Override
	protected String getFrom() {
		StringBuilder from = new StringBuilder();
		from.append(DaoConstants.FROM);
		from.append(DBConstants.AA79BA2S01);
		from.append(DaoConstants.BLANK);
		from.append(DaoConstants.T1_MINUSCULA);
		from.append(DaoConstants.BLANK);

		return from.toString();
	}

	@Override
	protected RowMapper<ObservacionesAnulExp> getRwMap() {
		return this.rwMap;
	}

	@Override
	protected String[] getOrderBy() {
		return ObservacionesAnulExpDaoImpl.ORDER_BY_WHITE_LIST;
	}

	@Override
	protected String getPK() {
		return DBConstants.ID_0A2;
	}

	@Override
	protected RowMapper<ObservacionesAnulExp> getRwMapPK() {
		return this.rwMapPK;
	}

	@Override
	protected String getWherePK(ObservacionesAnulExp bean, List<Object> params) {
		params.add(bean.getId());
		StringBuilder where = new StringBuilder();
		where.append(DaoConstants.WHERE);
		where.append(DaoConstants.T1_MINUSCULA);
		where.append(DaoConstants.SIGNO_PUNTO);
		where.append(DBConstants.ID_0A2);
		where.append(DaoConstants.SIGNOIGUAL_INTERROGACION);

		return where.toString();
	}

	@Override
	protected String getWhere(ObservacionesAnulExp bean, List<Object> params) {
		StringBuilder where = new StringBuilder(ObservacionesAnulExpDaoImpl.STRING_BUILDER_INIT);

		if (bean != null) {
			where.append(SqlUtils.generarWhereIgual(DBConstants.ID_0A2, bean.getId(), params));
			where.append(SqlUtils.generarWhereIgual(DBConstants.OBSV_ANULACION_0A2, bean.getObsvAnulacion(), params));
		}

		return where.toString();
	}

	@Override
	protected String getWhereLike(ObservacionesAnulExp bean, Boolean startsWith, List<Object> params, Boolean search) {
		StringBuilder where = new StringBuilder(ObservacionesAnulExpDaoImpl.STRING_BUILDER_INIT);

		if (bean != null) {
			where.append(SqlUtils.generarWhereIgual(DBConstants.ID_0A2, bean.getId(), params));
			where.append(SqlUtils.generarWhereIgual(DBConstants.OBSV_ANULACION_0A2, bean.getObsvAnulacion(), params));
		}

		return where.toString();
	}

}
