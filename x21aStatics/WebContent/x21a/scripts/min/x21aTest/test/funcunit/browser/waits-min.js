(function(a){FuncUnit.wait=function(b,c){if(typeof b=="function"){c=b;b=undefined}b=b!=null?b:5000;FuncUnit.add({method:function(e,d){steal.dev.log("Waiting "+b);setTimeout(e,b)},success:c,error:"Couldn't wait!",timeout:b+1000});return this};FuncUnit.branch=function(d,e,b,c,f){FuncUnit.repeat({method:function(g){g("Running a branch statement");if(d()){e();return true}if(b()){c();return true}},error:"no branch condition was ever true",timeout:f,type:"branch"})};FuncUnit.repeat=function(c){var b,e=false,d=function(){clearTimeout(b);e=true};FuncUnit.add({method:function(i,g){c.bind=this.bind;c.selector=this.selector;var h=false,f=function(j){if(!h){steal.dev.log(j);h=true}};b=setTimeout(function(){var j=null;try{j=c.method(f)}catch(k){}if(j){i(c.bind)}else{if(!e){b=setTimeout(arguments.callee,10)}}},10)},success:c.success,error:c.error,timeout:c.timeout,stop:d,bind:c.bind,type:c.type})};a.extend(FuncUnit.prototype,{exists:function(c,d,b){var e="Waiting for '"+this.selector+"' to exist";if(c===false){e=false}return this.size({condition:function(f){return f>0},timeout:c,success:d,message:b,errorMessage:"Exist failed: element with selector '"+this.selector+"' not found",logMessage:e})},missing:function(c,d,b){return this.size(0,c,d,b)},visible:function(f,g,d){var b=this,e=this.selector,c;return this.size(function(h){return this.is(":visible")===true},f,g,d)},invisible:function(f,g,d){var b=this,e=this.selector,c;return this.size(function(h){return this.is(":visible")===false},f,g,d)},wait:function(b,d,e,c){if(typeof b==="number"){d=b;FuncUnit.wait(d,e);return this}else{return this.size(b,d,e,c)}},then:function(c){var b=this;FuncUnit.wait(0,function(){c.call(this,this)});return this}})})(window.jQuery||window.FuncUnit.jQuery);