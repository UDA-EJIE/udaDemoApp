(function(){var c=Syn.helpers,b=Syn,a=function(i){if(i.selectionStart!==undefined){if(document.activeElement&&document.activeElement!=i&&i.selectionStart==i.selectionEnd&&i.selectionStart==0){return{start:i.value.length,end:i.value.length}}return{start:i.selectionStart,end:i.selectionEnd}}else{try{if(i.nodeName.toLowerCase()=="input"){var m=c.getWindow(i).document.selection.createRange(),j=i.createTextRange();j.setEndPoint("EndToStart",m);var l=j.text.length;return{start:l,end:l+m.text.length}}else{var m=c.getWindow(i).document.selection.createRange(),j=m.duplicate(),h=m.duplicate(),f=m.duplicate();h.collapse();f.collapse(false);h.moveStart("character",-1);f.moveStart("character",-1);j.moveToElementText(i);j.setEndPoint("EndToEnd",m);var l=j.text.length-m.text.length,g=j.text.length;if(l!=0&&h.text==""){l+=2}if(g!=0&&f.text==""){g+=2}return{start:l,end:g}}}catch(k){return{start:i.value.length,end:i.value.length}}}},d=function(l){var g=c.getWindow(l).document,k=[];var j=g.getElementsByTagName("*"),f=j.length;for(var h=0;h<f;h++){Syn.isFocusable(j[h])&&j[h]!=g.documentElement&&k.push(j[h])}return k};c.extend(Syn,{keycodes:{"\b":8,"\t":9,"\r":13,shift:16,ctrl:17,alt:18,"pause-break":19,caps:20,escape:27,"num-lock":144,"scroll-lock":145,print:44,"page-up":33,"page-down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46," ":32,"0":48,"1":49,"2":50,"3":51,"4":52,"5":53,"6":54,"7":55,"8":56,"9":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,".":110,"/":111,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,"left window key":91,"right window key":92,"select key":93,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},typeable:/input|textarea/i,selectText:function(g,i,f){if(g.setSelectionRange){if(!f){g.focus();g.setSelectionRange(i,i)}else{g.selectionStart=i;g.selectionEnd=f}}else{if(g.createTextRange){var h=g.createTextRange();h.moveStart("character",i);f=f||i;h.moveEnd("character",f-g.value.length);h.select()}}},getText:function(f){if(Syn.typeable.test(f.nodeName)){var g=a(f);return f.value.substring(g.start,g.end)}var h=Syn.helpers.getWindow(f);if(h.getSelection){return h.getSelection().toString()}else{if(h.document.getSelection){return h.document.getSelection().toString()}else{return h.document.selection.createRange().text}}},getSelection:a});c.extend(Syn.key,{data:function(f){if(b.key.browser[f]){return b.key.browser[f]}for(var g in b.key.kinds){if(c.inArray(f,b.key.kinds[g])>-1){return b.key.browser[g]}}return b.key.browser.character},isSpecial:function(h){var f=b.key.kinds.special;for(var g=0;g<f.length;g++){if(Syn.keycodes[f[g]]==h){return f[g]}}},options:function(h,i){var k=Syn.key.data(h);if(!k[i]){return null}var g=k[i][0],j=k[i][1],f={};if(j=="key"){f.keyCode=Syn.keycodes[h]}else{if(j=="char"){f.keyCode=h.charCodeAt(0)}else{f.keyCode=j}}if(g=="char"){f.charCode=h.charCodeAt(0)}else{if(g!==null){f.charCode=g}}if(f.keyCode){f.which=f.keyCode}else{f.which=f.charCode}return f},kinds:{special:["shift","ctrl","alt","caps"],specialChars:["\b"],navigation:["page-up","page-down","end","home","left","up","right","down","insert","delete"],"function":["f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12"]},getDefault:function(f){if(Syn.key.defaults[f]){return Syn.key.defaults[f]}for(var g in Syn.key.kinds){if(c.inArray(f,Syn.key.kinds[g])>-1&&Syn.key.defaults[g]){return Syn.key.defaults[g]}}return Syn.key.defaults.character},defaults:{character:function(o,n,m,g,h){if(/num\d+/.test(m)){m=m.match(/\d+/)[0]}if(g||(!b.support.keyCharacters&&Syn.typeable.test(this.nodeName))){var k=this.value,l=k.substr(0,h.start),f=k.substr(h.end),j=m;this.value=l+j+f;var i=j=="\n"&&b.support.textareaCarriage?2:j.length;Syn.selectText(this,l.length+i)}},c:function(f,h,g,j,i){if(Syn.key.ctrlKey){Syn.key.clipboard=Syn.getText(this)}else{Syn.key.defaults.character.apply(this,arguments)}},v:function(f,h,g,j,i){if(Syn.key.ctrlKey){Syn.key.defaults.character.call(this,f,h,Syn.key.clipboard,true,i)}else{Syn.key.defaults.character.apply(this,arguments)}},a:function(f,h,g,j,i){if(Syn.key.ctrlKey){Syn.selectText(this,0,this.value.length)}else{Syn.key.defaults.character.apply(this,arguments)}},home:function(){Syn.onParents(this,function(f){if(f.scrollHeight!=f.clientHeight){f.scrollTop=0;return false}})},end:function(){Syn.onParents(this,function(f){if(f.scrollHeight!=f.clientHeight){f.scrollTop=f.scrollHeight;return false}})},"page-down":function(){Syn.onParents(this,function(g){if(g.scrollHeight!=g.clientHeight){var f=g.clientHeight;g.scrollTop+=f;return false}})},"page-up":function(){Syn.onParents(this,function(g){if(g.scrollHeight!=g.clientHeight){var f=g.clientHeight;g.scrollTop-=f;return false}})},"\b":function(f,h,g,k,j){if(!b.support.backspaceWorks&&Syn.typeable.test(this.nodeName)){var l=this.value,i=l.substr(0,j.start),m=l.substr(j.end);if(j.start==j.end&&j.start>0){this.value=i.substring(0,i.length-1)+m;Syn.selectText(this,j.start-1)}else{this.value=i+m;Syn.selectText(this,j.start)}}},"delete":function(f,h,g,k,j){if(!b.support.backspaceWorks&&Syn.typeable.test(this.nodeName)){var l=this.value,i=l.substr(0,j.start),m=l.substr(j.end);if(j.start==j.end&&j.start<=this.value.length-1){this.value=i+m.substring(1)}else{this.value=i+m}Syn.selectText(this,j.start)}},"\r":function(f,h,g,k,j){var l=this.nodeName.toLowerCase();if(!b.support.keypressSubmits&&l=="input"){var i=Syn.closest(this,"form");if(i){Syn.trigger("submit",{},i)}}if(!b.support.keyCharacters&&l=="textarea"){Syn.key.defaults.character.call(this,f,h,"\n",undefined,j)}if(!b.support.keypressOnAnchorClicks&&l=="a"){Syn.trigger("click",{},this)}},"\t":function(s,q){var p=d(this),g=Syn.tabIndex(this),n=null,o=1000000000,r=false,m=0,f,k,h,j;orders=[];for(;m<p.length;m++){orders.push([p[m],m])}var l=function(x,w){var v=x[0],t=w[0],u=Syn.tabIndex(v)||0,i=Syn.tabIndex(t)||0;if(u==i){return x[1]-w[1]}else{if(u==0){return 1}else{if(i==0){return -1}else{return u-i}}}};orders.sort(l);for(m=0;m<orders.length;m++){f=orders[m][0];if(this==f){if(!Syn.key.shiftKey){n=orders[m+1][0];if(!n){n=orders[0][0]}}else{n=orders[m-1][0];if(!n){n=orders[p.length-1][0]}}}}if(!n){n=h}n&&n.focus();return n},left:function(f,h,g,j,i){if(Syn.typeable.test(this.nodeName)){if(Syn.key.shiftKey){Syn.selectText(this,i.start==0?0:i.start-1,i.end)}else{Syn.selectText(this,i.start==0?0:i.start-1)}}},right:function(f,h,g,j,i){if(Syn.typeable.test(this.nodeName)){if(Syn.key.shiftKey){Syn.selectText(this,i.start,i.end+1>this.value.length?this.value.length:i.end+1)}else{Syn.selectText(this,i.end+1>this.value.length?this.value.length:i.end+1)}}},up:function(){if(/select/i.test(this.nodeName)){this.selectedIndex=this.selectedIndex?this.selectedIndex-1:0}},down:function(){if(/select/i.test(this.nodeName)){Syn.changeOnBlur(this,"selectedIndex",this.selectedIndex);this.selectedIndex=this.selectedIndex+1}},shift:function(){return null}}});c.extend(Syn.create,{keydown:{setup:function(h,f,g){if(c.inArray(f,Syn.key.kinds.special)!=-1){Syn.key[f+"Key"]=g}}},keypress:{setup:function(h,f,g){if(b.support.keyCharacters&&!b.support.keysOnNotFocused){g.focus()}}},keyup:{setup:function(h,f,g){if(c.inArray(f,Syn.key.kinds.special)!=-1){Syn.key[f+"Key"]=null}}},key:{options:function(h,f,g){f=typeof f!="object"?{character:f}:f;f=c.extend({},f);if(f.character){c.extend(f,b.key.options(f.character,h));delete f.character}f=c.extend({ctrlKey:!!Syn.key.ctrlKey,altKey:!!Syn.key.altKey,shiftKey:!!Syn.key.shiftKey,metaKey:!!Syn.key.metaKey},f);return f},event:function(h,f,g){var k=c.getWindow(g).document||document;if(k.createEvent){var i;try{i=k.createEvent("KeyEvents");i.initKeyEvent(h,true,true,window,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.keyCode,f.charCode)}catch(j){i=c.createBasicStandardEvent(h,f,k)}i.synthetic=true;return i}else{var i;try{i=c.createEventObject.apply(this,arguments);c.extend(i,f)}catch(j){}return i}}}});var e={enter:"\r",backspace:"\b",tab:"\t",space:" "};c.extend(Syn.init.prototype,{_key:function(p,i,o){if(/-up$/.test(p)&&c.inArray(p.replace("-up",""),Syn.key.kinds.special)!=-1){Syn.trigger("keyup",p.replace("-up",""),i);o(true,i);return}var h=c.getWindow(i).document.activeElement,j=Syn.typeable.test(i.nodeName)&&a(i),n=e[p]||p,m=Syn.trigger("keydown",n,i),l=Syn.key.getDefault,k=Syn.key.browser.prevent,g,f=Syn.key.options(n,"keypress");if(m){if(!f){g=l(n).call(i,f,c.getWindow(i),n,undefined,j)}else{if(h!==c.getWindow(i).document.activeElement){i=c.getWindow(i).document.activeElement}m=Syn.trigger("keypress",f,i);if(m){g=l(n).call(i,f,c.getWindow(i),n,undefined,j)}}}else{if(f&&c.inArray("keypress",k.keydown)==-1){if(h!==c.getWindow(i).document.activeElement){i=c.getWindow(i).document.activeElement}Syn.trigger("keypress",f,i)}}if(g&&g.nodeName){i=g}if(g!==null){setTimeout(function(){Syn.trigger("keyup",Syn.key.options(n,"keyup"),i);o(m,i)},1)}else{o(m,i)}return i},_type:function(h,i,k){var j=h.match(/(\[[^\]]+\])|([^\[])/g),f=this,g=function(l,n){var m=j.shift();if(!m){k(l,n);return}n=n||i;if(m.length>1){m=m.substr(1,m.length-2)}f._key(m,n,g)};g()}});(function(){if(!document.body){setTimeout(arguments.callee,1);return}var f=document.createElement("div"),i,j,g,k,l=false,h,m,n;f.innerHTML="<form id='outer'><input name='checkbox' type='checkbox'/><input name='radio' type='radio' /><input type='submit' name='submitter'/><input type='input' name='inputter'/><input name='one'><input name='two'/><a href='#abc'></a><textarea>1\n2</textarea></form>";document.documentElement.appendChild(f);g=f.firstChild;i=g.childNodes[0];j=g.childNodes[2];h=g.getElementsByTagName("a")[0];m=g.getElementsByTagName("textarea")[0];n=g.childNodes[3];g.onsubmit=function(o){if(o.preventDefault){o.preventDefault()}b.support.keypressSubmits=true;o.returnValue=false;return false};n.focus();Syn.trigger("keypress","\r",n);Syn.trigger("keypress","a",n);b.support.keyCharacters=n.value=="a";n.value="a";Syn.trigger("keypress","\b",n);b.support.backspaceWorks=n.value=="";n.onchange=function(){b.support.focusChanges=true};n.focus();Syn.trigger("keypress","a",n);g.childNodes[5].focus();Syn.trigger("keypress","b",n);b.support.keysOnNotFocused=n.value=="ab";b.bind(h,"click",function(o){if(o.preventDefault){o.preventDefault()}b.support.keypressOnAnchorClicks=true;o.returnValue=false;return false});Syn.trigger("keypress","\r",h);b.support.textareaCarriage=m.value.length==4;document.documentElement.removeChild(f);b.support.ready++})()})();