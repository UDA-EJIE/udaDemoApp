jQuery(function(a){a("#GRID_alumno").rup_table({hasMaint:true,url:"../administracion/alumno",colNames:[a.rup.i18n.app.GRID_alumno.id,a.rup.i18n.app.GRID_alumno.usuario,a.rup.i18n.app.GRID_alumno.nombre,a.rup.i18n.app.GRID_alumno.dni,a.rup.i18n.app.GRID_alumno.importeMatricula,"provincia","prueba"],colModel:[{name:"id",label:"id",index:"id",width:"150",editable:false,hidden:true,edittype:"text"},{name:"usuario",label:"usuario",index:"usuario",width:"150",editable:true,edittype:"text"},{name:"nombreCompleto",label:"nombreCompleto",index:"nombreCompleto",width:"150",editable:true,edittype:"text",formatter:function(e,d,b,c){return b.apellido1+" "+b.apellido2+", "+b.nombre},formatterOnUpdate:function(b){return a("#apellido1").val()+" "+a("#apellido2").val()+", "+a("#nombre").val()}},{name:"dni",label:"dni",index:"dni",width:"150",editable:true,edittype:"text"},{name:"importeMatricula",label:"importeMatricula",index:"importeMatricula",width:"150",editable:true,edittype:"text",formatoptions:{decimalSeparator:",",thousandsSeparator:",",decimalPlaces:2,prefix:"€ "}},{name:"municipio.dsO",label:"municipio.dsO",index:"municipio.dsO",width:"150",editable:true,edittype:"text",updateFromDetail:function(b){return a("#municipio").rup_combo("label")},formatoptions:{decimalSeparator:",",thousandsSeparator:",",decimalPlaces:2,prefix:"€ "}},{name:"campo.valor",label:"campo.valor",index:"campo.valor"}],editOptions:{width:1000},detailForm:"#detalleAlumno",fluidBaseLayer:"#alumno",rowNum:10,rowList:[10,20,30],pager:"#pager",searchForm:"#searchForm",sortname:"id",sortable:true,resizable:true,toolbar:{id:"toolbar"}}).on("jqGridAddEditBeforeShowForm jqGridAddEditAfterFillData",function(d,c,e){if(e==="edit"){var b=a("#nombreImagen").val();a("#divOldPassword",c).show();if(a("#pais",c).rup_combo("getRupValue")==="108"){a("#divDireccionExtranjera",c).hide();a("#divDireccionPais, #divAutonomia",c).show()}else{a("#divDireccionExtranjera",c).show();a("#divDireccionPais, #divAutonomia",c).hide()}if(b!==undefined&&b!==null&&b!==""){a("#imagen",c).attr("src","http://desarrollo.jakina.ejiedes.net:7001/x21aMantenimientosWar/administracion/alumno/imagen/"+a("#id",c).val()+"?"+new Date())}else{a("#imagen",c).attr("src",a.rup.STATICS+"/x21a/images/no_picture.gif")}}else{a("#divDireccionPais",c).show();a("#divDireccionExtranjera, #divOldPassword",c).hide();a("#pais",c).rup_combo("select","108");a("#imagen",c).attr("src",a.rup.STATICS+"/x21a/images/no_picture.gif")}});a("#sexo").rup_combo({source:[{i18nCaption:"masculino",value:"M"},{i18nCaption:"femenino",value:"F"}],i18nId:"sexo"});jQuery("#pais").rup_combo({source:a.rup.CTX_PATH+"nora/pais",sourceParam:{label:"dsO",value:"id"},blank:"",width:400,loadFromSelect:true,change:function(c,b){if(b.value==="108"){a("#divDireccionExtranjera").hide();a("#divDireccionPais").show();a("#divAutonomia").show()}else{a("#divDireccionExtranjera").show();a("#divDireccionPais").hide();a("#divAutonomia").hide()}}});jQuery("#autonomia").rup_combo({source:a.rup.CTX_PATH+"nora/autonomia",sourceParam:{label:"dsO",value:"id"},width:400,blank:"",loadFromSelect:true});jQuery("#provincia").rup_combo({parent:["autonomia"],source:a.rup.CTX_PATH+"nora/provincia",firstLoad:[{value:"01",label:"Alava/Araba"},{value:"20",label:"Gipuzkoa"},{value:"48",label:"Bizkaia"}],sourceParam:{label:"dsO",value:"id"},width:400,blank:""});jQuery("#municipio").rup_combo({source:a.rup.CTX_PATH+"nora/municipio",sourceParam:{label:"dsO",value:"id"},parent:["provincia"],width:400,blank:""});jQuery("#calle").rup_autocomplete({source:a.rup.CTX_PATH+"nora/calle",sourceParam:{label:"dsO",value:"id"},minLength:4});a("#fechaNacimiento").rup_date();a("#botonCapa").bind("click",function(){a("#capa1").rup_dialog({type:a.rup.dialog.DIV})});a("#botonCapa1").bind("click",function(){a("#capa2").rup_dialog({type:a.rup.dialog.DIV})});a("#botonCapa2").bind("click",function(){a("#capa3").rup_dialog({type:a.rup.dialog.DIV})});a("#botonCapa3").bind("click",function(){a("#capa4").rup_dialog({type:a.rup.dialog.DIV})});a("#contentLayer").css("opacity","100")});