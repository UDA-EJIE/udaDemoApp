/*! For license information please see rup.select.js.LICENSE.txt */
function chargedStyles(e){void 0===e.style&&void 0!==e.element&&(e.style=e.element.getAttribute("style"),e.imgStyle=e.element.getAttribute("imgStyle"),null!=e.style&&"undefined"!=e.style||(e.style=void 0),null!=e.style&&"undefined"!=e.imgStyle||(e.imgStyle=void 0))}function udaMatcher(e,t){if(""===$.trim(e.term))return t;if(t.children&&t.children.length>0){for(var l=$.extend(!0,{},t),a=t.children.length-1;a>=0;a--){var n=t.children[a];null==matcher(e,n)&&l.children.splice(a,1)}return l.children.length>0?l:matcher(e,l)}var s=t.text.toUpperCase(),i=e.term.toUpperCase();return s.indexOf(i)>-1?t:null}!function(e){"function"==typeof define&&define.amd?define(["jquery","./rup.base","./rup.message","select2","select2/dist/js/i18n/eu","select2/dist/js/i18n/es","select2/dist/js/i18n/en","select2/dist/js/i18n/fr","./external/select2MultiCheckboxes"],e):e(jQuery)}((function(e){const t=e.rup.i18nParse(e.rup.i18n.base,"rup_global.functionNotSupportedError"),l=e.rup.i18nParse(e.rup.i18n.base,"rup_global.error");e.extend(e.rup.iniRup,e.rup.rupSelectorObjectConstructor("rup_select",{})),e.fn.rup_select("extend",{getRupValue:function(){var t,l=e(this),a=l.data("settings");let n=l.select2("data");if(null!=n&&0!=n.length||a.multiple?1!=n.length||a.multiple?(t=[],e.each(n,(function(e,l){t.push(l.id)}))):t=n[0].id:t="",void 0!==a&&void 0!==a.submitAsJSON&&a.submitAsJSON){let e=l.attr("name");return null==e&&(e=l.attr("id")),jQuery.rup_utils.getRupValueAsJson(e,t)}return t},setRupValue:function(t){var l=this,a=e(l),n=a.data("settings");if(0===this.length||void 0!==n&&!n.multiple){let s;if(void 0!==n&&void 0===n.data&&void 0!==n.options){let a={};a=n.groups?e.grep(n.optionsGroups,(function(e){return e.id==t})):e.grep(n.options,(function(e){return e.id==t})),void 0!==a[0]&&(0==e("#"+e.escapeSelector(n.id)).find("option[value='"+a[0].id+"']").length?(a=a[0],l._createOption(n,a),t=a.id,s=a.text):(t=a[0].id,s=a[0].text))}let i=a.data("select2");if(void 0!==i){if(1==i.$selection.find("input").length&&(0==n.defaultValueAutocompleteNotLoaded?i.$selection.find("input").val(""):i.$selection.find("input").val(t)),null!=(i.dropdown.$search||i.selection.$search)&&void 0!==s){let t=i.dropdown.$dropdown.find("li"),l=e.grep(t,(function(t){return e(t).text()===s}));t.attr("aria-selected",!1),e(l).attr("aria-selected",!0)}n.selected=t,a.val(t).trigger("change")}}else if("object"==typeof t&&void 0!==n.options){let a=[];e.each(t,(function(t,s){let i={};i=n.groups?e.grep(n.optionsGroups,(function(e){return e.id==s})):e.grep(n.options,(function(e){return e.id==s})),null!=i[0]&&0==e("#"+e.escapeSelector(n.id)).find("option[value='"+i[0].id+"']").length?(i=i[0],l._createOption(n,i),a.push(i.id)):a.push(s)})),n.selected=a,e("#"+e.escapeSelector(n.id)).val(a).trigger("change")}e("#"+e.escapeSelector(n.id)).rup_select("change")},clear:function(){var t=e(this);if(this.length>0){const l=t.data("settings");if(t.data("select2").$selection.find("input").val(""),null==l.data&&e("#"+e.escapeSelector(l.id)).empty(),void 0!==l.blank)if(l.multiple){const l=t.data("settings").blank;t.rup_select("setRupValue",e.isArray(l)?l:[l])}else t.rup_select("setRupValue",t.data("settings").blank);else t.rup_select("setRupValue",null)}},change:function(){e(this).data("settings").change&&e(this).data("settings").change()},checkAll:function(){if(e(this).data("settings").multiple){var t=[];e("#"+e.escapeSelector(e(this)[0].id)+" option").each((function(){t.push(e(this).val())})),e(this).rup_select("setRupValue",t)}else alert("FunciÃ³n no soportada.")},selectByLabel:function(t){let l=e(this).data("settings");if(void 0!==l.options){let a=l.options;if(l.groups&&(a=l.optionsGroups),l.multiple){let l=[];e.each(t,(function(t,n){let s=e.grep(a,(function(e){return e.text===n}));void 0!==s[0]&&l.push(s[0].id)})),e(this).rup_select("setRupValue",l)}else{let l=e.grep(a,(function(e){return e.text===t}));void 0!==l[0]&&e(this).rup_select("setRupValue",l[0].id)}}},select:function(t){let l=e(this).data().settings,a=l.data||l.options;if(l.groups&&(a=l.optionsGroups),l.multiple){let l=[];e.each(t,(function(e,t){a.length>=t&&l.push(a[t].id)})),e(this).rup_select("setRupValue",l)}else a.length>=t&&e(this).rup_select("setRupValue",a[t].id)},deselect:function(){e(this).data("settings").deselect&&e(this).data("settings").deselect()},label:function(){let t=e(this).select2("data");if(e(this).data("settings").multiple){var l=[];for(let e=0;e<t.length;e++)l.push(t[e].text);return l}return t[0].text},index:function(){let t=e(this).data("settings");if(void 0!==t.options){let l=t.options;t.groups&&(l=t.optionsGroups);let a=0,n=e(this).select2("data");if(t.multiple){let s=[];return e.each(n,(function(n,i){a=0,e.each(l,(function(e,l){if(t.blank!==i.id.toString()&&(a+=1),i.id.toString()===l.id.toString())return s.push(a),!1}))})),s}return e.each(l,(function(e,l){if(t.blank!==l.id.toString()&&(a+=1),l.id.toString()===n[0].id.toString())return!1})),a}},disable:function(){e(this).prop("disabled",!0)},enable:function(){e(this).prop("disabled",!1)},isDisabled:function(){return"disabled"===e(this).attr("disabled")},reload:function(t){let l=e(this).data("settings");e(this).select2("destroy"),t&&e(this).find("option").remove(),e(this).rup_select(l)},setSource:function(t,l){var a=this;if(void 0!==t&&""!==t){let n=e(a),s=n.data().settings,i=n.data("select2");void 0===n.data().settings.data?(i.dataAdapter.ajaxOptions.url=t,null!=l&&(i.dataAdapter.ajaxOptions.headers=e.toJSON(l))):(s.data=t,s.options=void 0,n.data("settings",s),null!=i.$selection&&i.$selection.find("input").val(""),n.empty(),void 0!==s.data&&s.autocomplete?e.each(s.data,(function(){a._createOption(s,this)})):n.select2({data:s.data})),1==s.multiple&&(null!=s.dataParents&&(s.data=s.dataParents),n.rup_select("reload"))}},getDataSelected:function(){let t=e(this).select2("data");return e(this).data("settings").multiple?t:t[0]},addOption:function(t,l,a){let n=new Option(t,l);if(e(this).data("settings").groups&&null!=a){let s=e(this).data("select2").options.options;e(this).find('optgroup[label="'+a+'"]').append(n);let i=e.grep(s.data,(function(e,t){return e.text===a}));null!=i&&1==i.length&&(i[0].children[i[0].children.length]={id:t,text:l})}else e(this).append(n)},disableOpt:function(a){if(e(this).data("settings").multiple){if(this.find("[value='"+a+"']").attr("disabled","disabled"),null!=e(this).data("settings").sourceGroup){var n=obj.parentsUntil("ul").last().prevAll("li.ui-multiselect-optgroup-label").first(),s=n.nextUntil("li.ui-multiselect-optgroup-label").find("input"),i=!0;for(let e=0;e<s.length;e++)if(!s[e].disabled){i=!1;break}i&&(n.css("color","grey"),n.children("a").remove(),n.children("span").not(".rup-combo_multiOptgroupLabel").remove())}}else e.rup.errorGestor(t,l)},disableOptArr:function(a){if(e(this).data("settings").multiple)for(let t=0;t<a.length;t++)e(this).rup_select("disableOpt",a[t]);else e.rup.errorGestor(t,l)},enableOpt:function(a){if(e(this).data("settings").multiple){this.find("[value='"+a+"']").removeAttr("disabled");var n=e("#rup-multiCombo_"+e.escapeSelector(e(this).attr("id"))).find("[value='"+a+"']");if(n.removeAttr("disabled"),n.parent().css("color","black"),null!=e(this).data("settings").sourceGroup){var s=n.parentsUntil("ul").last().prevAll("li.ui-multiselect-optgroup-label").first();0===s.children("a").length&&(s.css("color","black"),this._generateOptGroupLabel(s,e(this).data("settings").multiOptgroupIconText))}}else e.rup.errorGestor(t,l)},enableOptArr:function(a){if(e(this).data("settings").multiple)for(let t=0;t<a.length;t++)e(this).rup_select("enableOpt",a[t]);else e.rup.errorGestor(t,l)},order:function(t,l,a){let n=(e(this).data("select2")||e(this).parent().data("select2")).options.options;if(t)e(this).find("optgroup").each((function(){e(this).rup_select("order",!1,l,a)})),null!=n.data&&e(n.data).each((function(){null!=this.children&&this.children.length>0&&(this.children=this.children.sort(((e,t)=>e.text.localeCompare(t.text))))}));else{let t=e(this).find("option").not("[value="+n.blank+"]"),l=e(this).find("option[value="+n.blank+"]");t.sort(((e,t)=>e.innerText.localeCompare(t.innerText))),e(this).html(t),1==l.length&&e(this).prepend(l)}},search:function(t,l){let a=e(this).data("select2").dropdown.$search||e(this).data("select2").mySelect.selection.$search;l||e(".select2-hidden-accessible").select2("close"),e(this).data("select2").$container.find("input").val(t),null!=a&&(a.val(t),e(this).data("settings").selected=t,a.trigger("keyup"))},option:function(t,l,a){let n=e(this).data("settings");n[t]=l,e(this).select2("destroy"),a&&e(this).find("option").remove(),e(this).rup_select(n)},open:function(t){t||e(".select2-hidden-accessible").select2("close"),e(this).select2("open")},close:function(t){t||e(".select2-hidden-accessible").select2("close"),e(this).select2("close")},destroy:function(t){e(this).select2("destroy"),t||e(this).find("option").remove()}}),e.fn.rup_select("extend",{_selectLabel:function(t,l){var a;for(let n=0;n<e("option",t).length;n+=1)if(a=jQuery(t).find("option").eq(n),jQuery(t).find("option").eq(n).text()===l)return e(t).selectmenu("index",a.prop("index")),!0;return!1},_getBlankLabel:function(t){var l=e.rup.i18n.app;return l[t]&&l[t]._blank?l[t]._blank:l.rup_select&&l.rup_select.blank?l.rup_select.blank:e.rup.i18n.base.rup_select.blankNotDefined},_getParentsValues:function(t,l,a){let n="";var s=[];if(null==t.parent)return"";"string"==typeof t.parent?s.push(t.parent):s=t.parent;let i=0;return e.each(s,(function(s,r){null!=r&&null!=e("#"+e.escapeSelector(r)).val()&&(e.isArray(e("#"+e.escapeSelector(r)).val())||""==e("#"+e.escapeSelector(r)).val().trim()?e.isArray(e("#"+e.escapeSelector(r)).val())&&e("#"+e.escapeSelector(r)).val().length>0&&(l?n+=e("#"+e.escapeSelector(r)).attr("name")+"="+e("#"+e.escapeSelector(r)).val()+"&":n=""!=n?n+a+e("#"+e.escapeSelector(r)).val():e("#"+e.escapeSelector(r)).val(),i+=1):t.blank==e("#"+e.escapeSelector(r)).val()?n="":(l?n+=e("#"+e.escapeSelector(r)).attr("name")+"="+e("#"+e.escapeSelector(r)).val()+"&":n=""!=n?n+a+e("#"+e.escapeSelector(r)).val():e("#"+e.escapeSelector(r)).val(),i+=1))})),i<s.length?"":(""!==n&&l&&(n=n.substring(0,n.length-1)),n)},_parseLOCAL:function(t,l,a){var n=this;let s,i=t;if(a)Array.isArray(t)&&(t=t[0]),e.each(t,(function(e,a){t[e]=n._parseLOCAL(t[e],l,!1)}));else{t=[];for(let a=0;a<i.length;a+=1)"object"==typeof i[a]?(s=i[a].i18nCaption?e.rup.i18nParse(e.rup.i18n.app[l],i[a].i18nCaption):i[a].text,i[a].text=s):t[a]={id:i[a],text:i[a]};if(t.length>0)return t}return i},_parseRemoteGroup:function(e,t){let l,a=[];for(let t=0;t<e.length;t+=1){l=e[t];let n=Object.keys(l)[0],s={};s.text=n,s.children=l[n],s.id="group__"+t,a.push(s)}return a},_ajaxBeforeSend:function(t,l,a){void 0!==a&&e("#"+e.escapeSelector(l.id)).replaceWith(a),e("#"+e.escapeSelector(l.id)).rup_select("disable"),e("#"+e.escapeSelector(l.id)+"-button span:first-child").removeClass("ui-icon ui-icon-triangle-1-s").addClass("rup-select_loadingText").text(e.rup.i18n.base.rup_select.loadingText);var n=e("#"+e.escapeSelector(l.id)+"-button span:last-child");e(n).removeClass("ui-icon-triangle-1-s"),e(n).text(""),e(n).addClass("rup-select_loading"),t.setRequestHeader("RUP",e.toJSON(l.sourceParam))},_ajaxError:function(t){null!==t.responseText&&void 0!==t.responseTex&&t.responseText.length<200?e.rup.showErrorToUser(t.responseText):e.rup.showErrorToUser(e.rup.i18n.base.rup_select.ajaxError)},_loadRemote:function(t,l){var a=this;t.ajax={url:t.url,dataType:t.dataType,processResults:function(l){if(null==t.placeholder||t.multiple||null!=l.find((e=>e.id==t.blank))||t.autocomplete||l.unshift({id:t.blank,text:t.placeholder}),t.groups){let t=[];e.each(l,(function(e,l){let a=Object.keys(l)[0];t[e]={text:a,children:l[a]}})),l=t}return t.options=l,e("#"+e.escapeSelector(t.id)).data("settings",t),{results:l}},cache:!1,data:function(){return a._getParentsValues(t,!0)},error:function(e,l,n){null!==t.onLoadError?jQuery(t.onLoadError(e,l,n)):("abort"!=l&&a._ajaxError(e,l,n),console.log(l))}},null==t.firstLoad&&(t.firstLoad=!0),(t.selected||t.autocomplete&&null!=t.defaultValue)&&(t.firstLoad=!0);let n=[],s=null;if(t.cacheUrlSelectData={},t.ajax.transport=function(l,i,r){let c=l.data||"_ALL_",o=!0;t.autocomplete||(l.data="");let u,d=e("#"+e.escapeSelector(t.id)).data("select2");if(t.autocomplete)if(t.multiple){let e=document.querySelector(".select2-search--dropdown .select2-search__field");if(l.data.q=e.value,c=l.data.q,!0===t.cacheUrl&&Object.keys(t.cacheUrlSelectData).length>0){let e=t.cacheUrlSelectData.filter((function(e){return a._normalizeString(e.text).includes(a._normalizeString(c))}));return void i(e)}}else l.data.q=d.$container.find("input").val(),c=l.data.q;if(s!==c&&(n=[],o=!1),s=c,1!=t.cache||void 0===n[c]){if(d.$results.find("li").addClass("disabledButtonsTable"),d.$selection.find("input").addClass("disabledButtonsTable"),d.$selection.find("input").blur(),t.parent&&("string"==typeof t.parent?e("#"+e.escapeSelector(t.parent)).rup_select("disable"):e.each(t.parent,(function(t,l){e("#"+e.escapeSelector(l)).rup_select("disable")}))),t.autocomplete){var p="";p=(p=l.data.q).replace(/%/g,"\\%").replace(/_/g,"\\_"),l.data=e.extend({q:p,c:t.contains},t.extraParams)}if(t.parent){var f=a._getParentsValues(t,!0);if(""!=f){if(t.autocomplete){let t=f.split("&");e.each(t,(function(){if(void 0!==this){let e=this.split("=");null!=e&&e.length>0&&(l.data[e[0]]=e[1],c+=e[1])}}))}else l.url.indexOf(f)<0&&(l.url=l.url+"?"+f);u=e.ajax(l)}}else u=e.ajax(l);return null!=u?(u.then((function(l){n[c]=l,e("#"+e.escapeSelector(t.id)).rup_select("enable"),t.parent&&("string"==typeof t.parent?e("#"+e.escapeSelector(t.parent)).rup_select("enable"):e.each(t.parent,(function(t,l){e("#"+e.escapeSelector(l)).rup_select("enable")}))),1!=t.autocomplete&&e("#"+e.escapeSelector(t.id)).empty(),t.autocomplete&&t.multiple&&!0!==t.cacheUrl&&!o&&e("#"+e.escapeSelector(t.id)).empty(),i(n[c]),t.autocomplete&&t.multiple&&(!0===t.cacheUrl?t.cacheUrlSelectData=l:t.firstLoad||o||d.selection.update([]));let a=[],s=t.selected?t.selected:e("#"+e.escapeSelector(t.id)).rup_select("getRupValue");if(t.groups){let a=[];for(var r=0;r<l.length;r+=1)"object"==typeof l[r]&&e.each(l[r],(function(t,l){"object"==typeof l&&e.each(l,(function(){this.id=String(this.id),a.push(this)}))}));l=a,t.optionsGroups=l}let u=e.grep(l,(function(l,n){if(void 0===l.id&&void 0!==l[t.sourceParam.id]?l.id=String(l[t.sourceParam.id]):l.id=String(l.id),void 0===l.text&&void 0!==l[t.sourceParam.text]&&(l.text=l[t.sourceParam.text]),!t.multiple)return l.id==s&&a.push(""==t.blank?n-1:n),l.id==t.selected;{"string"==typeof s&&(s=[s]);let i=e.grep(s,(function(e){return String(e)==l.id}));if(void 0!==i&&i.length>0)return a.push(""==t.blank?n-1:n),l.id==i[0];t.parent&&d.trigger("selection:update",[])}}));if(""!=e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")&&e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")!=t.blank&&(u=e.grep(l,(function(l){return l.id==e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")}))),void 0!==u&&u.length>=1&&e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")!=u[0].id){if(t.multiple){let l=[];e.each(u,(function(e,t){l.push(t.id)})),e("#"+e.escapeSelector(t.id)).rup_select("setRupValue",l)}else e("#"+e.escapeSelector(t.id)).rup_select("setRupValue",u[0].id);e.each(a,(function(l,a){let n=e("#"+e.escapeSelector(t.id)).data("select2").$results.find("li")[a];null!=n&&e(n).attr("aria-selected","true")}))}else if(t.autocomplete){let l=d.selection.$selection.find("input").val();if(e("#"+e.escapeSelector(t.id)).rup_select("setRupValue",1==u.length?u[0].id:t.blank),d.selection.$selection.find("input").val(l),t.fromParentChange=null!=t.parent&&""!=t.parent){const l=Array.isArray(t.parent)?t.parent:t.parent?[t.parent]:[];for(const t of l){const l=e("#"+e.escapeSelector(t)).data("settings");!0===l.fromSong&&(l.fromSong=!1,e("#"+e.escapeSelector(l.id)).data("select2").selection.$selection.find("input").focus())}}else d.selection.$selection.find("input").focus()}else e("#"+e.escapeSelector(t.id)).rup_select("setRupValue",1==u.length?u[0].id:t.blank);if(null!==t.onLoadSuccess&&void 0!==t.onLoadSuccess&&jQuery(t.onLoadSuccess(e("#"+e.escapeSelector(t.id)))),e("#"+e.escapeSelector(t.id)).data("settings",t),e("#"+e.escapeSelector(t.id)).triggerHandler("selectAjaxSuccess",[l]),t.firstLoad){if(t.multiple&&d.selection.update([]),t.autocomplete&&null==t.selected&&null!=t.defaultValue&&null!=l&&(""==e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")||e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")==t.blank)){var p=e.grep(l,(function(e){return e.text.toUpperCase()===t.defaultValue.toUpperCase()}));null!=p[0]&&e("#"+e.escapeSelector(t.id)).rup_select("setRupValue",p[0].id)}t.firstLoad=!1,t.cache?t.selected="":t.selected=e("#"+e.escapeSelector(t.id)).rup_select("getRupValue")}})),u.fail(r)):(d.$container.removeClass("select2-container--open"),d.$dropdown[0].remove(),t.parent&&("string"==typeof t.parent?e("#"+e.escapeSelector(t.parent)).rup_select("enable"):e.each(t.parent,(function(t,l){e("#"+e.escapeSelector(l)).rup_select("enable")})))),u}{i(n[c]);const l=e("#"+e.escapeSelector(t.id)),a=l.rup_select("getRupValue");t.autocomplete||t.selected===a||(t.multiple?(""!==t.selected||t.selected.length>0)&&l.rup_select("setRupValue",t.selected):t.selected&&l.rup_select("setRupValue",t.selected))}},void 0!==t.ajax){if(void 0!==t.data&&(t.ajax.data=t.data),t.autocomplete){let l="";e("#"+e.escapeSelector(t.id)).data("select2"),null!=e("input.select2-search__field")&&null!=e("input.select2-search__field").val()&&(l=e("input.select2-search__field").val()),null==t.contains&&(t.contains=!0),l=l.replace(/%/g,"\\%").replace(/_/g,"\\_"),t.ajax.data=e.extend({q:l,c:t.contains},t.extraParams)}t.sourceParam&&(t.ajax.headers={RUP:e.toJSON(t.sourceParam)}),t.processResults&&(t.ajax.processResults=t.processResults)}if(t.multiple?(null==t.closeOnSelect&&(t.closeOnSelect=!1),e("#"+e.escapeSelector(t.id)).select2MultiCheckboxes(t)):(null!=t.placeholder&&""!=t.placeholder||(t.placeholder=a._getBlankLabel(t.id)),t.autocomplete?(e("#"+e.escapeSelector(t.id)).select2MultiCheckboxes(t),t.spaceEnable&&(sel=e("#"+e.escapeSelector(t.id)).data("select2").selection,sel.$selection.off("keydown"))):e("#"+e.escapeSelector(t.id)).select2(t)),t.firstLoad||t.loadOnStartUp){let l=e("#"+e.escapeSelector(t.id)),a=l.data("select2");t.autocomplete&&null!=t.defaultValue&&a.$container.find("input").val(t.defaultValue),l.select2("trigger","query"),a.$container.removeClass("select2-container--open"),a.$dropdown[0].remove()}},_normalizeString:e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),_textIcon:function(t){void 0===t.stylePosition&&(t.stylePosition="M");let l=e("<span/>"),a=e('<i class="mdi mdi-'+t.style+'"></i>');return t.imgStyle&&(l.addClass(t.style),a=e('<span class="ui-selectmenu-item-icon ui-icon "></span>'),"M"===t.stylePosition.toUpperCase()&&(t.stylePosition="B")),"M"===t.stylePosition.toUpperCase()?a.prepend(t.text):"B"===t.stylePosition.toUpperCase()&&l.prepend(t.text),l.prepend(a),"A"===t.stylePosition.toUpperCase()&&l.prepend(t.text),l},_createOption:function(t,l){let a=new Option(l.text,l.id,!1,!1);null!=l.style&&(a.setAttribute("style",l.style),a.setAttribute("imgStyle",l.imgStyle)),e("#"+e.escapeSelector(t.id)).append(a)},_init:function(t){var l=this,a=e(l);global.initRupI18nPromise.then((()=>{if(t.length>1)e.rup.errorGestor(e.rup.i18nParse(e.rup.i18n.base,"rup_global.initError")+a.attr("id"));else{var n=e.extend({},e.fn.rup_select.defaults,t[0]);n.tabindex=a.attr("tabindex"),n.id=e.escapeSelector(a.attr("id")),void 0===a.attr("name")&&a.attr("name",n.id),n.name=a.attr("name"),e("#"+e.escapeSelector(n.id)).attr("ruptype","select"),n.i18nId||(n.i18nId=n.id),n.inputValue=null===e("#"+e.escapeSelector(n.id)).val()?e("#"+e.escapeSelector(n.id)).prop("value"):e("#"+e.escapeSelector(n.id)).val(),a.prop("attributes"),null===n.firstLoad&&a.is("select")&&n.loadFromSelect,e("#"+e.escapeSelector(n.id)).on("change",(function(){})),void 0!==n.placeholder&&"string"==typeof n.placeholder&&(n.allowClear?0==e("#"+e.escapeSelector(n.id)).find("option").length&&e("#"+e.escapeSelector(n.id)).append(new Option("","")):(n.templateSelection=function(t,a){if(t.id===n.blank){let t=n.placeholder;return"string"!=typeof n.placeholder&&(t=n.placeholder.text),e('<span class="select2-selection__placeholder">'+t+"</span>")}return chargedStyles(t),null!=t.style&&t.id!==n.blank?l._textIcon(t):t.text},""==n.placeholder&&(n.placeholder=l._getBlankLabel(n.id)),""==n.blank&&(n.placeholder={id:"__ph__",text:n.placeholder}),void 0===n.data||n.multiple||(null==n.parent?n.data.unshift({id:n.blank,text:n.placeholder}):e.each(n.data,(function(e,t){t.unshift({id:n.blank,text:n.placeholder})}))))),void 0!==n.myTemplate&&(n.templateSelection=n.myTemplate),void 0===n.templateResult&&(n.multiple&&n.udaSkill?n.templateSelection=function(e,t){return e.text}:void 0!==n.templateSelection?n.templateResult=function(t,a){if(chargedStyles(t),t.id===n.blank){let t=n.placeholder;return"string"!=typeof n.placeholder&&(t=n.placeholder.text),e('<span class="select2-selection__placeholder">'+t+"</span>")}return null!=t.style&&t.id!==n.blank?l._textIcon(t):t.text}:(n.templateResult=function(e,t){return chargedStyles(e),null!=e.style&&e.id!==n.blank?l._textIcon(e):e.text},n.templateSelection=n.templateResult)),e("#"+e.escapeSelector(n.id)).next("a").click((function(){e("#ui-datepicker-div").hide()})),n.customClasses&&e.each(n.customClasses,(function(t,l){e("#"+e.escapeSelector(n.id)+"-button, #"+e.escapeSelector(n.id)+"-menu").addClass(l),e("[for="+n.id+"]").addClass(l)})),n.i18nId||(n.i18nId=n.id);let r=function(t){if("string"==typeof t){let l=t.sort((function(e,t){return e.text.localeCompare(t.text)})),a=e("#"+e.escapeSelector(n.id)).data("settings");return a.options=l,e("#"+e.escapeSelector(n.id)).data("settings",a),l}return t};if(n.data||n.dataGroups)if(!0===n.sortered?n.sorter=r:!1!==n.sortered&&(n.sorter=n.sortered),void 0===n.dataGroups)n.data=l._parseLOCAL(n.data,n.i18nId,n.parent);else{let e=[];for(var s=0;s<n.dataGroups.length;s+=1)if("object"==typeof n.dataGroups[s]){n.dataGroups[s].children=l._parseLOCAL(n.dataGroups[s].children,n.i18nId,n.parent);for(var i=0;i<n.dataGroups[s].children.length;i+=1)e.push(n.dataGroups[s].children[i])}n.optionsGroups=e,n.data=n.dataGroups}else n.ajax||null==n.url?(n.data=!0,n.parent&&(n.data=[],e("#"+e.escapeSelector(n.id)).find("option").each((function(){let e=a.data("idpadre");null!=e&&(void 0===n.data[e]&&(n.data[e]=[],null==n.placeholder&&""==n.placeholder||n.data[e].push({id:n.blank,text:n.placeholder})),n.data[e].push({id:a.val(),text:a.text()}))})))):(void 0===n.sortered?n.sorter=r:!1!==n.sortered&&(n.sorter=n.sortered),l._loadRemote(n,!0));if(n.change&&(n.clean||(e("#"+e.escapeSelector(n.id)).off("select2:clearing"),e("#"+e.escapeSelector(n.id)).on("select2:clearing",(function(e){n.change(e)})))),n.clean&&(e("#"+e.escapeSelector(n.id)).off("select2:clearing"),e("#"+e.escapeSelector(n.id)).on("select2:clearing",(function(e){n.clean(e)}))),e("#"+e.escapeSelector(n.id)).off("select2:select"),e("#"+e.escapeSelector(n.id)).on("select2:select",(function(t){if(n.selected=t.params.data.id,n.autocomplete){let t=e("#"+e.escapeSelector(n.id)).data("select2"),l=a.select2("data")[0];t.$selection.find("input").val(l.text)}n.select&&n.select(t),n.change&&n.change(t)})),e("#"+e.escapeSelector(n.id)).off("select2:unselect"),e("#"+e.escapeSelector(n.id)).on("select2:unselect",(function(e){n.multiple||(n.selected=n.blank),n.deselect&&n.deselect(e),n.change&&n.change(e)})),n.data){if(n.parent){"object"==typeof n.parent&&1==n.parent.length&&(n.parent=n.parent[0]),void 0===n.dataParents&&(n.dataParents=n.data);let e=l._getParentsValues(n,!1,n.multiValueToken);""!=e&&(valoresParent=n.dataParents[e],null==valoresParent&&null!=n.dataParents[0]&&(valoresParent=n.dataParents[0][e]),n.data=valoresParent,null==n.data&&(n.data=[]))}if(n.multiple)null==n.closeOnSelect&&(n.closeOnSelect=!1),e("#"+e.escapeSelector(n.id)).select2MultiCheckboxes(n);else{if(null!=n.placeholder&&""!=n.placeholder||(n.placeholder=l._getBlankLabel(n.id)),n.autocomplete){null==n.matcher&&0==n.accentFolding&&(n.matcher=udaMatcher),e("#"+e.escapeSelector(n.id)).select2MultiCheckboxes(n);let t=e("#"+e.escapeSelector(n.id)).data("select2");if(n.spaceEnable&&t.$selection.off("keydown"),null!=n.defaultValue&&(t.$selection.find("input").val(n.defaultValue),null==n.selected&&null!=t.dataAdapter._dataToConvert&&t.dataAdapter._dataToConvert.length>0)){let l=e.grep(t.dataAdapter._dataToConvert,(function(e){return e.text.toUpperCase()===n.defaultValue.toUpperCase()}));null!=l[0]&&(n.selected=l[0].id)}}else e("#"+e.escapeSelector(n.id)).select2(n);if(n.deleteOnDeselect){let t=e("#"+e.escapeSelector(n.id)).data("select2");t.on("close",(function(l){1===Object.keys(l).length&&(t.$selection.find("input").val(""),n.selected=void 0,e("#"+e.escapeSelector(n.id)).val(null).trigger("change"),n.closeOnSelect||e("#"+e.escapeSelector(n.id)).select2("open"))}))}}n.selected&&e("#"+e.escapeSelector(n.id)).val(n.selected).trigger("change"),n.options=n.data}else if(n.deleteOnDeselect){let t=e("#"+e.escapeSelector(n.id)).data("select2");t.on("close",(function(l){1===Object.keys(l).length&&(t.$selection.find("input").val(""),n.selected=void 0,e("#"+e.escapeSelector(n.id)).val(null).trigger("change"),n.closeOnSelect||e("#"+e.escapeSelector(n.id)).select2("open"))}))}if(n.parent){let t=[];"string"==typeof n.parent?t.push(n.parent):1==n.parent.length?(n.parent=n.parent[0],t.push(n.parent)):t=n.parent,e.each(t,(function(t,a){e("#"+e.escapeSelector(a)).off("change.parent"+n.id),e("#"+e.escapeSelector(a)).on("change.parent"+n.id,(function(){if(void 0!==n.data){if("object"==typeof n.parent){let t="",l="";null==n.multiValueToken&&(n.multiValueToken=""),e.each(n.parent,(function(a,s){let i=e("#"+e.escapeSelector(s)).rup_select("getRupValue");t=t+i+n.multiValueToken;let r=e("#"+e.escapeSelector(s)).rup_select("getDataSelected");void 0!==r&&(i=r.id,l=l+i+n.multiValueToken)})),t=t.substring(0,t.length-n.multiValueToken.length),l=l.substring(0,l.length-n.multiValueToken.length);let a=n.dataParents[0]||n.dataParents;if(null!=a[t]||null!=a[l]){let s=a[t]||a[l];n.data=a,e("#"+e.escapeSelector(n.id)).rup_select("setSource",s)}}else{let t=e("#"+e.escapeSelector(n.parent)).rup_select("getRupValue");if(t!=n.blank&&""!=t){let l;e("#"+e.escapeSelector(n.id)).rup_select("enable"),e.isArray(t)?(l=[],e.each(t,(function(e,t){l=l.concat(n.dataParents[t])}))):l=n.dataParents[t],n.data=n.dataParents,null==l&&(l=[]),e("#"+e.escapeSelector(n.id)).rup_select("setSource",l)}else e("#"+e.escapeSelector(n.id)).rup_select("disable")}e("#"+e.escapeSelector(n.id)).rup_select("setRupValue",n.blank)}else{const t=e.escapeSelector(n.id);if(""!=l._getParentsValues(n,!0)){e("#"+t).rup_select("disable");let l=e("#"+t),a=l.data("select2").dropdown.$search||l.data("select2").selection.$search;if(n.multiple&&(selection=l.data("select2").$selection.find(".select2-selection__rendered"),texto=l.data("select2").options.options.templateSelection({selected:[],all:[]},selection),selection.text(texto)),n.autocomplete?l.data("select2").$container.find("input").val(""):1!=n.firstLoad&&(n.selected=""),null!=a){let e=l.data("select2");l.select2("trigger","query"),e.$container.removeClass("select2-container--open"),e.$dropdown[0].remove()}n.multiple||null==e("#"+t).val()||""==e("#"+t).val().trim()?n.multiple&&null!=e("#"+t).val()&&e("#"+t).val().length>0&&e("#"+t).val(null).trigger("change"):e("#"+t).val(null).trigger("change"),setTimeout(e("#"+t).rup_select("enable"),200)}else n.multiple||null==e("#"+t).val()||""==e("#"+t).val().trim()?n.multiple&&null!=e("#"+t).val()&&e("#"+t).val().length>0&&(e("#"+t).val(null).trigger("change"),e("#"+t).rup_select("disable")):(e("#"+t).val(null).trigger("change"),e("#"+t).rup_select("disable"))}}))}))}if(n.noCheck){let t=e("#"+e.escapeSelector(n.id)).data("select2");t.on("results:all",(function(){t.$results.find("li").each((function(){e(this).addClass("ocultar-before")}))}))}e("#"+e.escapeSelector(n.id)).data("settings",n),e("#"+e.escapeSelector(n.id)).triggerHandler("selectFinish",n)}})).catch((e=>{console.error("Error al inicializar el componente:\n",e)}))}}),e.fn.rup_select.defaults={language:window.LANG,onLoadError:null,width:"100%",customClasses:["select-material"],blank:"-1",minimumResultsForSearch:1/0,submitAsJSON:!1,dataType:"json",cache:!0,multiple:!1,defaultValueAutocompleteNotLoaded:!1,multiValueToken:"##",spaceEnable:!0}}));