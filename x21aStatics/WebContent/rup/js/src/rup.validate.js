/*! For license information please see rup.validate.js.LICENSE.txt */
!function(e){"function"==typeof define&&define.amd?define(["jquery","./rup.base","jquery-validation","jquery-validation/dist/additional-methods"],e):e(jQuery)}((function(e){global.initRupI18nPromise.then((()=>{$.rup_validate={},$.extend($.rup.iniRup,$.rup.rupSelectorObjectConstructor("rup_validate",{}));var t={},r=new RegExp("\\{\\d\\}");function a(e){return e.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[0-9.(),;:!?%#$'"_+=/-]*/g,"")}$.each($.rup.i18n.base.rup_validate.messages,(function(a,i){null!==i.match(r)?t[a]=e.validator.format(i):t[a]=i})),$.extend($.validator.messages,t),e.validator.addMethod("dni",(function(e,t){return this.optional(t)||window.euroNif(e)})),e.validator.addMethod("dni",(function(e,t){return this.optional(t)||function(e){if(9===e.length){var t=e.substr(0,8);t%=23;var r="TRWAGMYFPDXBNJZSQVHLCKET";return(r=r.substring(t,t+1))==e.substr(e.length-1,e.length).toUpperCase()}return!1}(e)})),e.validator.addMethod("maxWords",(function(e,t,r){return this.optional(t)||a(e).match(/\b\w+\b/g).length<r})),e.validator.addMethod("minWords",(function(e,t,r){return this.optional(t)||a(e).match(/\b\w+\b/g).length>=r})),e.validator.addMethod("rangeWords",(function(e,t,r){return this.optional(t)||a(e).match(/\b\w+\b/g).length>=r[0]&&e.match(/bw+b/g).length<r[1]})),e.validator.addMethod("letterswithbasicpunc",(function(e,t){return this.optional(t)||/^[a-z-.,()'"\s]+$/i.test(e)})),e.validator.addMethod("lettersunicodewithbasicpunc",(function(e,t){return this.optional(t)||/^[\p{L}.,()'"\s]+$/iu.test(e)})),e.validator.addMethod("alphanumeric",(function(e,t){return this.optional(t)||/^\w+$/i.test(e)})),e.validator.addMethod("lettersonly",(function(e,t){return this.optional(t)||/^[a-z]+$/i.test(e)})),e.validator.addMethod("lettersunicodeonly",(function(e,t){return this.optional(t)||/^[\p{L}]+$/iu.test(e)})),e.validator.addMethod("letters",(function(e,t){return this.optional(t)||/^[a-z\s]+$/i.test(e)})),e.validator.addMethod("lettersunicode",(function(e,t){return this.optional(t)||/^[\p{L}\s]+$/iu.test(e)})),e.validator.addMethod("nowhitespace",(function(e,t){return this.optional(t)||/^\S+$/i.test(e)})),e.validator.addMethod("integer",(function(e,t){return this.optional(t)||/^-?\d+$/.test(e)})),e.validator.addMethod("pattern",(function(e,t,r){return _.isRegExp(r)||(r=new RegExp(r)),this.optional(t)||r.test(e)})),e.validator.addMethod("number",(function(e,t){if("text"===$(t).attr("type"))return this.optional(t)||new RegExp($.rup.i18n.base.rup_validate.regexp.decimal).test(e);$.rup.errorGestor($.rup.i18nTemplate($.rup.i18n.base,"rup_validate.errors.numberValidation"))})),e.validator.addMethod("date",(function(e,t,r){var a;if("boolean"==typeof r){if(!0!==r)return!0;a=$.rup.i18n.base.rup_validate.format.date}else a=r;return this.optional(t)||$.rup_validate.checkDate(a,e)})),e.validator.addMethod("email",(function(e,t){return this.optional(t)||/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)})),$.extend($.rup_validate,{checkDate:function(e,t){var r,a={};if(r=-1!=(e=e.toLowerCase()).indexOf("/")?"/":-1!=e.indexOf("-")?"-":-1!=e.indexOf(".")?".":"/",e=e.split(r),3!=(t=t.split(r)).length)return!1;for(var i,n=-1,o=-1,d=-1,l=0;l<e.length;l++){var s=null===t[l]||""===t[l]||isNaN(t[l])?0:parseInt(t[l],10);a[e[l]]=s,-1!=(i=e[l]).indexOf("y")&&(n=l),-1!=i.indexOf("m")&&(d=l),-1!=i.indexOf("d")&&(o=l)}i="y"==e[n]||"yyyy"==e[n]?4:"yy"==e[n]?2:-1;var u,p,f=function(){for(var e=[],t=1;t<=12;t++)e[t]=31,4!=t&&6!=t&&9!=t&&11!=t||(e[t]=30),2==t&&(e[t]=29);return e}();return-1!==n&&(u=a[e[n]].toString(),2==i&&1==u.length&&(i=1),!(u.length!=i||0===a[e[n]]&&"00"!=t[n]||-1===d||(u=a[e[d]].toString()).length<1||a[e[d]]<1||a[e[d]]>12||-1===o||(u=a[e[o]].toString()).length<1||a[e[o]]<1||a[e[o]]>31||2==a[e[d]]&&a[e[o]]>((p=a[e[n]])%4!=0||p%100==0&&p%400!=0?28:29)||a[e[o]]>f[a[e[d]]]))}}),$.fn.rup_validate("extend",{destroy:function(){var e=this;e.rup_validate("resetForm"),$.removeData(e[0]),e.off()},resetForm:function(){const e=this,t=e.data("settings"),r=$("[ruptype='select']",e);null!=t&&void 0!==t.feedback&&t.showErrorsInFeedback&&t.feedback.rup_feedback("hide"),r.length>0&&r.each((function(e,t){$(t).rup_select("clear")})),e.validate().resetForm()},resetElements:function(){var e=this.validate();e.resetElements(e.elements())}}),$.fn.rup_validate("extend",{});var i={defaultPresetSettings:{showErrors:function(t){var r,a,i,n,o,d,l,s,u=this;if(1===u.currentElements.length&&$.isEmptyObject(t)&&delete u.invalid[u.currentElements.attr("name")],a=u.settings.feedback,u.settings.showErrorsInFeedback&&null!=a&&(r=$("<ul>").addClass("rup-maint_feedbackUL").prepend(u.settings.feedbackErrorConfig.errorMsg),e.isEmptyObject(u.invalid)?a.rup_feedback("close"):(u.settings.showFieldErrorsInFeedback&&$.each(e.isEmptyObject(u.submitted)?u.invalid:u.submitted,(function(e,t){void 0!==u.invalid[e]&&(i=u.settings.feedbackErrorConfig.getField(u,u.currentForm,e),n=u.settings.feedbackErrorConfig.getFieldName(u,u.currentForm,i),o=u.settings.feedbackErrorConfig.getFieldErrorLabel(u,u.currentForm,i,n),d=u.settings.feedbackErrorConfig.getFieldErrorMsg(u,u.currentForm,i,t),o.append(d),r.append(o))})),a.rup_feedback("option",u.settings.feedbackOptions),a.rup_feedback("set",r,"error"))),u.settings.showFieldErrorAsDefault)for(var p=0;u.errorList[p];p++)void 0!==(l=u.errorList[p]).element&&(s=u.errorsFor(l.element)).length&&s.remove();for(let e=0;e<u.errorList.length;e++)if(void 0===u.errorList[e].element&&$.rup.errorGestor($.rup.i18nParse($.rup.i18n.base,"rup_validate.messages.fieldError"),$.rup.i18nParse($.rup.i18n.base,"rup_validate.messages.validationErrorTitle")),Array.isArray(u.errorList[e].message)){for(var f="",c=0;c<u.errorList[e].message.length;c++)f+=u.errorList[e].message[c],c!==u.errorList[e].message.length-1&&(f+=", ");u.errorList[e].message=f}for(var h=u.currentForm.getElementsByClassName("rup-validate-error-icon");void 0!==h&&h.length>0;)h[0].parentNode.removeChild(h[0]);u.defaultShowErrors()},showErrorsInFeedback:function(){},errorPlacement:function(e,t){e.insertAfter(t)}},showFieldErrorAsDefault:{errorElement:"img",errorPlacement:function(e,t){e.attr("src",this.errorImage).addClass("rup-maint_validateIcon").html("").rup_tooltip({applyToPortal:!0}).insertAfter(t)}}};$.fn.rup_validate("extend",{_init:function(e){var t,r,a,n=this;t=$.extend(!0,{},{adapter:$.fn.rup_validate.defaults.adapter},{adapter:i.defaultPresetSettings.adapter},{adapter:e[0].adapter}),n[0]._ADAPTER=$.rup.adapter[t.adapter],r=$.extend(!0,{},i.defaultPresetSettings,{showFieldErrorAsDefault:{highlight:n[0]._ADAPTER.highlight,unhighlight:n[0]._ADAPTER.unhighlight,errorElement:n[0]._ADAPTER.errorElement,errorPlacement:n[0]._ADAPTER.errorPlacement}}),a=$.extend(!0,{},$.fn.rup_validate.defaults,r,e[0]),n.addClass("rup_validate"),n.attr("ruptype","validate"),a.showFieldErrorAsDefault&&(a=$.extend(!0,a,r.showFieldErrorAsDefault)),void 0!==(a=$.extend(!0,{},a,e[0])).onSubmitHandler&&(a.submitHandler=a.onSubmitHandler),n.validate(a),a.showFieldErrorAsDefault&&(n.validate().showLabel=n[0]._ADAPTER.showLabel),a.liveCheckingErrors||n.off("click").off("focusin").off("focusout").off("keyup"),n.on("invalid-form.rupValidate_formValidationError",(function(){n.off("invalid-form.rupValidate_formValidationError"),n.triggerHandler("rupValidate_formValidationError",[this])})),n.data("settings",a)}}),$.fn.rup_validate.defaults={adapter:"validate_material",ignore:".select2-selection__rendered input",feedbackOptions:{gotoTop:!1,fadeSpeed:null,delay:null},feedbackErrorConfig:{errorMsg:$.rup.i18nParse($.rup.i18n.base,"rup_table.validateError"),getField:function(e,t,r){return $("[name='"+r+"']",t)},getFieldName:function(t,r,a){var i,n,o;return n={labelForId:(i=e(a.length>1?a[0]:a)).attr("id"),labelForName:i.attr("name"),labelForTitle:i.attr("oldtitle")},o=$.rup.adapter[$.fn.rup_validate.defaults.adapter],$.fn.rup_validate.defaults.adapter,void 0!==(o=o.forLabelElement(r,n))&&""!==o?o.replace(":",""):void 0!==(o=$.rup.adapter[$.fn.rup_validate.defaults.adapter].forInputIdElement(r,n))&&""!==o?o.id:void 0!==(o=$.rup.adapter[$.fn.rup_validate.defaults.adapter].forInputNameElement(r,n))&&""!==o?o.name:i.attr("title")},getFieldErrorLabel:function(e,t,r,a){return $("<li>").append("<b>"+a+":</b>")},getFieldErrorMsg:function(e,t,r,a){if(Array.isArray(a)){for(var i=$("<ul>"),n=0;n<a.length;n++)i.append($("<li>").append(a[n]));return i}return $("<ul>").append($("<li>").append(a))}},liveCheckingErrors:!1,showErrorsInFeedback:!0,showFieldErrorAsDefault:!0,showFieldErrorsInFeedback:!0,errorImage:$.rup.STATICS+"/rup/css/images/exclamation.png"}})).catch((e=>{console.error("Error al inicializar el componente:\n",e)}))}));