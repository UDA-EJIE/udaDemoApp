import"jquery";import*as testutils from"../common/specCommonUtils.js";import"handlebars";import"jasmine-jquery";import"rup.message";function messageTester(e){var t=$.Deferred();describe("Test Message "+e,(()=>{beforeAll((e=>{testutils.loadCss(e)})),afterAll((()=>{t.resolve()})),beforeEach((t=>{let s=()=>{$("#content").addClass("msg-cls")};switch(e){case"Ok":$.rup_messages("msgOK",{title:"Correcto",message:"Todo ha ido Ok",buttonText:"Prueba OK",beforeClose:s}),t();break;case"Alert":$.rup_messages("msgAlert",{title:"Aviso",message:"Advertencia",buttonText:"Prueba alert",beforeClose:s}),t();break;case"Error":$.rup_messages("msgError",{title:"Error",message:"Fallo",buttonText:"Prueba error",beforeClose:s}),t();break;case"Confirm":$.rup_messages("msgConfirm",{title:"Confirmacion",message:"¿Confirma?",OKText:"Sí",CANCELText:"No",beforeClose:s}),t()}})),afterEach((e=>{let t=$("#content");t.is(".msg-cls")&&t.removeClass("msg-cls"),t.nextAll().remove(),e()})),describe("Creación > ",(()=>{it("Posee las clases adecuadas:",(t=>{switch(e){case"Ok":expect($("div.ui-dialog").is(".rup-message.rup-message-ok")).toBeTruthy();break;case"Alert":expect($("div.ui-dialog").is(".rup-message.rup-message-alert")).toBeTruthy();break;case"Error":expect($("div.ui-dialog").is(".rup-message.rup-message-error")).toBeTruthy();break;case"Confirm":expect($("div.ui-dialog").is(".rup-message.rup-message-confirm")).toBeTruthy()}t()})),it("Posee el título correspondiente:",(t=>{switch(e){case"Ok":expect($(".ui-dialog-titlebar > span.ui-dialog-title").text()).toBe("Correcto");break;case"Alert":expect($(".ui-dialog-titlebar > span.ui-dialog-title").text()).toBe("Aviso");break;case"Error":expect($(".ui-dialog-titlebar > span.ui-dialog-title").text()).toBe("Error");break;case"Confirm":expect($(".ui-dialog-titlebar > span.ui-dialog-title").text()).toBe("Confirmacion")}t()})),it("Posee el mensaje especificado:",(t=>{switch(e){case"Ok":expect($('.ui-dialog-content [id$="_msg"]').text()).toBe("Todo ha ido Ok");break;case"Alert":expect($('.ui-dialog-content [id$="_msg"]').text()).toBe("Advertencia");break;case"Error":expect($('.ui-dialog-content [id$="_msg"]').text()).toBe("Fallo");break;case"Confirm":expect($('.ui-dialog-content [id$="_msg"]').text()).toBe("¿Confirma?")}t()})),it("Posee los botones apropiados:",(t=>{switch(e){case"Ok":expect($("button",$(".ui-dialog-buttonset")).text()).toBe("Prueba OK");break;case"Alert":expect($("button",$(".ui-dialog-buttonset")).text()).toBe("Prueba alert");break;case"Error":expect($("button",$(".ui-dialog-buttonset")).text()).toBe("Prueba error");break;case"Confirm":expect($("button",$(".ui-dialog-buttonset")).length).toBe(2),expect($("button:first",$(".ui-dialog-buttonset")).text()).toBe("No"),expect($("button:last",$(".ui-dialog-buttonset")).text()).toBe("Sí")}t()}))})),describe("Funcionamiento > ",(()=>{describe("Cerrado del message > ",(()=>{beforeEach((e=>{window.done=e,$(".ui-dialog").on("dialogclose"),$("i.mdi.mdi-close.float-end.pointer").click(),e()})),it("Se cierra el message:",(e=>{expect($(".ui-dialog:visible").length).toBe(0),e()})),it("Se ejecuta el callback de cierre:",(e=>{expect($("#content").is(".msg-cls")).toBeTruthy(),e()}))}))}))}))}$.when(messageTester("Ok")).then(messageTester("Alert")).then(messageTester("Error")).then(messageTester("Confirm"));