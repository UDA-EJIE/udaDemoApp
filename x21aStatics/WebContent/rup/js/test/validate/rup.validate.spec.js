import"jquery";import*as testutils from"../common/specCommonUtils";import"jasmine-jquery";import"rup.feedback";import"rup.validate";describe("Test Validate >  ",(()=>{var e,a,o,r=!1,t=!1;beforeAll((e=>{testutils.loadCss(e)})),beforeEach((s=>{$("#content").append('<form id="exampleValidate">                            <label for="campoUno">Campo 1</label><input type="text" name="campoUno" id="campoUno"></input >                             <label for="campoDos">Campo 2</label><input type="text" name="campoDos" id="campoDos"></input>                        </form>                        <div id="feedback"></div>'),$("#content").append('<form id="exampleValidateEvent">                            <label for="campoUnoEvent">Campo 1</label><input type="text" name="campoUnoEvent" id="campoUnoEvent"></input >                        </form>');var l={feedback:a=$("#feedback").rup_feedback({type:"ok",closeLink:!0,block:!1}),liveCheckingErrors:!1,showFieldErrorAsDefault:!0,showErrorsInFeedback:!0,showFieldErrorsInFeedback:!0,rules:{campoUno:{required:!0},campoDos:{required:!0}}};global.initRupI18nPromise.then((()=>{e=$("#exampleValidate").rup_validate(l),o=$("#exampleValidateEvent").rup_validate({rules:{campoUnoEvent:{required:!0}},onSubmitHandler:()=>{t=!0,$("#exampleValidateEvent").triggerHandler("submitSuccessfull")},invalidHandler:()=>{r=!0}}),s()}))})),afterEach((()=>{$("#content").html(""),$("#content").nextAll().html(""),t=!1,r=!1})),describe("Creación > ",(()=>{it("El formulario tiene que tener la clase rup_validate",(()=>{expect(e.hasClass("rup_validate")).toBeTruthy()})),it("El feedback debe estar oculto",(()=>{expect(a.is(":visible")).toBeFalsy()}))})),describe("La validación funciona, no debe pasar > ",(()=>{beforeEach((()=>{$("#campoUno").val("foo"),e.valid()})),it("Debe mostrarse el feedback",(()=>{expect(a.is(":visible")).toBeTruthy()})),it("Cada campo del form debe tener la clase error",(()=>{expect($("#campoUno").hasClass("error")).toBeFalsy(),expect($("#campoDos").hasClass("error")).toBeTruthy()}))})),describe("La validación funciona, debe pasar > ",(()=>{beforeEach((()=>{$("#campoUno").val("foo"),$("#campoDos").val("foo"),e.valid()})),it("No debe mostrarse el feedback",(()=>{expect(a.is(":visible")).toBeFalsy()})),it("Cada campo del form debe tener la clase error",(()=>{expect($("#campoUno").hasClass("error")).toBeFalsy(),expect($("#campoDos").hasClass("error")).toBeFalsy()}))})),describe("Eventos > ",(()=>{describe("invalidHandler",(()=>{beforeEach((e=>{$("#exampleValidateEvent").on("rupValidate_formValidationError",(()=>{e()})),$("#campoUnoEvent").val(""),o.valid()})),it("Debe lanzarse el evento",(()=>{expect(r).toBeTruthy()}))})),describe("onSubmitHandler",(()=>{beforeEach((e=>{$("#campoUnoEvent").val("foo"),o.submit(),setTimeout((()=>{e()}),500)})),it("Debe lanzarse el evento",(()=>{expect(t).toBeTruthy()}))}))})),describe("Métodos públicos > ",(()=>{describe("Método resetForm > ",(()=>{beforeEach((()=>{e.valid(),e.rup_validate("resetForm")})),it("Debe mantenerse el feedback",(()=>{expect(a.is(":visible")).toBeTruthy()})),it("Los campos del form no deben tener la clase error",(()=>{expect($("#campoUno").hasClass("error")).toBeFalsy(),expect($("#campoDos").hasClass("error")).toBeFalsy()}))})),describe("Método resetElements > ",(()=>{beforeEach((()=>{e.valid(),e.rup_validate("resetElements")})),it("Debe mantenerse el feedback",(()=>{expect(a.is(":visible")).toBeTruthy()})),it("Los campos del form no deben tener la clase error",(()=>{expect($("#campoUno").hasClass("error")).toBeFalsy(),expect($("#campoDos").hasClass("error")).toBeFalsy()}))})),describe("Método destroy > ",(()=>{beforeEach((()=>{e.rup_validate("destroy"),e.valid()})),it("No debe existir",(()=>{expect($("#campoUno").hasClass("error")).toBeFalsy(),expect($("#campoDos").hasClass("error")).toBeFalsy()}))}))}))}));