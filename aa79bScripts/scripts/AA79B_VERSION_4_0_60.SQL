DEFINE DIR_SCRIPTS = '/aplic/aa79b/scripts';


--En la tabla AA79B02T00.

ALTER TABLE AA79B02T00 RENAME COLUMN PAL_HORA_CONCOR_95_100_002 TO PAL_HORA_CONCOR_95_99_002; 

ALTER TABLE AA79B02T00 ADD PAL_HORA_CONCOR_100_002 NUMBER(6,2) NULL;

ALTER TABLE AA79B02T00 RENAME COLUMN PAL_SEG_CONCOR_95_100_002 TO PAL_SEG_CONCOR_95_99_002; 

ALTER TABLE AA79B02T00 ADD PAL_SEG_CONCOR_100_002 NUMBER(6,3) NULL;

--Actualizamos/insertamos los valores correspondientes para los nuevos campos

UPDATE AA79B02T00 SET PAL_HORA_CONCOR_100_002 = PAL_HORA_CONCOR_95_99_002, PAL_SEG_CONCOR_100_002 = PAL_SEG_CONCOR_95_99_002 WHERE NIVEL_USUARIO_002 = 'V';

UPDATE AA79B02T00 SET PAL_HORA_CONCOR_100_002 = 1440.00, PAL_SEG_CONCOR_100_002 = 3.000  WHERE NIVEL_USUARIO_002 = 'N' AND ID_TIPO_RELEVANCIA_002 = 1;

UPDATE AA79B02T00 SET PAL_HORA_CONCOR_100_002 = 1200.00, PAL_SEG_CONCOR_100_002 = 2.500 WHERE NIVEL_USUARIO_002 = 'N' AND ID_TIPO_RELEVANCIA_002 = 2;

UPDATE AA79B02T00 SET PAL_HORA_CONCOR_100_002 = 1800.00, PAL_SEG_CONCOR_100_002 = 2.000 WHERE NIVEL_USUARIO_002 = 'N' AND ID_TIPO_RELEVANCIA_002 = 3;

UPDATE AA79B02T00 SET PAL_HORA_CONCOR_100_002 = 0, PAL_SEG_CONCOR_100_002 = 0 WHERE NIVEL_USUARIO_002 = 'N' AND ID_TIPO_RELEVANCIA_002 not in(1,2,3);

ALTER TABLE AA79B02T00 MODIFY PAL_HORA_CONCOR_100_002 NOT NULL;
ALTER TABLE AA79B02T00 MODIFY PAL_SEG_CONCOR_100_002 NOT NULL;


--En la tabla AA79B45T00.

ALTER TABLE AA79B45T00 RENAME COLUMN PAL_HORA_CONCOR_95_100_045 TO PAL_HORA_CONCOR_95_99_045; 

ALTER TABLE AA79B45T00 ADD PAL_HORA_CONCOR_100_045 NUMBER(6,2) NULL;


ALTER TABLE AA79B45T00 RENAME COLUMN PAL_SEG_CONCOR_95_100_045 TO PAL_SEG_CONCOR_95_99_045; 

ALTER TABLE AA79B45T00 ADD PAL_SEG_CONCOR_100_045 NUMBER(6,3) NULL;

--Actualizamos/insertamos los valores correspondientes para los nuevos campos:

UPDATE AA79B45T00 SET PAL_HORA_CONCOR_100_045 = PAL_HORA_CONCOR_95_99_045, PAL_SEG_CONCOR_100_045 = PAL_SEG_CONCOR_95_99_045;

ALTER TABLE AA79B45T00 MODIFY PAL_HORA_CONCOR_100_045 NOT NULL;
ALTER TABLE AA79B45T00 MODIFY PAL_SEG_CONCOR_100_045 NOT NULL;

--Tabla AA79B90T00

ALTER TABLE AA79B90T00 ADD NUM_PAL_CONCOR_95_99_090 NUMBER(6) NULL;
ALTER TABLE AA79B90T00 ADD NUM_PAL_CONCOR_100_090 NUMBER(6) NULL;

COMMENT ON COLUMN AA79B90T00.NUM_PAL_CONCOR_95_99_090 IS 'Num de palabras con concordancia de 95 a 99% extraido del fichero de trados. Desglose Perfect Match.';
COMMENT ON COLUMN AA79B90T00.NUM_PAL_CONCOR_100_090 IS 'Num de palabras con concordancia de 100% extraido del fichero de trados. Desglose Perfect Match.';

UPDATE AA79B90T00 SET NUM_PAL_CONCOR_95_99_090 = NUM_PAL_CONCOR_95_100_090, NUM_PAL_CONCOR_100_090 = 0;

ALTER TABLE AA79B90T00 MODIFY NUM_PAL_CONCOR_95_99_090 NOT NULL;
ALTER TABLE AA79B90T00 MODIFY NUM_PAL_CONCOR_100_090 NOT NULL;

--Tabla AA79B91T00

ALTER TABLE AA79B91T00 ADD NUM_PAL_CONCOR_95_99_091 NUMBER(6) NULL;
ALTER TABLE AA79B91T00 ADD NUM_PAL_CONCOR_100_091 NUMBER(6) NULL;

COMMENT ON COLUMN AA79B91T00.NUM_PAL_CONCOR_95_99_091 IS ' Num de palabras para el documento con concordancia de 95 a 99% extraido del fichero de trados. Desglose Perfect Match.';
COMMENT ON COLUMN AA79B91T00.NUM_PAL_CONCOR_100_091 IS 'Num de palabras para el documento con concordancia de 100% extraido del fichero de trados. Desglose Perfect Match.';

UPDATE AA79B91T00 SET NUM_PAL_CONCOR_95_99_091 = NUM_PAL_CONCOR_95_100_091, NUM_PAL_CONCOR_100_091 = 0;

ALTER TABLE AA79B91T00 MODIFY NUM_PAL_CONCOR_95_99_091 NOT NULL;
ALTER TABLE AA79B91T00 MODIFY NUM_PAL_CONCOR_100_091 NOT NULL;


--Modificar la tabla AA79B56T00 para poder contemplar los nuevos rangos, pero en este caso vamos a mantener los anteriores.

ALTER TABLE AA79B56T00 ADD NUM_PAL_CONCOR_95_99_056 NUMBER(6) NULL;
ALTER TABLE AA79B56T00 ADD NUM_PAL_CONCOR_100_056 NUMBER(6) NULL;

COMMENT ON COLUMN AA79B56T00.NUM_PAL_CONCOR_95_99_056 IS ' Num de palabras para el documento con concordancia de 95 a 99% extraido del fichero de trados. Desglose Perfect Match.';
COMMENT ON COLUMN AA79B56T00.NUM_PAL_CONCOR_100_056 IS 'Num de palabras para el documento con concordancia de 100% extraido del fichero de trados. Desglose Perfect Match.';

UPDATE AA79B56T00 SET NUM_PAL_CONCOR_95_99_056 = NUM_PAL_CONCOR_95_100_056, NUM_PAL_CONCOR_100_056 = 0 WHERE NUM_PAL_CONCOR_95_100_056 IS NOT NULL;

@@&DIR_SCRIPTS/Vistas/informes/INF_SITUACION_TRAD_REV.sql;
@@&DIR_SCRIPTS/Functions/OBTENER_ESTUDIO.SQL;
@@&DIR_SCRIPTS/Functions/CALCULO_HORAS_TRADUCCION.SQL;

DELETE AA79B62T00;  

DELETE AA79B19T00;  

DROP SEQUENCE AA79B19Q00;
CREATE SEQUENCE  AA79B19Q00  MINVALUE 1 MAXVALUE 9999999999 INCREMENT BY 1 START WITH 1 NOCACHE  ORDER  NOCYCLE  NOPARTITION ;

COMMIT;
/
EXIT;