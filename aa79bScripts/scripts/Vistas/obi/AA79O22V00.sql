CREATE OR REPLACE VIEW AA79O22V00 AS
    SELECT DISTINCT NVL(DNI_RECURSO_081, TPROV.CIF) COD_INTERP_TRADUC
         , CASE WHEN DNI_RECURSO_081 IS NOT NULL THEN 0 ELSE 1 END COD_TIPO_INTERP_TRADUC
         , CASE WHEN DNI_RECURSO_081 IS NOT NULL THEN NOMBRE_077 || ' ' || APEL1_077 || ' ' || APEL2_077 || ' - ' || PREDNI_077 || DNI_077 || SUFDNI_077
                WHEN ID_LOTE_081 IS NOT NULL THEN TPROV.DESC_EU || ' - ' || TPROV.CIF ELSE NULL END DESC_INTERPRETE_TRADUC
      FROM AA79B81T00
      JOIN AA79B82T00 ON ID_TAREA_082 = ID_TAREA_081
      JOIN AA79B51T00 ON ANYO_051 = ANYO_081 AND NUM_EXP_051 = NUM_EXP_081 AND ANYO_051 >= 2019
      JOIN AA79B59T00 ON ANYO_059 = ANYO_051 AND NUM_EXP_059 = NUM_EXP_051 AND ID_ESTADO_BITACORA_059 = ESTADO_BITACORA_051
      LEFT JOIN AA79B77T00 ON DNI_RECURSO_081 = DNI_077
      LEFT JOIN AA79B29T00 ON ID_LOTE_081 = ID_LOTE_029
      LEFT JOIN X54JAPI_EMPRESAS_PROV TPROV ON ID_EMPRESA_PROV_029 = TPROV.CODIGO AND TIPO_ENTIDAD_029 = TPROV.TIPO
     WHERE ID_ESTADO_EXP_059 IN (4, 5, 6, 7)
       AND NVL(DNI_RECURSO_081, TPROV.CIF) IS NOT NULL;
     