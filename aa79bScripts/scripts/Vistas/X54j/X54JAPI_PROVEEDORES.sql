CREATE OR REPLACE VIEW X54JAPI_PROVEEDORES AS 
SELECT TIPIDEN_044 AS TIPIDEN
, PREDNI_044 AS PREDNI
, DNI_044 AS DNI
, SUFDNI_044 AS SUFDNI
, NOMBRE_044 AS NOMBRE
, APEL1_044 AS APEL1
, APEL2_044 AS APEL2
, ESTADO_044 AS ESTADO
, ITIPENT_044 AS TIPO_ENTIDAD
, ENTDPTO_044 AS COD_ENTIDAD
, DENTIC_044 AS DESC_ES
, DENTIE_044 AS DESC_EU
, DECODE(ITIPENT_044, 'B', CIF_001, 'E', CIF_023, 'L', CIF_037) AS CIF
, FACTURABLE_036 AS FACTURABLE
, IVA_036 AS IVA
, CDIRNORA_044 AS CDIRNORA
, TRADUCTOR
, INTERPRETE
FROM X54J44T00
JOIN (SELECT DNI_042
    , MAX(DECODE(CPER_043, 1, 'S', 'N')) AS TRADUCTOR
		, MAX(DECODE(CPER_043, 2, 'S', 'N')) AS INTERPRETE
		FROM X54J42T00
    JOIN X54J43T00 ON DNI_043 = DNI_042 AND CAPLIC_043 = CAPLIC_042 AND CROL_043 = CROL_042
		WHERE CAPLIC_042 = 7
		AND CROL_042 = 3
		GROUP BY DNI_042) ON DNI_044 = DNI_042
LEFT JOIN X54J01T00 ON ITIPENT_044 = 'B' AND ENTDPTO_044 = CENTIDAD_001
LEFT JOIN X54J23T00 ON ITIPENT_044 = 'E' AND ENTDPTO_044 = CDEPARTAMENTOS_023 
LEFT JOIN X54J37T00 ON ITIPENT_044 = 'L' AND ENTDPTO_044 = CEMPRESA_037
LEFT JOIN X54J36T00 ON CAPLIC_036 = CAPLIC_044 AND ITIPENT_036 = ITIPENT_044 AND CODENT_036 = ENTDPTO_044
WHERE CAPLIC_044 = 7
AND ESTADO_044='V';
/
