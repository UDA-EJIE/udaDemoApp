DEFINE DIR_SCRIPTS = '/aplic/aa79b/scripts';

-- ELIMINAMOS LAS FILAS DE LA TABLA 03 PARA ANYADIR UNA COLUMNA
DELETE FROM AA79B03T00;
-- RENOMBRAR LA COLUMNA PAL_PRESUPUESTO_TRADOS_003 A PAL_PRESUPUESTO_003
ALTER TABLE AA79B03T00
RENAME COLUMN "PAL_PRESUPUESTO_TRADOS_003" TO "PAL_PRESUPUESTO_003";
COMMENT ON COLUMN AA79B03T00.PAL_PRESUPUESTO_003 IS 'Número palabras para solicitar presupuesto';
-- CREAR UNA NUEVA COLUMNA PAL _TRADOS_003 
ALTER TABLE AA79B03T00
ADD "PAL_TRADOS_003" NUMBER(6) NOT NULL ;
COMMENT ON COLUMN AA79B03T00.PAL_TRADOS_003 IS 'Número palabras para requerir proyecto Trados';
-- CARGAMOS LA TABLA 03 CON SU VALOR INICIAL
INSERT INTO AA79B03T00 (ID_003, PAL_PRESUPUESTO_003,PAL_TRADOS_003, POR_DESVIACION_PAL_003) 
VALUES (0,1000,1000,10);
--
-- COLUMNA IND_BOPV_026 NO SE USA MAS, PERO SE PONE A VALOR 'N' POR SI TOCA VOLVER EN ALGUN MOMENTO
UPDATE AA79B26T00
SET IND_BOPV_026 = 'N';
--
-- ELIMINAMOS LAS FILAS DE LA TABLA 02 PARA MODIFICARLA
DELETE FROM AA79B02T00;
-- ANYADIMOS COLUMNAS
ALTER TABLE AA79B02T00
ADD (PAL_SEG_CONCOR_95_100_002 NUMBER(6,3) NOT NULL,
     PAL_SEG_CONCOR_85_94_002 NUMBER(6,3) NOT NULL,
     PAL_SEG_CONCOR_0_84_002 NUMBER(6,3) NOT NULL,
     PAL_TRAD_SEG_002 NUMBER(6,3) NOT NULL,
     PAL_REV_SEG_002 NUMBER(6,3) NOT NULL,
     NIVEL_USUARIO_002 VARCHAR2(1) NOT NULL,
     ID_TIPO_RELEVANCIA_002 NUMBER(2) NOT NULL);
-- EDITAMOS COLUMNAS
ALTER TABLE AA79B02T00 MODIFY PAL_TRAD_HORA_002 NUMBER(6,2);
ALTER TABLE AA79B02T00 MODIFY PAL_HORA_CONCOR_95_100_002 NUMBER(6,2);
ALTER TABLE AA79B02T00 MODIFY PAL_HORA_CONCOR_85_94_002 NUMBER(6,2);
ALTER TABLE AA79B02T00 MODIFY PAL_HORA_CONCOR_0_84_002 NUMBER(6,2);
ALTER TABLE AA79B02T00 MODIFY PAL_REV_HORA_002 NUMBER(6,2);
-- ELIMINAMOS LA COLUMNA
ALTER TABLE AA79B02T00 
DROP COLUMN LIM_PAL_CONCOR_002;
-- CREAMOS LA TABLA AA79B02T01
CREATE TABLE AA79B02T01 (
    ID_002 NUMBER(1) NOT NULL,
    LIM_PAL_CONCOR_002 NUMBER(6) NOT NULL
)TABLESPACE  AA7901E00;
-- ANYADIMOS LA CLAVE PRIMARIA A LA NUEVA TABLA
ALTER TABLE AA79B02T01
ADD CONSTRAINT PK_AA79B02T01 PRIMARY KEY (ID_002);
/
-- CREAMOS EL SINONIMO DE LA TABLA NUEVA
CREATE OR REPLACE SYNONYM AA79B02S02 FOR AA79B02T01;    
/
-- ELIMINAMOS LA CLAVE PRIMARIA DE LA TABLA 02 Y CREAMOS UNA QUE TENGA 3  COLUMNAS COMO CLAVE PRIMARIA
ALTER TABLE  AA79B02T00
DROP PRIMARY KEY;
ALTER TABLE AA79B02T00
ADD CONSTRAINT PK_AA79B02T00 PRIMARY KEY (ID_002, NIVEL_USUARIO_002, ID_TIPO_RELEVANCIA_002);
-- HACEMOS UNA CARGA INICIAL PARA LAS TABLAS AA79B02T00 Y AA79B02T01
INSERT INTO AA79B02T00 (ID_002, PAL_TRAD_HORA_002,PAL_HORA_CONCOR_95_100_002,
    PAL_HORA_CONCOR_85_94_002, PAL_HORA_CONCOR_0_84_002, PAL_REV_HORA_002,
    PAL_SEG_CONCOR_95_100_002,PAL_SEG_CONCOR_85_94_002,PAL_SEG_CONCOR_0_84_002,
    PAL_TRAD_SEG_002,PAL_REV_SEG_002,NIVEL_USUARIO_002,ID_TIPO_RELEVANCIA_002) 
VALUES (0,514.00,100.00,100.00,100.00,514.00,36.000,36.000,36.000,7.000,7.000,'V',1);
INSERT INTO AA79B02T00 (ID_002, PAL_TRAD_HORA_002,PAL_HORA_CONCOR_95_100_002,
    PAL_HORA_CONCOR_85_94_002, PAL_HORA_CONCOR_0_84_002, PAL_REV_HORA_002,
    PAL_SEG_CONCOR_95_100_002,PAL_SEG_CONCOR_85_94_002,PAL_SEG_CONCOR_0_84_002,
    PAL_TRAD_SEG_002,PAL_REV_SEG_002,NIVEL_USUARIO_002,ID_TIPO_RELEVANCIA_002) 
VALUES (0,514.00,100.00,100.00,100.00,514.00,36.000,36.000,36.000,7.000,7.000,'V',2);
INSERT INTO AA79B02T00 (ID_002, PAL_TRAD_HORA_002,PAL_HORA_CONCOR_95_100_002,
    PAL_HORA_CONCOR_85_94_002, PAL_HORA_CONCOR_0_84_002, PAL_REV_HORA_002,
    PAL_SEG_CONCOR_95_100_002,PAL_SEG_CONCOR_85_94_002,PAL_SEG_CONCOR_0_84_002,
    PAL_TRAD_SEG_002,PAL_REV_SEG_002,NIVEL_USUARIO_002,ID_TIPO_RELEVANCIA_002) 
VALUES (0,514.00,100.00,100.00,100.00,514.00,36.000,36.000,36.000,7.000,7.000,'V',3);
INSERT INTO AA79B02T00 (ID_002, PAL_TRAD_HORA_002,PAL_HORA_CONCOR_95_100_002,
    PAL_HORA_CONCOR_85_94_002, PAL_HORA_CONCOR_0_84_002, PAL_REV_HORA_002,
    PAL_SEG_CONCOR_95_100_002,PAL_SEG_CONCOR_85_94_002,PAL_SEG_CONCOR_0_84_002,
    PAL_TRAD_SEG_002,PAL_REV_SEG_002,NIVEL_USUARIO_002,ID_TIPO_RELEVANCIA_002) 
VALUES (0,514.00,100.00,100.00,100.00,514.00,36.000,36.000,36.000,7.000,7.000,'N',1);
INSERT INTO AA79B02T00 (ID_002, PAL_TRAD_HORA_002,PAL_HORA_CONCOR_95_100_002,
    PAL_HORA_CONCOR_85_94_002, PAL_HORA_CONCOR_0_84_002, PAL_REV_HORA_002,
    PAL_SEG_CONCOR_95_100_002,PAL_SEG_CONCOR_85_94_002,PAL_SEG_CONCOR_0_84_002,
    PAL_TRAD_SEG_002,PAL_REV_SEG_002,NIVEL_USUARIO_002,ID_TIPO_RELEVANCIA_002) 
VALUES (0,514.00,100.00,100.00,100.00,514.00,36.000,36.000,36.000,7.000,7.000,'N',2);
INSERT INTO AA79B02T00 (ID_002, PAL_TRAD_HORA_002,PAL_HORA_CONCOR_95_100_002,
    PAL_HORA_CONCOR_85_94_002, PAL_HORA_CONCOR_0_84_002, PAL_REV_HORA_002,
    PAL_SEG_CONCOR_95_100_002,PAL_SEG_CONCOR_85_94_002,PAL_SEG_CONCOR_0_84_002,
    PAL_TRAD_SEG_002,PAL_REV_SEG_002,NIVEL_USUARIO_002,ID_TIPO_RELEVANCIA_002) 
VALUES (0,514.00,100.00,100.00,100.00,514.00,36.000,36.000,36.000,7.000,7.000,'N',3);
INSERT INTO AA79B02T01 (ID_002,LIM_PAL_CONCOR_002)
VALUES(0,1000);

-- ELIMINAMOS LAS FILAS DE LA TABLA 45 PARA MODIFICARLA
DELETE FROM AA79B45T00;
-- ANYADIMOS COLUMNAS
ALTER TABLE AA79B45T00
ADD (PAL_SEG_CONCOR_95_100_045 NUMBER(6,3) NOT NULL,
     PAL_SEG_CONCOR_85_94_045 NUMBER(6,3) NOT NULL,
     PAL_SEG_CONCOR_0_84_045 NUMBER(6,3) NOT NULL,
     PAL_TRAD_SEG_045 NUMBER(6,3) NOT NULL,
     PAL_REV_SEG_045 NUMBER(6,3) NOT NULL,
     NIVEL_USUARIO_045 VARCHAR2(1) NOT NULL);
-- EDITAMOS COLUMNAS
ALTER TABLE AA79B45T00 MODIFY PAL_TRAD_HORA_045 NUMBER(6,2);
ALTER TABLE AA79B45T00 MODIFY PAL_HORA_CONCOR_95_100_045 NUMBER(6,2);
ALTER TABLE AA79B45T00 MODIFY PAL_HORA_CONCOR_85_94_045 NUMBER(6,2);
ALTER TABLE AA79B45T00 MODIFY PAL_HORA_CONCOR_0_84_045 NUMBER(6,2);
ALTER TABLE AA79B45T00 MODIFY PAL_REV_HORA_045 NUMBER(6,2);
-- ELIMINAMOS LA COLUMNA
ALTER TABLE AA79B45T00 
DROP COLUMN LIM_PAL_CONCOR_045;
-- CREAMOS LA TABLA AA79B02T01
CREATE TABLE AA79B45T01 (
    ID_045 NUMBER(1) NOT NULL,
    LIM_PAL_CONCOR_045 NUMBER(6) NOT NULL
)TABLESPACE  AA7901E00;
-- ANYADIMOS LA CLAVE PRIMARIA A LA NUEVA TABLA
ALTER TABLE AA79B45T01
ADD CONSTRAINT PK_AA79B45T01 PRIMARY KEY (ID_045);
/
-- CREAMOS EL SINONIMO DE LA TABLA NUEVA
CREATE OR REPLACE SYNONYM AA79B45S02 FOR AA79B45T01; 
/
-- ELIMINAMOS LA CLAVE PRIMARIA DE LA TABLA 45 Y CREAMOS UNA QUE TENGA 2  COLUMNAS COMO CLAVE PRIMARIA
ALTER TABLE  AA79B45T00
DROP PRIMARY KEY;
ALTER TABLE AA79B45T00
ADD CONSTRAINT PK_AA79B45T00 PRIMARY KEY (ID_045, NIVEL_USUARIO_045);
-- HACEMOS UNA CARGA INICIAL PARA LAS TABLAS AA79B45T00 Y AA79B45T01
INSERT INTO AA79B45T00 (ID_045, PAL_TRAD_HORA_045,PAL_HORA_CONCOR_95_100_045,
    PAL_HORA_CONCOR_85_94_045, PAL_HORA_CONCOR_0_84_045, PAL_REV_HORA_045,
    PAL_SEG_CONCOR_95_100_045, PAL_SEG_CONCOR_85_94_045, PAL_SEG_CONCOR_0_84_045,
    PAL_TRAD_SEG_045, PAL_REV_SEG_045, NIVEL_USUARIO_045) 
VALUES (0,1200.00,100.00,100.00,100.00,1200.00,36.000,36.000,36.000,.3000,3.000,'V');
INSERT INTO AA79B45T00 (ID_045, PAL_TRAD_HORA_045,PAL_HORA_CONCOR_95_100_045,
    PAL_HORA_CONCOR_85_94_045, PAL_HORA_CONCOR_0_84_045, PAL_REV_HORA_045,
    PAL_SEG_CONCOR_95_100_045, PAL_SEG_CONCOR_85_94_045, PAL_SEG_CONCOR_0_84_045,
    PAL_TRAD_SEG_045, PAL_REV_SEG_045, NIVEL_USUARIO_045) 
VALUES (0,1200.00,100.00,100.00,100.00,1200.00,36.000,36.000,36.000,3.000,3.000,'N');
INSERT INTO AA79B45T01 (ID_045,LIM_PAL_CONCOR_045)
VALUES(0,1000);

-- ANYADIMOS COLUMNAS A AA79B56T00
ALTER TABLE AA79B56T00
ADD (NUM_PAL_CONCOR_0_84_056 NUMBER(6) NULL,
	NUM_PAL_CONCOR_85_94_056 NUMBER(6) NULL,
	NUM_PAL_CONCOR_95_100_056 NUMBER(6) NULL);

-- LANZAR EL PL CREAR_TAREAS_EXPEDIENTE
@@&DIR_SCRIPTS/Functions/CREAR_TAREAS_EXPEDIENTE.SQL;
-- LANZAR EL PL OBTENER_GRUPO_TRABAJO
@@&DIR_SCRIPTS/Functions/OBTENER_GRUPO_TRABAJO.SQL;
-- LANZAR EL PL OBTENER_ESTUDIO
@@&DIR_SCRIPTS/Functions/OBTENER_ESTUDIO.SQL;
-- LANZAR EL PL CALCULAR_FECHA_FIN_TAREA
@@&DIR_SCRIPTS/Functions/CALCULAR_FECHA_FIN_TAREA.SQL;
-- LANZAR EL PL COSTE_EXPEDIENTE_LOTE
@@&DIR_SCRIPTS/Functions/COSTE_EXPEDIENTE_LOTE.SQL;
-- LANZAR EL PL IMPORTE_PREVISTO_LOTE
@@&DIR_SCRIPTS/Functions/IMPORTE_PREVISTO_LOTE.SQL;
-- LANZAR EL PL CREAR_TAREAS_RELACIONADAS
@@&DIR_SCRIPTS/Procedures/CREAR_TAREAS_RELACIONADAS.SQL;
-- LANZAR EL PL CREAR_TAREAS_DEFECTO
@@&DIR_SCRIPTS/Procedures/CREAR_TAREAS_DEFECTO.SQL;
-- LANZAR EL PL INF_SITUACION_TRAD_REV
@@&DIR_SCRIPTS/Vistas/informes/INF_SITUACION_TRAD_REV.sql;
-- LANZAR EL PL CALCULO_HORAS_TRADUCCION
@@&DIR_SCRIPTS/Functions/CALCULO_HORAS_TRADUCCION.SQL
-- LANZAR EL PL ACT_DATOS_PAGO_PROV
@@&DIR_SCRIPTS/Procedures/ACT_DATOS_PAGO_PROV.SQL;

-- AA79BB5T00
CREATE TABLE AA79BB5T00 (
              	ID_0B5 NUMBER(2,0),
              	NIVEL_0B5 NUMBER(2,0),
            	RANGO_INI_CALIDAD_0B5 NUMBER(2,0),
            	RANGO_FIN_CALIDAD_0B5 NUMBER(2,0),
            	POR_PENALIZACION_0B5 NUMBER(3,0),
            	ESTADO_0B5 VARCHAR2(1)
)TABLESPACE  AA7901E00;
/
ALTER TABLE AA79BB5T00 ADD CONSTRAINT PK_AA79BB5T00 PRIMARY KEY (ID_0B5);
ALTER INDEX PK_AA79BB5T00 REBUILD TABLESPACE AA7902E00;

COMMENT ON TABLE AA79BB5T00 IS 'Niveles de calildad';
COMMENT ON COLUMN AA79BB5T00.ID_0B5 IS 'Id nivel de calidad';
COMMENT ON COLUMN AA79BB5T00.NIVEL_0B5 IS 'Nivel de calidad';
COMMENT ON COLUMN AA79BB5T00.RANGO_INI_CALIDAD_0B5 IS 'Rango inicial';
COMMENT ON COLUMN AA79BB5T00.RANGO_FIN_CALIDAD_0B5 IS 'Rango final';
COMMENT ON COLUMN AA79BB5T00.POR_PENALIZACION_0B5 IS 'Porcentage de penalizacion';
COMMENT ON COLUMN AA79BB5T00.ESTADO_0B5 IS 'Estado';
-- CREAMOS EL SINONIMO DE LA TABLA AA79BB5T00
CREATE OR REPLACE SYNONYM AA79BB5S01 FOR AA79BB5T00; 

CREATE SEQUENCE AA79B.AA79BB5Q00 MINVALUE 1 MAXVALUE 9999999999 INCREMENT BY 1 START WITH 1 NOCACHE ORDER;

-- CARGA INICIAL AA79BB5T00
INSERT INTO  AA79BB5T00 (ID_0B5, NIVEL_0B5, RANGO_INI_CALIDAD_0B5, RANGO_FIN_CALIDAD_0B5, POR_PENALIZACION_0B5, ESTADO_0B5)
VALUES (1, 5, 12, 20, 0, 'A');
INSERT INTO  AA79BB5T00 (ID_0B5, NIVEL_0B5, RANGO_INI_CALIDAD_0B5, RANGO_FIN_CALIDAD_0B5, POR_PENALIZACION_0B5, ESTADO_0B5)
VALUES (2, 4, 10, 12, 10, 'A');
INSERT INTO  AA79BB5T00 (ID_0B5, NIVEL_0B5, RANGO_INI_CALIDAD_0B5, RANGO_FIN_CALIDAD_0B5, POR_PENALIZACION_0B5, ESTADO_0B5)
VALUES (3, 3, 8, 10, 20, 'A');
INSERT INTO  AA79BB5T00 (ID_0B5, NIVEL_0B5, RANGO_INI_CALIDAD_0B5, RANGO_FIN_CALIDAD_0B5, POR_PENALIZACION_0B5, ESTADO_0B5)
VALUES (4, 2, 6, 8, 30, 'A');
INSERT INTO  AA79BB5T00 (ID_0B5, NIVEL_0B5, RANGO_INI_CALIDAD_0B5, RANGO_FIN_CALIDAD_0B5, POR_PENALIZACION_0B5, ESTADO_0B5)
VALUES (5, 1, 4, 6, 50, 'A');
INSERT INTO  AA79BB5T00 (ID_0B5, NIVEL_0B5, RANGO_INI_CALIDAD_0B5, RANGO_FIN_CALIDAD_0B5, POR_PENALIZACION_0B5, ESTADO_0B5)
VALUES (6, 0, 0, 4, 100, 'A');
/
exit;