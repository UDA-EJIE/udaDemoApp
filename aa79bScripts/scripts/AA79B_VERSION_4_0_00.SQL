DEFINE DIR_SCRIPTS = '/aplic/aa79b/scripts';

@@&DIR_SCRIPTS/Functions/DIAS_ENTRE_FECHAS_ATENCION.SQL;
@@&DIR_SCRIPTS/Functions/DIAS_ENTRE_FECHAS_CALENDAR.SQL;
@@&DIR_SCRIPTS/Functions/HORAS_ENTRE_FECHAS_ATENCION.SQL;


CREATE TABLE AA79BB7T00
(
	TIPO_ENTIDAD_B7 VARCHAR2(1)
	, ID_ENTIDAD_B7 NUMBER(7) NULL
	, TIPO_B7 NUMBER(1) NULL
	, CONSTRAINT PK_AA79BB7T00 PRIMARY KEY (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7)
)TABLESPACE  AA7901E00;

COMMENT ON TABLE AA79BB7T00 IS 'Tipo solicitante';
COMMENT ON COLUMN AA79BB7T00.TIPO_ENTIDAD_B7 IS 'Tipo de la entidad';
COMMENT ON COLUMN AA79BB7T00.ID_ENTIDAD_B7 IS 'ID de la entidad';
COMMENT ON COLUMN AA79BB7T00.TIPO_B7 IS 'Tipo del solicitante';

INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 568, 3); --Muface
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 567, 3); --Agencia Estatal Boletín Oficial Del Estado
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 254, 4); --Arabako Biltzar Nagusiak/Juntas Generales De Álava
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 272, 4); --Bilbao Bizkaia Ur Partzuergoa/Consorcio De Aguas Bilbao Bizkaia
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 292, 4); --Eudel/Eudel
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 226, 4); --Gasteizko Udala/Ayuntamiento De Vitoria-Gasteiz
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 309, 4); --Bizkaiko Batzar Nagusiak/Juntas Generales De Bizkaia
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 249, 4); --Arabako Foru Aldundia/Diputación Local De Álava
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 521, 4); --Arrasateko Udala
INSERT INTO AA79BB7T00 (TIPO_ENTIDAD_B7, ID_ENTIDAD_B7, TIPO_B7) VALUES ('B', 247, 4); --Bizkaiko Foru Aldundia/Diputación Local De Bizkaia

--Crear tabla R75b
CREATE TABLE R75O30T00
(
	ANYO                 NUMBER(4) NOT NULL
  , NUM_EXP              NUMBER(6) NOT NULL
  , MES                  NUMBER(12)
  , QUINCENA             NUMBER(1)
  , DIA                  NUMBER(1)
  , ESTADO               NUMBER(2)
  , TIPO_EXP             VARCHAR2(1)
  , EXP_CORREDACCION     NUMBER(1)
  , ABANDONADO           NUMBER(1)
  , TIPO_SOLICITANTE     NUMBER(1)
  , SOLICITANTE          VARCHAR2(10)
  , PUBLICACION          NUMBER(1)
  , TIPO_TRADUCTOR       NUMBER(1)
  , TIPO_REVISOR         NUMBER(1)
  , TIPO_INTERPRETE      NUMBER(1)
  , TIPO_INTERPRETACION  NUMBER(1)
  , TIPO_DOCUMENTO       NUMBER(1)
  , PLAZO                NUMBER(1)
  , NUM_PALABRAS         NUMBER(8)
  , TIPO_PROYECTO        NUMBER(1)
  , SUBCONTRATADO        NUMBER(1)
  , MAS_1_INTERPRETE     NUMBER(1)
  , PORCEN_EUSKERA       NUMBER(3)
  , TIPO_DOCUMENTAL      NUMBER(3)
  , TIPO_ANULACION       NUMBER(3)
  , TIPO_RECHAZO         NUMBER(3)
  , FACTURABLE           NUMBER(1)
  , MARCA_PRISA          NUMBER(1)
  , RECARGO              NUMBER(1)
  , IDIOMA               NUMBER(1)
  , PRESUPUESTO          NUMBER(1)
  , DIAS_TRABAJO         NUMBER(6)
  , HORAS_TRABAJO        NUMBER(8,2)
  , TIEMPO_PREVISTO      NUMBER(8,2)
  , TIEMPO_REALIZACION   NUMBER(8,2)
  , DIAS_RETRASO         NUMBER(6)
  , DIAS_DURACION        NUMBER(6)
  , HORAS_DURACION       NUMBER(8,2)
)TABLESPACE  AA7901E00;


CREATE TABLE R75O36T00
(
	T36_COD_TIPO_DOCUMENTO NUMBER(3)
  , T36_DESC_TIPO_DOCUMENTO_C VARCHAR2(50)
  , T36_DESC_TIPO_DOCUMENTO_E VARCHAR2(50)
) TABLESPACE AA7901E00;

INSERT INTO R75O36T00 (T36_COD_TIPO_DOCUMENTO, T36_DESC_TIPO_DOCUMENTO_C, T36_DESC_TIPO_DOCUMENTO_E)
SELECT T36_COD_TIPO_DOCUMENTO + 900, T36_DESC_TIPO_DOCUMENTO_C, T36_DESC_TIPO_DOCUMENTO_E FROM R75B.R7536T00
WHERE T36_COD_TIPO_DOCUMENTO IN (6, 11, 15, 20, 21, 22, 23, 36, 37, 43, 48, 69, 70);
--Crear tabla de equivalencias de tipos

@@&DIR_SCRIPTS/Vistas/obi/R75O30V00.sql;
--Cargar tabla R75b
INSERT INTO R75O30T00 (ANYO, NUM_EXP, MES, QUINCENA
     , DIA, ESTADO, TIPO_EXP, EXP_CORREDACCION, ABANDONADO
	 , TIPO_SOLICITANTE, SOLICITANTE, PUBLICACION, TIPO_TRADUCTOR, TIPO_REVISOR, TIPO_INTERPRETE
	 , TIPO_INTERPRETACION, TIPO_DOCUMENTO, PLAZO, NUM_PALABRAS, TIPO_PROYECTO
	 , SUBCONTRATADO, MAS_1_INTERPRETE, PORCEN_EUSKERA, TIPO_DOCUMENTAL, TIPO_ANULACION
	 , TIPO_RECHAZO, FACTURABLE, MARCA_PRISA, RECARGO, IDIOMA
	 , PRESUPUESTO, DIAS_TRABAJO, HORAS_TRABAJO, TIEMPO_PREVISTO, TIEMPO_REALIZACION
	 , DIAS_RETRASO, DIAS_DURACION, HORAS_DURACION)
SELECT ANYO, NUM_EXP, MES, QUINCENA
     , DIA, ESTADO, TIPO_EXP, EXP_CORREDACCION, ABANDONADO
	 , TIPO_SOLICITANTE, SOLICITANTE, PUBLICACION, TIPO_TRADUCTOR, TIPO_REVISOR, TIPO_INTERPRETE
	 , TIPO_INTERPRETACION, TIPO_DOCUMENTO, PLAZO, NUM_PALABRAS, TIPO_PROYECTO
	 , SUBCONTRATADO, MAS_1_INTERPRETE, PORCEN_EUSKERA, TIPO_DOCUMENTAL, TIPO_ANULACION
	 , TIPO_RECHAZO, FACTURABLE, MARCA_PRISA, RECARGO, IDIOMA
	 , PRESUPUESTO, DIAS_TRABAJO, HORAS_TRABAJO, TIEMPO_PREVISTO, TIEMPO_REALIZACION
	 , DIAS_RETRASO, DIAS_DURACION, HORAS_DURACION
FROM R75O30V00;

@@&DIR_SCRIPTS/Vistas/obi/AA79O01V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O02V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O03V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O04V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O05V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O06V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O07V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O08V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O09V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O10V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O11V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O12V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O13V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O14V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O15V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O16V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O17V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O18V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O19V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O20V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O21V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O22V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O23V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O24V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O25V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O26V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O27V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O51V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/AA79O81V00.sql;
@@&DIR_SCRIPTS/Vistas/obi/IDABA.sql;

EXIT;