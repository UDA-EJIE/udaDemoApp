CREATE OR REPLACE PROCEDURE  CARGAR_CALENDARIO_SERVICIO(
   ANYO IN   NUMBER
)
IS


FESTIVO DATE;

AUX_DATE VARCHAR(10);
AUX_ID_DATE NUMBER(8);

BEGIN
   	-- insertamos el rango de jornada intensiva
    INSERT INTO AA79B22S01 (ANYO_CALENDARIO_022,VERANO_DESDE_022,VERANO_HASTA_022) 
    SELECT ANYO, TO_DATE(TO_CHAR(ANYO)|| LPAD(TO_CHAR(MES_DESDE_047), 2, '0') || LPAD(TO_CHAR(DIA_DESDE_047), 2, '0'), 'yyyymmdd'), TO_DATE(TO_CHAR(ANYO)||LPAD(TO_CHAR(MES_HASTA_047), 2, '0') || LPAD(TO_CHAR(DIA_HASTA_047), 2, '0'), 'yyyymmdd') FROM AA79B47S01 WHERE ID_047=0;
	--insertamos los festivos
	INSERT INTO AA79B23S01 (ANYO_CALENDARIO_023,ID_DIA_CALENDARIO_023,DIA_CALENDARIO_023) 
    SELECT ANYO,TO_NUMBER(TO_CHAR(ANYO)|| LPAD(TO_CHAR(MES_046), 2, '0') || LPAD(TO_CHAR(DIA_046), 2, '0')), TO_DATE(TO_CHAR(ANYO)|| LPAD(TO_CHAR(MES_046), 2, '0') || LPAD(TO_CHAR(DIA_046), 2, '0'), 'yyyymmdd') FROM AA79B46S01;
EXCEPTION
   WHEN OTHERS
   THEN
      NULL;
END;
/