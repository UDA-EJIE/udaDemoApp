CREATE OR REPLACE FUNCTION OBTENER_ESTADO_SOLICITANTE ( ESTADO IN   NUMBER, FASE IN NUMBER) RETURN NUMBER IS

ESTADO_SOLIC NUMBER(1);

-- ESTADOS Y FASES AA06
ESTADO_SOLIC_PENDIENTE_ESTUDIO NUMBER(1):=1;
ESTADO_SOLIC_ESTUDIO NUMBER(1):=2;
ESTADO_SOLIC_PDTE_TRAM_CLIENTE NUMBER(1):=3;
ESTADO_SOLIC_EN_CURSO NUMBER(1):=4;
ESTADO_SOLIC_CERRADO NUMBER(1):=5;
ESTADO_SOLIC_FINALIZADO NUMBER(1):=6;
ESTADO_SOLIC_RECHAZADO NUMBER(1):=7;
ESTADO_SOLIC_ANULADO NUMBER(1):=8;

-- ESTADO Y FASES ITZULNET
ESTADO_EN_ESTUDIO NUMBER(3):= 2;
FASE_PDTE_ESTUDIO NUMBER(3):= 2;
FASE_ESTUDIO NUMBER(3):= 3;
FASE_PDTE_TRAM_SUBS NUMBER(3):= 4;

ESTADO_EN_CURSO NUMBER(3):= 3;
FASE_PDTE_TRAM NUMBER(3):= 8;

ESTADO_RECHAZADO NUMBER(3):= 4;

ESTADO_ANULADO NUMBER(3):=5;

ESTADO_CERRADO NUMBER(3):= 6;

ESTADO_FINALIZADO NUMBER(3):= 7;

BEGIN	
	
	IF (ESTADO = ESTADO_EN_ESTUDIO) THEN
		IF (FASE = FASE_PDTE_ESTUDIO) THEN
			ESTADO_SOLIC:= ESTADO_SOLIC_PENDIENTE_ESTUDIO;
		ELSIF (FASE = FASE_ESTUDIO) THEN
			ESTADO_SOLIC:= ESTADO_SOLIC_ESTUDIO;
		ELSIF (FASE = FASE_PDTE_TRAM_SUBS) THEN
			ESTADO_SOLIC:= ESTADO_SOLIC_PDTE_TRAM_CLIENTE;
		END IF;
	ELSIF (ESTADO = ESTADO_EN_CURSO) THEN
		IF (FASE = FASE_PDTE_TRAM) THEN
			ESTADO_SOLIC:= ESTADO_SOLIC_PDTE_TRAM_CLIENTE;
		ELSE
			ESTADO_SOLIC:= ESTADO_SOLIC_EN_CURSO;
		END IF;
	ELSIF (ESTADO = ESTADO_RECHAZADO) THEN
		ESTADO_SOLIC:= ESTADO_SOLIC_RECHAZADO;
	ELSIF (ESTADO = ESTADO_ANULADO) THEN
		ESTADO_SOLIC:= ESTADO_SOLIC_ANULADO;
	ELSIF (ESTADO = ESTADO_CERRADO) THEN
		ESTADO_SOLIC:= ESTADO_SOLIC_CERRADO;
	ELSIF (ESTADO = ESTADO_FINALIZADO) THEN
		ESTADO_SOLIC:= ESTADO_SOLIC_FINALIZADO;
	END IF;
	
	RETURN ESTADO_SOLIC;
END;
/