import"jquery";import"rup.tooltip";import*as testutils from"../common/specCommonUtils.js";import"rup.tooltip";import"rup.date";var unavailableDay=0;function disableDays(e){return[e.getDay()!=unavailableDay,""]}function langStr(e){return"["+e+"] "}function testDate(e){describe("Test Date > ",(()=>{var t,a,r;beforeAll((e=>{testutils.loadCss(e)})),beforeEach((s=>{$("#content").append('<div class="form-groupMaterial col-sm">\t\t\t\t\t\t\t<input id="exampleDate"></input>\t\t\t\t\t\t\t<label for="exampleDate">Fecha</label>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="form-groupMaterial col-sm">\t\t\t            \t<input id="altDate"></input>\t\t\t\t\t\t\t<label for="exampleDate">Fecha</label>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="form-groupMaterial col-sm">\t\t\t\t\t\t\t<input id="multiDate"></input>\t\t\t\t\t\t\t<label for="exampleDate">Fecha</label>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="form-groupMaterial col-sm">\t\t\t\t\t\t\t<input id="desde"></input>\t\t\t\t\t\t\t<label for="exampleDate">Fecha</label>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="form-groupMaterial col-sm">\t\t\t\t\t\t\t<input id="hasta"></input>\t\t\t\t\t\t\t<label for="exampleDate">Fecha</label>\t\t\t\t\t\t</div>');let i={create:()=>{$("#exampleDate").addClass("randomClass")},autoSize:!0,placeholderMask:!0,showButtonPanel:!0,showOtherMonths:!0,noWeekend:!1,beforeShowDay:disableDays},d={datetimepicker:!0,changeMonth:!1,changeYear:!1,showWeek:!0,beforeShowDay:disableDays},o={multiSelect:3,beforeShowDay:disableDays},l={from:"desde",to:"hasta",beforeShowDay:disableDays};$.rup.setLiterals(e).then((()=>{$("#exampleDate").rup_date(i),$("#altDate").rup_date(d),$("#multiDate").rup_date(o),$.rup_date(l),t=$("#exampleDate"),a=$("#altDate"),r=$("#multiDate"),s()}))})),afterEach((()=>{$(".hasDatepicker").each(((e,t)=>{$(t).rup_date("destroy")})),$("#content").html(""),$("#content").nextAll().remove()})),afterAll((()=>{$.rup.setLiterals("es")})),describe("Creación > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{t.rup_date("show")})),it(langStr(e)+"Debe tener la clase del datepicker",(()=>{expect(t.hasClass("hasDatepicker")).toBeTruthy()})),it(langStr(e)+"Debe crear un botón",(()=>{expect($("button.ui-datepicker-trigger",t.parent()).length).toBe(1)})),it(langStr(e)+"Debe tener los select para cambiar mes y año:",(()=>{expect($("select",$(".ui-datepicker-title")).length).toBe(2)})),it(langStr(e)+" Debe ejecutarse el callback del create:",(()=>{expect(t.hasClass("randomClass")).toBe(!0)}))})),describe("Date alternativo > ",(()=>{beforeEach((()=>{a.rup_date("show")})),it(langStr(e)+"Debe tener la clase del datepicker",(()=>{expect(a.hasClass("hasDatepicker")).toBeTruthy()})),it(langStr(e)+"Debe crear un timepicker:",(()=>{expect($("#ui-datepicker-div").length).toBe(1)})),it(langStr(e)+"No debe tener los select para cambiar mes y año:",(()=>{expect($("select",$(".ui-datepicker-title")).length).toBe(0)}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{r.rup_date("show")})),it(langStr(e)+"Debe tener la clase del datepicker",(()=>{expect(r.hasClass("hasDatepicker")).toBe(!0)})),it(langStr(e)+"Debe crearse un botón:",(()=>{expect($("button.ui-datepicker-trigger",r.parent()).length).toBe(1)})),it(langStr(e)+"Debe tener los select para cambiar mes y año:",(()=>{expect($("select",$(".ui-datepicker-title")).length).toBe(2)}))})),describe("Date desde-hasta",(()=>{it(langStr(e)+"Deben tener la clase del datepicker",(()=>{expect($("#desde").hasClass("hasDatepicker")).toBeTruthy(),expect($("#hasta").hasClass("hasDatepicker")).toBeTruthy()}))}))})),describe("Métodos públicos > ",(()=>{describe("Métodos setRupValue y getRupValue > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{"es"===e&&t.rup_date("setRupValue","08/10/2018 00:00"),"eu"===e&&t.rup_date("setRupValue","2018/10/08 00:00")})),it(langStr(e)+"Debe actualizar el valor:",(()=>{"es"===e&&expect(t.rup_date("getRupValue")).toBe("08/10/2018"),"eu"===e&&expect(t.rup_date("getRupValue")).toBe("2018/10/08")}))})),describe("Date alternativo > ",(()=>{beforeEach((()=>{"es"===e&&a.rup_date("setRupValue","08/10/2018 00:00"),"eu"===e&&a.rup_date("setRupValue","2018/10/08 00:00")})),it(langStr(e)+"Debe actualizar el valor:",(()=>{"es"===e&&expect(a.rup_date("getRupValue")).toBe("08/10/2018 00:00"),"eu"===e&&expect(a.rup_date("getRupValue")).toBe("2018/10/08 00:00")}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{"es"===e&&r.rup_date("setRupValue",["08/10/2018","09/10/2018"]),"eu"===e&&r.rup_date("setRupValue",["2018/10/08","2018/10/09"])})),it(langStr(e)+"Debe actualizar el valor:",(()=>{"es"===e&&expect(r.rup_date("getRupValue")).toBe("08/10/2018, 09/10/2018"),"eu"===e&&expect(r.rup_date("getRupValue")).toBe("2018/10/08, 2018/10/09")}))})),describe("Date desde-hasta > ",(()=>{beforeEach((()=>{"es"===e&&($("#desde").rup_date("setRupValue","03/08/2018"),$("#hasta").rup_date("setRupValue","28/08/2018")),"eu"===e&&($("#desde").rup_date("setRupValue","2018/08/03"),$("#hasta").rup_date("setRupValue","2018/08/28"))})),describe("Se comprueba que los cambios aparecen en getRupValue > ",(()=>{it(langStr(e)+"getRupValue desde:",(()=>{"es"===e&&expect($("#desde").rup_date("getRupValue")).toBe("03/08/2018"),"eu"===e&&expect($("#desde").rup_date("getRupValue")).toBe("2018/08/03")})),it(langStr(e)+"getRupValue hasta:",(()=>{"es"===e&&expect($("#hasta").rup_date("getRupValue")).toBe("28/08/2018"),"eu"===e&&expect($("#hasta").rup_date("getRupValue")).toBe("2018/08/28")}))})),describe("Se comprueba la funcionalidad propia del desde-hasta > ",(()=>{it(langStr(e)+"En desde los valores mas allá de hasta deben estar deshabilitados:",(()=>{$("#desde").rup_date("show");let e=$("#ui-datepicker-div > table > tbody > tr > td");expect($("span:contains(29)",e).parent().hasClass("ui-datepicker-unselectable ui-state-disabled")).toBe(!0),expect($("span:contains(30)",e).parent().hasClass("ui-datepicker-unselectable ui-state-disabled")).toBe(!0),expect($("span:contains(31)",e).parent().hasClass("ui-datepicker-unselectable ui-state-disabled")).toBe(!0)})),it(langStr(e)+"En hasta los valores antes de desde deben estar deshabilitados:",(()=>{$("#hasta").rup_date("show");let e=$("#ui-datepicker-div > table > tbody > tr > td");expect($("span:contains(1)",e).parent().hasClass("ui-datepicker-unselectable ui-state-disabled")).toBe(!0),expect($("span:contains(2)",e).parent().hasClass("ui-datepicker-unselectable ui-state-disabled")).toBe(!0)}))}))}))})),describe("Método show > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{t.rup_date("show")})),it(langStr(e)+"Debe mostrarse el datepicker:",(()=>{expect($("#ui-datepicker-div").is(":visible")).toBe(!0)})),it(langStr(e)+"Debe tener los select para cambiar mes y año:",(()=>{expect($("select",$(".ui-datepicker-title")).length).toBe(2)}))})),describe("Date alternativa > ",(()=>{beforeEach((()=>{a.rup_date("show")})),it(langStr(e)+"Debe mostrarse el datepicker:",(()=>{expect($("#ui-datepicker-div").is(":visible")).toBe(!0)})),it(langStr(e)+"No debe tener los select para cambiar mes y año:",(()=>{expect($("select",$(".ui-datepicker-title")).length).toBe(0)}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{r.rup_date("show")})),it(langStr(e)+"Debe mostrarse el datepicker:",(()=>{expect($("#ui-datepicker-div").is(":visible")).toBe(!0)})),it(langStr(e)+"Debe tener los select para cambiar mes y año:",(()=>{expect($("select",$(".ui-datepicker-title")).length).toBe(2)}))})),describe("Date desde-hasta > ",(()=>{describe("Date desde > ",(()=>{beforeEach((()=>{$("#desde").rup_date("show")})),it(langStr(e)+"Debe mostrarse:",(()=>{expect($("#ui-datepicker-div").is(":visible")).toBe(!0)}))})),describe("Date hasta > ",(()=>{beforeEach((()=>{$("#hasta").rup_date("show")})),it(langStr(e)+"Debe mostrarse:",(()=>{expect($("#ui-datepicker-div").is(":visible")).toBe(!0)}))}))}))})),describe("Método hide > ",(()=>{describe("Date normal > ",(()=>{beforeEach((e=>{t.rup_date("show"),t.rup_date("hide"),setTimeout((()=>{e()}),1e3)})),it(langStr(e)+"No debe mostrarse el datepicker:",(()=>{let e=0!=$("#ui-datepicker-div").css("opacity"),t=$("#ui-datepicker-div").is(":visible");expect(e&&t).toBe(!1)}))})),describe("Date alternativa > ",(()=>{beforeEach((e=>{a.rup_date("show"),a.rup_date("hide"),setTimeout((()=>{e()}),1e3)})),it(langStr(e)+"No debe mostrarse el datepicker:",(()=>{let e=0!=$("#ui-datepicker-div").css("opacity"),t=$("#ui-datepicker-div").is(":visible");expect(e&&t).toBe(!1)}))})),describe("Date múltiple > ",(()=>{beforeEach((e=>{r.rup_date("show"),r.rup_date("hide"),setTimeout((()=>{e()}),1e3)})),it(langStr(e)+"No debe mostrarse el datepicker:",(()=>{let e=0!=$("#ui-datepicker-div").css("opacity"),t=$("#ui-datepicker-div").is(":visible");expect(e&&t).toBe(!1)}))})),describe("Date desde-hasta > ",(()=>{describe("Date desde > ",(()=>{beforeEach((e=>{$("#desde").rup_date("show"),$("#desde").rup_date("hide"),setTimeout((()=>{e()}),1e3)})),it(langStr(e)+"No debe mostrarse:",(()=>{let e=0!=$("#ui-datepicker-div").css("opacity"),t=$("#ui-datepicker-div").is(":visible");expect(e&&t).toBe(!1)}))})),describe("Date hasta > ",(()=>{beforeEach((e=>{$("#hasta").rup_date("show"),$("#hasta").rup_date("hide"),setTimeout((()=>{e()}),1e3)})),it(langStr(e)+"No debe mostrarse:",(()=>{let e=0!=$("#ui-datepicker-div").css("opacity"),t=$("#ui-datepicker-div").is(":visible");expect(e&&t).toBe(!1)}))}))}))})),describe("Métodos setDate y getDate > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{"es"===e&&t.rup_date("setDate","06/02/1995"),"eu"===e&&t.rup_date("setDate","1995/02/06")})),it(langStr(e)+"Debe cambiar en la UI:",(()=>{"es"===e&&expect(t.val()).toBe("06/02/1995"),"eu"===e&&expect(t.val()).toBe("1995/02/06")})),it(langStr(e)+"Debe reflejarse en el método getDate:",(()=>{"es"===e&&expect(t.rup_date("getDate")).toBe("06/02/1995"),"eu"===e&&expect(t.rup_date("getDate")).toBe("1995/02/06")}))})),describe("Date alternativa > ",(()=>{beforeEach((()=>{"es"===e&&a.rup_date("setDate","06/02/1995"),"eu"===e&&a.rup_date("setDate","1995/02/06")})),it(langStr(e)+"Debe cambiar en la UI:",(()=>{"es"===e&&expect(a.val()).toBe("06/02/1995 00:00"),"eu"===e&&expect(a.val()).toBe("1995/02/06 00:00")})),it(langStr(e)+"Debe reflejarse en el método getDate:",(()=>{"es"===e&&expect(a.rup_date("getDate")).toBe("06/02/1995 00:00"),"eu"===e&&expect(a.rup_date("getDate")).toBe("1995/02/06 00:00")}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{"es"===e&&r.rup_date("setDate","06/02/1995"),"eu"===e&&r.rup_date("setDate","1995/02/06")})),it(langStr(e)+"Debe modificar la UI:",(()=>{"es"===e&&expect(r.val()).toBe("06/02/1995"),"eu"===e&&expect(r.val()).toBe("1995/02/06")}))})),describe("Date desde-hasta",(()=>{beforeEach((()=>{"es"===e&&($("#desde").rup_date("setDate","03/08/2018"),$("#hasta").rup_date("setDate","28/08/2018")),"eu"===e&&($("#desde").rup_date("setDate","2018/08/03"),$("#hasta").rup_date("setDate","2018/08/28"))})),it(langStr(e)+"Debe actualizar la ui:",(()=>{"es"===e&&(expect($("#desde").val()).toBe("03/08/2018"),expect($("#hasta").val()).toBe("28/08/2018")),"eu"===e&&(expect($("#desde").val()).toBe("2018/08/03"),expect($("#hasta").val()).toBe("2018/08/28"))}))}))})),describe("Método refresh > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{"es"===e&&t.rup_date("setDate"),unavailableDay=3,t.rup_date("refresh")})),it(langStr(e)+"comprobamos que los miércoles se hayan deshabilitado:",(()=>{$("#ui-datepicker-div > table > tbody > tr").each(((e,t)=>{$("td",$(t)).eq(2).each(((e,t)=>{expect($(t).hasClass("ui-datepicker-unselectable")&&$(t).hasClass("ui-state-disabled")).toBe(!0)}))}))}))}))})),describe("Método option > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{t.rup_date("option","currentText","FooText"),t.rup_date("option",{minDate:"01/01/1900",maxDate:"01/01/2200"})})),it(langStr(e)+"Debe cambiar el valor:",(()=>{expect(t.rup_date("option","currentText")).toBe("FooText"),expect(t.rup_date("option","minDate")).toBe("01/01/1900"),expect(t.rup_date("option","maxDate")).toBe("01/01/2200")}))})),describe("Date alternativa > ",(()=>{beforeEach((()=>{a.rup_date("option","currentText","FooText"),a.rup_date("option",{minDate:"01/01/1900",maxDate:"01/01/2200"})})),it(langStr(e)+"Debe cambiar el valor:",(()=>{expect(a.rup_date("option","currentText")).toBe("FooText"),expect(a.rup_date("option","minDate")).toBe("01/01/1900"),expect(a.rup_date("option","maxDate")).toBe("01/01/2200")}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{r.rup_date("option","currentText","FooText"),r.rup_date("option",{minDate:"01/01/1900",maxDate:"01/01/2200"})})),it(langStr(e)+"Debe cambiar el valor:",(()=>{expect(r.rup_date("option","currentText")).toBe("FooText"),expect(r.rup_date("option","minDate")).toBe("01/01/1900"),expect(r.rup_date("option","maxDate")).toBe("01/01/2200")}))})),describe("Date desde-hasta > ",(()=>{describe("Date desde > ",(()=>{beforeEach((()=>{$("#desde").rup_date("option","currentText","FooText"),$("#desde").rup_date("option",{minDate:"01/01/1900",maxDate:"01/01/2200"})})),it(langStr(e)+"Debe cambiar el valor:",(()=>{expect($("#desde").rup_date("option","currentText")).toBe("FooText"),expect($("#desde").rup_date("option","minDate")).toBe("01/01/1900"),expect($("#desde").rup_date("option","maxDate")).toBe("01/01/2200")}))})),describe("Date hasta > ",(()=>{beforeEach((()=>{$("#hasta").rup_date("option","currentText","FooText"),$("#hasta").rup_date("option",{minDate:"01/01/1900",maxDate:"01/01/2200"})})),it(langStr(e)+"Debe cambiar el valor:",(()=>{expect($("#hasta").rup_date("option","currentText")).toBe("FooText"),expect($("#hasta").rup_date("option","minDate")).toBe("01/01/1900"),expect($("#hasta").rup_date("option","maxDate")).toBe("01/01/2200")}))}))}))})),describe("Método disable e isDisabled > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{t.rup_date("disable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect(t.attr("readonly")).toBe("readonly")})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect(t.rup_date("isDisabled")).toBe(!0)}))})),describe("Date alternativa > ",(()=>{beforeEach((()=>{a.rup_date("disable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect(a.attr("readonly")).toBe("readonly")})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect(a.rup_date("isDisabled")).toBe(!0)}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{r.rup_date("disable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect(r.attr("readonly")).toBe("readonly")})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect(r.rup_date("isDisabled")).toBe(!0)}))})),describe("Date desde-hasta > ",(()=>{beforeEach((()=>{$("#desde").rup_date("disable"),$("#hasta").rup_date("disable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect($("#desde").attr("readonly")).toBe("readonly"),expect($("#hasta").attr("readonly")).toBe("readonly")})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect($("#desde").rup_date("isDisabled")).toBe(!0),expect($("#hasta").rup_date("isDisabled")).toBe(!0)}))}))})),describe("Método enable e isDisabled > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{t.rup_date("disable"),t.rup_date("enable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect(t.attr("disabled")).toBe(void 0)})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect(t.rup_date("isDisabled")).toBe(!1)}))})),describe("Date alternativa > ",(()=>{beforeEach((()=>{a.rup_date("disable"),a.rup_date("enable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect(a.attr("disabled")).toBe(void 0)})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect(a.rup_date("isDisabled")).toBe(!1)}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{r.rup_date("disable"),r.rup_date("enable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect(r.attr("disabled")).toBe(void 0)})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect(r.rup_date("isDisabled")).toBe(!1)}))})),describe("Date desde-hasta > ",(()=>{beforeEach((()=>{$("#desde").rup_date("disable"),$("#hasta").rup_date("disable"),$("#desde").rup_date("enable"),$("#hasta").rup_date("enable")})),it(langStr(e)+"Debe marcarse como deshabilitada",(()=>{expect($("#desde").attr("disabled")).toBe(void 0),expect($("#hasta").attr("disabled")).toBe(void 0)})),it(langStr(e)+"Debe reflejarse en isDisabled:",(()=>{expect($("#desde").rup_date("isDisabled")).toBe(!1),expect($("#hasta").rup_date("isDisabled")).toBe(!1)}))}))})),describe("Método destroy > ",(()=>{describe("Date normal > ",(()=>{beforeEach((()=>{t.rup_date("destroy")})),it(langStr(e)+"Debe retirarse elementos:",(()=>{expect($("button",t.parent()).length).toBe(0)}))})),describe("Date alternativa > ",(()=>{beforeEach((()=>{a.rup_date("destroy")})),it(langStr(e)+"Debe retirarse elementos:",(()=>{expect($("button",a.parent()).length).toBe(0)}))})),describe("Date múltiple > ",(()=>{beforeEach((()=>{r.rup_date("destroy")})),it(langStr(e)+"Debe retirarse elementos:",(()=>{expect($("button",r.parent()).length).toBe(0)}))})),describe("Date desde-hasta > ",(()=>{beforeEach((()=>{$("#desde").rup_date("destroy"),$("#hasta").rup_date("destroy")})),it(langStr(e)+"Debe retirarse elementos:",(()=>{expect($("button",$("#desde").parent()).length).toBe(0),expect($("button",$("#hasta").parent()).length).toBe(0)}))}))}))}))}))}testDate("es"),testDate("eu");