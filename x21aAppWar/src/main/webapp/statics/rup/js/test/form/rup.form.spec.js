import"jquery";import*as testutils from"../common/specCommonUtils.js";import"jasmine-jquery";import"rup.select";import"rup.feedback";import"rup.form";const formHtml='<div id="feedbackMensajes"></div>                <div id="tabsFormulario"></div>                <div id="divformHttpSubmit">                <form name = "exampleForm" id ="exampleForm">                    <input type="text" value="txt1" name="input1" id="input1"></input>                    <input type="text" value="txt2" name="input2" id="input2"></input>                    <select name="input3" id="input3">                        <option value="opt1">Opcion 1</input>                        <option value="opt2">Opcion 2</input>                    </select>                </form>                <form id="formHttpSubmit" action="'+testutils.DEMO+'/nora" >                <fieldset class="alumnoFieldset">                    <legend>Datos personales</legend>                    <div class="two-col" >                            <div class="col1">                            <label for="nombre" class="label">Nombre</label>                                <input type="text" name="nombre" class="formulario_linea_input" size="20" id="nombre" value="pop" />                            </div>                            <div class="col1">                                <label for="apellido1" class="label">Primer apellido</label>                                <input type="text" name="apellido1" class="formulario_linea_input" size="30" id="apellido1" />                            </div>                            <div class="col1">                                <label for="apellido2" class="label">Segundo apellido</label>                                <input type="text" name="apellido2" class="formulario_linea_input" size="30" id="apellido2" />                            </div>                    </div>                    <div class="two-col" >                        <div class="col1">                        <label for="sexo" class="label">Sexo</label>                            <select name="sexo" class="formulario_linea_input" id="sexo" ></select>                        </div>                        <div class="col1">                            <label for="fechaNacimiento" class="label">Fecha de nacimiento</label>                            <input type="text" name="fechaNacimiento" class="formulario_linea_input" id="fechaNacimiento" />                        </div>                        <div class="col1">                            <label for="telefono" class="label">Telefono</label>                            <input type="text" name="telefono" class="formulario_linea_input" id="telefono" />                        </div>                    </div>                    <div class="two-col" >                        <div class="col1">                        <label for="dni" class="label">DNI</label>                            <input type="text" name="dni" class="formulario_linea_input" id="dni" />                        </div>                    </div>                </fieldset>                <fieldset class="alumnoFieldset">                    <legend>Datos cuenta usuario</legend>                    <div class="two-col">                        <div class="col1">                        <label for="usuario" class="label">Usuario</label>                            <input type="text" name="usuario" class="formulario_linea_input" id="usuario" />                        </div>                        <div class="col1">                            <div>                        <label for="password" class="label">Contrase&ntilde;a</label>                            <input type="password" name="password" class="formulario_linea_input" id="password" />                            </div>                            <div>                            <label for="password_confirm" class="label">Confirmar contrase&ntilde;a</label>                            <input type="password" name="password_confirm" class="formulario_linea_input" id="password_confirm" />                            </div>                        </div>                        <div class="col1">                        <div>                        <label for="email" class="label">Email</label>                            <input type="text" name="email" class="formulario_linea_input" id="email" />                        </div>                        <div>                            <label for="email_confirm" class="label">Confirmar email</label>                            <input type="text" name="email_confirm" class="formulario_linea_input" id="email_confirm" />                        </div>                        </div>                    </div>\t\t\t\t</fieldset>                <fieldset class="alumnoFieldset">                    <legend>Datos domicilio</legend>                    <div class="two-col">                        <div class="col1">                        <label for="pais" class="label">País</label>                        <select path="pais.id" class="formulario_linea_input" id="pais" >                            </select>                        </div>                        <div class="col1">                        <label for="autonomia" class="label">Autonomía</label>                        <select path="autonomia.id" class="formulario_linea_input" id="autonomia" >                            </select>                        </div>                        <div class="col1">                        <label for="provincia" class="label">Provincia</label>                            <input type="text" name="provincia.id" class="formulario_linea_input" id="provincia" />                        </div>                    </div>                    <div class="two-col">                        <div class="col1">                        <label for="municipio" class="label">Municipio</label>                            <select name="municipio.id" class="formulario_linea_input" id="municipio" ></select>                        </div>                        <div class="col1">                        <label for="calle" class="label">Calle</label>                            <select name="calle.id" class="formulario_linea_input" id="calle" ></select>                        </div>                    </div>                </fieldset>                <input type="submit" value="Enviar" />                </form>';function configurar(){$("#feedbackMensajes").rup_feedback({type:"ok",closeLink:!0,delay:1e3,fadeSpeed:500,block:!0}),$("#sexo").rup_select({data:[{i18nCaption:"masculino",id:"M"},{i18nCaption:"femenino",id:"F"}],i18nId:"sexo"});let e=[{i18nCaption:"ab",id:"ab_value"},{i18nCaption:"tc",id:"tc_value"},{i18nCaption:"ud",id:"ud_value"},{i18nCaption:"le",id:"le_value"},{i18nCaption:"af",id:"af_value"},{i18nCaption:"mg",id:"mg_value"},{i18nCaption:"ah",id:"ah_value"},{i18nCaption:"ui",id:"ui_value"},{i18nCaption:"uj",id:"uj_value"},{i18nCaption:"ak",id:"ak_value"}];$("#municipio").rup_select({data:e,sourceParam:{text:"dsO",id:"id"},minLength:4}),$("#calle").rup_select({data:e,sourceParam:{text:"dsO",id:"id"},minLength:4})}describe("Test Form",(()=>{var e,i;beforeAll((e=>{testutils.loadCss(e)})),beforeEach((o=>{var l=formHtml;$("#content").append(l),configurar();var a={url:testutils.DEMO+"/nora",type:"POST",feedback:$("#feedbackMensajes"),success:function(e){$("#feedback").rup_feedback("set",$.rup_utils.printMsg(jQuery.toJSON(e)),"ok")},validate:{rules:{nombre:{required:!0}}}};$("#exampleForm").rup_form({}),$("#formHttpSubmit").rup_form(a),e=$("#exampleForm"),i=$("#formHttpSubmit"),setTimeout((()=>{o()}),100)})),afterEach((()=>{$("#content").html(""),$("#content").nextAll().remove()})),describe("Creación > ",(()=>{describe("Form por defecto > ",(()=>{it("Debe tener la clase de rup_form",(()=>{expect(e).toHaveClass("rup_form")}))})),describe("Form alternativo > ",(()=>{it("Debe tener clases por defecto:",(()=>{expect(i).toHaveClass("rup_form rup_validate")}))}))})),describe("Integracion con validate y feedback > ",(()=>{beforeEach((()=>{$("#nombre").val(""),$('input[type="submit"]').trigger("click")})),it("Debe mostrarse el feedback con el contenido:",(()=>{expect($("#feedbackMensajes_content").text().toUpperCase()).toBe("SE HAN PRODUCIDO LOS SIGUIENTES ERRORES:NOMBRE:CAMPO OBLIGATORIO.")}))})),describe("Métodos públicos >",(()=>{describe("Métodos de envío de formulario >",(()=>{describe("Método ajaxSubmit >",(()=>{var e;beforeEach((o=>{e=void 0,i.rup_form("ajaxSubmit",{url:testutils.DEMO+"/nora",type:"POST",success:()=>{},error:()=>{},complete:i=>{e=i,o()}})})),it("La llamada debe tener éxito:",(i=>{expect(e.status).toBe(200),i()}))})),describe("Método ajaxFormSubmit >",(()=>{var e;beforeEach((o=>{e=void 0,i.rup_form("ajaxFormSubmit",{url:testutils.DEMO+"/nora",type:"POST",success:()=>{},error:()=>{},complete:i=>{e=i,o()}})})),it("La llamada debe tener éxito:",(i=>{expect(e.status).toBe(200),i()}))}))})),describe("Método formSerialize >",(()=>{describe("Form por defecto > ",(()=>{it("Debe devolver un string con los datos",(()=>{expect(e.rup_form("formSerialize")).toBe("input1=txt1&input2=txt2&input3=opt1")}))})),describe("Form alternativo > ",(()=>{it("Debe devolver un string con los datos",(()=>{expect(i.rup_form("formSerialize")).toBe("nombre=pop&apellido1=&apellido2=&sexo=M&fechaNacimiento=&telefono=&dni=&usuario=&password=&password_confirm=&email=&email_confirm=&provincia.id=&municipio.id=ab_value&calle.id=ab_value")}))}))})),describe("Método fieldSerialize >",(()=>{describe("Form por defecto > ",(()=>{it("Debe devolver un string con los datos de los fields",(()=>{expect($("input",e).rup_form("fieldSerialize")).toBe("input1=txt1&input2=txt2")}))})),describe("Form alternativo > ",(()=>{it("Debe devolver un string con los datos de los fields:",(()=>{expect($("input, select",i).rup_form("fieldSerialize")).toBe("nombre=pop&apellido1=&apellido2=&sexo=M&fechaNacimiento=&telefono=&dni=&usuario=&password=&password_confirm=&email=&email_confirm=&provincia.id=&municipio.id=ab_value&calle.id=ab_value")}))}))})),describe("Método fieldValue",(()=>{describe("Form por defecto > ",(()=>{it("Debe devolver los valores en un array",(()=>{expect($("input",e).rup_form("fieldValue").join()).toBe("txt1,txt2")}))})),describe("Form alternativo > ",(()=>{it("Debe devolver los valores en un array",(()=>{expect($("input, select",i).rup_form("fieldValue")).toEqual(["pop","","","M","","","","","","","","","","ab_value","ab_value"])}))}))})),describe("Método formToJson",(()=>{describe("Form por defecto > ",(()=>{it("Debe devolver los datos en un string en formato Json",(()=>{expect(e.rup_form("formToJson")).toEqual({input1:"txt1",input2:"txt2",input3:"opt1"})}))})),describe("Form alternativo > ",(()=>{it("Debe devolver los datos rellenados en formato JSON:",(()=>{expect(i.rup_form("formToJson")).toEqual({nombre:"pop",sexo:"M",municipio:{id:"ab_value"},calle:{id:"ab_value"}})}))}))})),describe("Método clearForm > ",(()=>{describe("Form por defecto > ",(()=>{beforeEach((()=>{e.rup_form("clearForm")})),it("Debe haber limpiado todos los campos:",(()=>{expect($("#input1").val()).toBe(""),expect($("#input2").val()).toBe(""),expect($("#input3").val()).toBe(null)}))})),describe("Form alternativo > ",(()=>{beforeEach((()=>{$("#nombre").val("NOMBRE"),$("#apellido1").val("APELLIDO1"),$("#apellido2").val("APELLIDO2"),i.rup_form("clearForm")})),it("Debe haber limpiado todos los campos:",(()=>{expect($("#nombre").val()).toBe(""),expect($("#apellido1").val()).toBe(""),expect($("#apellido2").val()).toBe("")}))}))})),describe("Método resetForm > ",(()=>{describe("Form por defecto > ",(()=>{beforeEach((()=>{e.rup_form("clearForm"),e.rup_form("resetForm")})),it("Debe tener los valores originales:",(()=>{expect($("#input1").val()).toBe("txt1"),expect($("#input2").val()).toBe("txt2"),expect($("#input3").val()).toBe("opt1")}))})),describe("Form alternativo > ",(()=>{beforeEach((()=>{$("#nombre").val("NOMBRE"),$("#apellido1").val("APELLIDO1"),$("#apellido2").val("APELLIDO2"),i.rup_form("resetForm")})),it("Debe quedar en su estado original > ",(()=>{expect($("#nombre").val()).toBe("pop"),expect($("#apellido1").val()).toBe(""),expect($("#apellido2").val()).toBe("")}))}))})),describe("Método clearFields > ",(()=>{describe("Form por defecto > ",(()=>{beforeEach((()=>{$("input",e).rup_form("clearFields")})),it("Deben quedar en blanco unicamente los indicados por el selector:",(()=>{expect($("#input1").val()).toBe(""),expect($("#input2").val()).toBe(""),expect($("#input3").val()).toBe("opt1")}))})),describe("Form alternativo > ",(()=>{beforeEach((()=>{$("#nombre").val("NOMBRE"),$("#apellido1").val("APELLIDO1"),$("#apellido2").val("APELLIDO2"),$("input#apellido2",i).rup_form("clearFields")})),it("Deben quedar en blanco unicamente los indicados por el selector:",(()=>{expect($("#nombre").val()).toBe("NOMBRE"),expect($("#apellido1").val()).toBe("APELLIDO1"),expect($("#apellido2").val()).toBe("")}))}))}))}))}));