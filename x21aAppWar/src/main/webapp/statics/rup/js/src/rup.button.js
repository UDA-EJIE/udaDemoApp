/*! For license information please see rup.button.js.LICENSE.txt */
!function(o){"function"==typeof define&&define.amd?define(["jquery","./rup.base","./rup.dialog"],o):o(jQuery)}((function(o){o.extend(o.rup.iniRup,o.rup.rupSelectorObjectConstructor("rup_button",{})),o.fn.rup_button("extend",{addButtonToDropdown:function(){}}),o.fn.rup_button("extend",{_doDropdownListById:function(o,t,n){var d=jQuery("#"+n.dropdownListId);n.$dropdownList=d,t.append(d),o.on("click.rup_dopdown",(function(o){d.toggleClass("open"),o.stopPropagation()})),d.on("click.rup_dopdown",(function(o){o.stopPropagation()})),jQuery(document).on("click.rup_dopdown.close",(function(){d.removeClass("open")}))},_doDropdownByDialog:function(o,t,n){var d=jQuery("#"+n.dropdownDialog).rup_dialog(n.dropdownDialogConfig);jQuery.extend(n.dropdownDialogConfig,{autoOpen:!1,position:{my:"right top",at:"right bottom",of:t}}),d.parent().addClass("rup-dropdown-dialog"),o.on("click",(function(){d.rup_dialog("open")}))},_doDropdownByButtons:function(t,n,d){var r,a=o("<ul>"),i=d.buttons;a.attr({id:this.attr("id")+"_dropdownList"}).addClass("rup-dropdown-option-list rup-toolbar_menuButtonContainer");for(var e=0;e<i.length;e++)r=o("<li>"),this._addButtonToDropdown(r,i[e]),a.append(r);t.on("click.rup_dopdown",(function(o){a.toggleClass("open"),o.stopPropagation()})),a.on("click.rup_dropdown",(function(o){o.stopPropagation()})),jQuery(document).on("click.rup_dopdown.close",(function(){a.removeClass("open")})),n.append(a)},_addButtonToDropdown:function(t,n,d){var r,a="";return void 0===n.id?(o.rup.errorGestor(o.rup.i18nParse(o.rup.i18n.base,"rup_button.mbuttonsIdError")),a=null):(0!==(r=n.id).indexOf(o(this).attr("id"))&&(r=o(this).attr("id")+"##"+n.id),a=o("<a></a>").attr("id",r).text(o.rup.i18nParse(d,n.i18nCaption)).addClass("rup-toolbar_button"),void 0===n.css&&(n.css="rup-toolbar_menuButtonIcon"),a.button().button("option","icons",{primary:n.css,secondary:null})),t.append(a),this._setKeyDown(a),n.click&&a.click({i18nCaption:n.i18nCaption},n.click),a},_setKeyDown:function(t){t.on("keydown",(function(t){var n,d=o(t.currentTarget),r=d.parent();if("Tab"===t.code&&!t.shiftKey&&1===(n=d.next().attr("id")!==r.attr("id")+"-rightButtons"?d.next(":focusable"):d.next().children(":focusable").first()).length)return n.focus(),o.rup_toolbar.focusedExternally[r.attr("id")]=!0,!1}))}}),o.fn.rup_button("extend",{_init:function(t){var n=o.extend(!0,{},o.fn.rup_button.defaults,o(this).data(),t[0]);return this.each((function(){var d,r,a=o(this),i={};if(this._ADAPTER=o.rup.adapter[n.adapter],!0===n.fab&&(a.addClass("rup-button-fab"),!0===n.fixed&&a.addClass("rup-button-fixed"),!0===n.fixed&&a.addClass("rup-button-fixed"),null!==n.list||null!==n.layer)){var e=o("<div>").addClass("rup-button-fab-group");a.add(o("#"+o.escapeSelector(n.list))).wrapAll(e),null!==n.list&&(o("#"+o.escapeSelector(n.list)).addClass("rup-button-fab-list"),o("button","#"+o.escapeSelector(n.list)).addClass("rup-button-fab-sm").rup_button()),null!==n.layer&&o("#"+o.escapeSelector(n.layer)).addClass("rup-button-fab-layer")}if(0===a.find(n.labelBaseCss).length&&a.contents().filter((function(){return this.nodeType===Node.TEXT_NODE&&/\S/.test(this.nodeValue)})).wrap(o("<span>").addClass(n.labelBaseCss)),n.labelCss&&a.find("."+n.labelBaseCss).addClass(n.labelCss),n.iconCss&&a.prepend(o("<i>").attr("aria-hidden","true").addClass(n.iconCss)),n.click&&"function"==typeof n.click&&a.on("click",n.click),void 0===n.dropdown||!1===n.dropdown){if(a.button(n),a.addClass("rup-button").removeClass("ui-button ui-corner-all ui-widget"),!0===n.mbutton){var u=a.siblings("[aria-labelledby='"+a.attr("id")+"']");u&&(a.on("click.rup_mbutton",(function(o){u.addClass("rup-mbutton-open"),o.stopPropagation()})),u.on("click.rup_mbutton",(function(o){o.stopPropagation()})),jQuery(document).on("click.rup_mbutton.close",(function(){u.removeClass("rup-mbutton-open")})))}}else{o.extend(!0,i,o.fn.rup_button.dropdown_defaults,t[0].dropdown),a.addClass("rup-button rup-dropdown"),r=jQuery("<div>").attr("class","rup-dropdown-btn-group"),r=a.wrap(r).parent(),i.$container=r,a.button({}),a.addClass("rup-dropdown");var p=this._ADAPTER.createDropdownButton.bind(a)(n);if(a.after(p),i.dropdownListId)d=jQuery("#"+i.dropdownListId),i.$dropdownList=d,r.append(d),p.on("click.rup_dopdown",(function(o){d.toggleClass("open"),o.stopPropagation()})),d.on("click.rup_dopdown",(function(o){o.stopPropagation()})),jQuery(document).on("click.rup_dopdown.close",(function(){d.removeClass("open")}));else if(i.dropdownDialog){jQuery.extend(i.dropdownDialogConfig,{autoOpen:!1,position:{my:"right top",at:"right bottom",of:r}});var s=jQuery("#"+i.dropdownDialog).rup_dialog(i.dropdownDialogConfig);s.parent().addClass("rup-dropdown-dialog"),p.on("click",(function(){s.rup_dialog("open")}))}else i.buttons&&a._doDropdownByButtons(p,r,i)}}))}}),o.fn.rup_button.defaults={adapter:"button_material",dropdown:!1,fab:!1,fixed:!1,list:null,layer:null,iconCss:void 0,labelCss:void 0,mbutton:!1,click:void 0,labelBaseCss:"rup-ui-button-text"},o.fn.rup_button.dropdown_defaults={dropdownListId:void 0,dropdownDialog:void 0,dropdownDialogConfig:{type:o.rup.dialog.DIV}}}));