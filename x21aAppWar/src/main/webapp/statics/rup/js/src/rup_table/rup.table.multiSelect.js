/*! For license information please see rup.table.multiSelect.js.LICENSE.txt */
!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net","../rup.contextMenu","../rup.feedback"],(function(t){return e(t,window,document)})):"object"==typeof exports?module.exports=function(t,l){return t||(t=window),l&&l.fn.dataTable||(l=require("datatables.net")(t,l).$),e(l,t,t.document)}:e(jQuery,window,document)}((function(e,t,l){"use strict";var c=e.fn.dataTable;function i(e){var t=c.multiSelect.classes.checkbox;return e?t.replace(/ /g,"."):t}function n(t,l){var c=t.settings()[0];if(l.ctrlKey){let c=t.cell(e(l.target).closest("td, th")).index().row,i=t.row(c,{selected:!0}).any();t.row(c).multiSelect(!i)}else{let i;i=t.rows({selected:!0}).any()?c.multiselection.selectedRowsPerPage[e.inArray(c.multiselection.lastSelectedId,c.multiselection.selectedIds)].line:e(l.target).closest("tr").index();let n=e(l.target).closest("tr").index(),s=c.multiselection.lastSelectedId;if(f(t),i<n){n++;for(let e=i;e<n;e++)t.row(e).multiSelect()}else if(i>n){n--;for(let e=i;e>n;e--)t.row(e).multiSelect()}else t.row(i).multiSelect(),s=c.multiselection.lastSelectedId;c.multiselection.lastSelectedId=s,c.multiselection.lastSelectedIsRange=!0}}function s(l,c){var i=l.settings()[0],n=l.multiSelect.items();if(t.getSelection){var s=t.getSelection();if((!s.anchorNode||e(s.anchorNode).closest("table")[0]===l.table().node())&&""!==s.toString().trim())return}if(e(c.target).closest("div.dt-container")[0]==l.table().container()){var o=l.cell(e(c.target).closest("td, th"));if(o.any()){var u=e.Event("user-select.dt");if(a(l,u,[n,o,u]),!c.isDefaultPrevented()){var r=o.index(),d=r.row,m=l.row(d,{selected:!0}).any();l.row(d).multiSelect(!m),i._multiSelect_lastCell=r}}}}function a(t,l,c,i){i&&!t.flatten().length||("string"==typeof l&&(l+=".dt"),c.unshift(t),e(t.table().node()).trigger(l,c))}function o(t,l){if("api"!==t.multiSelect.style()&&!1!==t.multiSelect.info()){var c=t.settings()[0],i=c._multiSelect_set.length,n=i||t.rows({selected:!0}).count();t.columns({selected:!0}).count(),t.cells({selected:!0}).count(),"subtractive"===c._multiSelect_mode&&(n=t.page.info().recordsDisplay-i),n=c.multiselection.numSelected;var s=e("#"+c.sTableId+"_wrapper").find("#select_info"),a=e('<span class="select-info"></span>');!function(l,i,n){i=jQuery.rup.i18nTemplate(c.oLanguage,"rup_table.fila");var s=jQuery.rup.i18nTemplate(c.oLanguage,"rup_table.seleccionadas"),a=jQuery.rup.i18nTemplate(c.oLanguage,"rup_table.seleccionada");c.oInit.showMultiSelectedZero?"eu"!==e.rup.lang?l.append(e('<span class="select-item"></span>').append(t.i18n("select.filas",{_:"%d "+i+"s "+s,1:"1 "+i+" "+a},n))):(l.append(e('<span class="select-item"></span>').append(t.i18n("select.filas",{_:a+" %d "+i,0:a+" inongo "+i+"rik",1:a+" "+i+" 1"},n))),l.attr("style","white-space: nowrap;")):"eu"!==e.rup.lang?l.append(e('<span class="select-item"></span>').append(t.i18n("select.filas",{_:"%d "+i+"s "+s,0:"",1:"1 "+i+" "+a},n))):l.append(e('<span class="select-item"></span>').append(t.i18n("select.filas",{_:a+" %d "+i,0:"",1:a+" "+i+" 1"},n)))}(a,"row",n);var o=s.children("span.select-info");o.length&&o.remove(),""!==a.text()&&s.append(a),e("#"+e.escapeSelector(c.sTableId)).triggerHandler("tableMultiSelectionRowNumberUpdate",c)}}function u(e){var t=e.page.info();t.page<t.pages-1&&e.one("draw",(function(){e.row(":first-child").node().focus()})).page("next").draw(!1)}function r(e){e.page.info().page>0&&e.one("draw",(function(){e.row(":last-child").node().focus()})).page("previous").draw(!1)}function d(t,l){var c=0;return e.each(t.rows().nodes().flatten(),(function(e,t){(l&&t.className.indexOf("selected")>=0||!l&&t.className.indexOf("selected")<0)&&c++})),t.rows().nodes().flatten().length===c}function m(t){var l=t.settings()[0];l.multiselection.accion="checkAll",t.rows().multiSelect(),e("#contextMenu1 li.context-menu-icon-check").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(l.sTableId)).prop("checked",!0);var i=t.page()+1,n=jQuery.rup.i18nTemplate(jQuery.rup.i18n.base,"rup_table.selectMsg",'<span class="fw-bold">'+t.rows()[0].length+"</span>",'<span class="fw-bold">'+i+"</span>"),s=l.json.recordsTotal-l.multiselection.selectedIds.length,a=jQuery.rup.i18nTemplate(jQuery.rup.i18n.base,"rup_table.selectRestMsg",s),o="<button id='rup_table_"+t.context[0].sTableId+"_selectAll' class='btn-material btn-material-secondary-low-emphasis'><span>"+a+"</span></button>";(s>0&&!l.multiselection.selectedAll||l.multiselection.selectedAll&&l.multiselection.deselectedIds.length>0)&&(l.oInit.feedback.$feedbackContainer.rup_feedback("set",n+o,"alert"),l.oInit.feedback.type="fijo",e("#"+e.escapeSelector(l.sTableId)).triggerHandler("tableMultiSelectFeedbackSelectAll",l)),e("#"+e.escapeSelector(e(o)[0].id)).on("click",(function(){p(t)})),l.multiselection.lastSelectedId=t.data()[0][l.oInit.primaryKey[0]],c.Api().rupTable.selectPencil(l,0)}function f(t){var l=t.settings()[0];l.multiselection.accion="uncheck",t.rows().deselect(),e("#contextMenu1 li.context-menu-icon-uncheck").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(l.sTableId)).prop("checked",!1);var c=t.page()+1,i=jQuery.rup.i18nTemplate(jQuery.rup.i18n.base,"rup_table.deselectMsg",'<span class="fw-bold">'+t.rows()[0].length+"</span>",'<span class="fw-bold">'+c+"</span>"),n=jQuery.rup.i18nTemplate(jQuery.rup.i18n.base,"rup_table.deselectRestMsg",l.multiselection.numSelected),s="<button id='rup_table_"+t.context[0].sTableId+"_deselectAll' class='btn-material btn-material-secondary-low-emphasis'><span>"+n+"</span></button>";l.multiselection.numSelected>0&&(l.oInit.feedback.$feedbackContainer.rup_feedback("set",i+s,"alert"),l.oInit.feedback.$feedbackContainer.rup_feedback("show"),l.oInit.feedback.$feedbackContainer.type="fijo",e("#"+e.escapeSelector(l.sTableId)).triggerHandler("tableMultiSelectFeedbackDeselectAll",l)),e("#"+e.escapeSelector(e(s)[0].id)).on("click",(function(){h(t)})),e("#"+e.escapeSelector(l.sTableId)+" tbody tr td.select-checkbox i.selected-pencil").remove(),l.multiselection.lastSelectedIsRange=!1}function p(t){var l=t.settings()[0];l.multiselection.selectedAll=!0,l.multiselection.deselectedIds=[],l.multiselection.deselectedRowsPerPage=[],l.multiselection.numSelected=l.json.recordsTotal,l.multiselection.accion="checkAll",e("#contextMenu1 li.context-menu-icon-check_all").addClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-check").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(l.sTableId)).prop("checked",!0),t.rows().multiSelect(),0===t.page()?(c.Api().rupTable.selectPencil(l,0),l.multiselection.lastSelectedId=c.Api().rupTable.getIdPk(t.data()[0],l.oInit)):(c.Api().rupTable.selectPencil(l,-1),l.multiselection.lastSelectedId=""),e("#"+e.escapeSelector(l.sTableId)).triggerHandler("tableMultiSelectSelectAll",l)}function h(t){var l=t.settings()[0];l.multiselection=function(t){var l={};return void 0===l.multiselection&&(l.multiselection={}),l.multiselection.selectedAll=!1,l.multiselection.numSelected=0,l.multiselection.selectedRowsPerPage=[],l.multiselection.selectedIds=[],l.multiselection.lastSelectedId="",l.multiselection.deselectedRowsPerPage=[],l.multiselection.deselectedIds=[],l.multiselection.accion="",e("#contextMenu1 li.context-menu-icon-uncheck").addClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck_all").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!1),c.Api().rupTable.selectPencil(t,-1),l.multiselection}(l),l.multiselection.accion="uncheckAll",e("#"+e.escapeSelector(l.sTableId)+" tbody tr td.select-checkbox i.selected-pencil").remove(),t.rows().deselect(),e("#"+e.escapeSelector(l.sTableId)).trigger("rupTable_deselectAll",l)}function S(e,t){if(t||"single"===e._multiSelect.style){var l=new c.Api(e);l.rows({selected:!0}).deselect(),l.columns({selected:!0}).deselect(),l.cells({selected:!0}).deselect()}}function b(e){return e.id.replace(/[^a-zA-Z0-9\-\_]/g,"-")}function _(e,t,l){for(var c=0;c<l.length;c++){var i=e.row(l[c]).id();i&&"undefined"!==i&&!t.includes(i)&&t.push(i)}}function g(e,t,l){for(var c=0;c<l.length;c++){var i=e.row(l[c]).id(),n=t.indexOf(i);-1!==n&&t.splice(n,1)}}function v(t,l,c,i,n,s){var a=-1;if(c){if((a=jQuery.inArray(l,s.multiselection.deselectedIds))>-1&&!i&&(s.multiselection.deselectedIds.splice(a,1),s.multiselection.deselectedRowsPerPage.splice(a,1),s.multiselection.numSelected===s.json.recordsTotal&&(s.multiselection.selectedAll=!0)),void 0!==l&&s.multiselection.selectedIds.indexOf(l)<0){var o=0,u={id:l,page:Number(s.json.page),line:n};e.each(s.multiselection.selectedRowsPerPage,(function(e,t){if(u.page<t.page)return o=e,!1;if(u.page===t.page){if(u.line<t.line)return o=e,!1;o=e+1}else u.page>t.page&&(o=e+1)})),s.multiselection.selectedIds.splice(o,0,l),s.multiselection.selectedRowsPerPage.splice(o,0,u)}}else if((a=jQuery.inArray(l,s.multiselection.selectedIds))>-1&&(s.multiselection.selectedIds.splice(a,1),s.multiselection.selectedRowsPerPage.splice(a,1),s.multiselection.lastSelectedId===l&&(s.multiselection.lastSelectedId=function(e){const t=e[0]?.id;return t||""}(s.multiselection.selectedRowsPerPage)),t.Api().rupTable.selectPencil(s,-1),0===s.multiselection.numSelected&&(s.multiselection.selectedAll=!1)),void 0!==l&&s.multiselection.deselectedIds.indexOf(l)<0){void 0===n&&e.each(s.json.rows,(function(e,c){if(t.Api().rupTable.getIdPk(c,s.oInit)===l)return n=e,!1}));var r=0,d={id:l,page:Number(s.json.page),line:n};e.each(s.multiselection.deselectedRowsPerPage,(function(e,t){if(d.page<t.page)return r=e,!1;if(d.page===t.page){if(d.line<t.line)return r=e,!1;r=e+1}else d.page>t.page&&(r=e+1)})),s.multiselection.deselectedIds.splice(r,0,l),s.multiselection.deselectedRowsPerPage.splice(r,0,d),s.multiselection.lastSelectedId===l&&(s.multiselection.lastSelectedId=""),t.Api().rupTable.selectPencil(s,-1)}}c.multiSelect={},c.multiSelect.classes={checkbox:"dt-select-checkbox"},c.multiSelect.version="3.0.0",c.multiSelect.init=function(t){var l=t.settings()[0];if(!c.versionCheck("2"))throw"Warning: MultiSelect requires DataTables 2 or newer";if(!l._multiSelect){var i=t.state.loaded(),n=function(e,l,c){if(null!==c&&void 0!==c.multiSelect){if(t.rows({selected:!0}).any()&&t.rows().deselect(),void 0!==c.multiSelect.rows&&t.rows(c.multiSelect.rows).select(),t.columns({selected:!0}).any()&&t.columns().deselect(),void 0!==c.multiSelect.columns&&t.columns(c.multiSelect.columns).select(),t.cells({selected:!0}).any()&&t.cells().deselect(),void 0!==c.multiSelect.cells)for(var i=0;i<c.multiSelect.cells.length;i++)t.cell(c.multiSelect.cells[i].row,c.multiSelect.cells[i].column).select();t.state.save()}};t.on("stateSaveParams",(function(e,l,c){c.multiSelect={},c.multiSelect.rows=t.rows({selected:!0}).ids(!0).toArray(),c.multiSelect.columns=t.columns({selected:!0})[0],c.multiSelect.cells=t.cells({selected:!0})[0].map((function(e){return{row:t.row(e.row).id(!0),column:e.column}}))})).on("stateLoadParams",n).one("init",(function(){n(0,0,i)}));var s=l.oInit.multiSelect,a=c.defaults.multiSelect,o=void 0===s?a:s,u="row",r="api",S=!0,b="td",_="selected tr-highlight",g=!1,v=!1;l._multiSelect={infoEls:[]},void 0===s.hideMultiselect&&(s.hideMultiselect=!1),void 0===s.enableMouseSelection&&(s.enableMouseSelection=!0),void 0===s.enableKeyboardSelection&&(s.enableKeyboardSelection=!0),function(t){var l=t.oInit.aoColumnDefs;if(void 0!==l&&void 0!==l[0].className&&l[0].className.indexOf("select-checkbox")>-1){if(void 0===t.oInit.multiSelect||!t.oInit.multiSelect.hideMultiselect){var i=e("<div>").attr("id","divSelectTableHead_"+t.sTableId).attr("class","divSelectTableHead checkbox-material checkbox-material-inline").append(e("<input/>").attr("id","inputSelectTableHead_"+t.sTableId).attr("type","checkbox")).append(e("<label></label>")),n=e("<a></a>").addClass("ui-icon rup-table_checkmenu_arrow").attr("id","linkSelectTableHead"+t.sTableId);i.click((function(){var l=new c.Api(t);e(this).find("input").is(":checked")?(f(l),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!1)):(e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!0),m(l))})),n.click((function(){var l=new c.Api(t);t.multiselection.selectedAll&&0===t.multiselection.deselectedIds.length&&(e("#contextMenu1 li.context-menu-icon-check").addClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-check_all").addClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck_all").removeClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!0)),t.multiselection.selectedAll||0!==t.multiselection.selectedIds.length||(e("#contextMenu1 li.context-menu-icon-check").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-check_all").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck").addClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck_all").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!1)),t.multiselection.selectedIds.length>0&&e("#contextMenu1 li.context-menu-icon-uncheck_all").removeClass("disabledButtonsTable"),t.multiselection.deselectedIds.length>0&&e("#contextMenu1 li.context-menu-icon-check_all").removeClass("disabledButtonsTable"),d(l,!0)?(e("#contextMenu1 li.context-menu-icon-uncheck_all").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-check").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!0)):(e("#contextMenu1 li.context-menu-icon-check_all").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-check").removeClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!1)),d(l,!1)?(e("#contextMenu1 li.context-menu-icon-check_all").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-check").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck").addClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!1)):(e("#contextMenu1 li.context-menu-icon-uncheck_all").removeClass("disabledButtonsTable"),e("#contextMenu1 li.context-menu-icon-uncheck").removeClass("disabledButtonsTable"),e("#inputSelectTableHead"+e.escapeSelector(t.sTableId)).prop("checked",!0))})),null!==t.nTHead&&e(t.nTHead.rows[0].cells[0]).append(i,n),t.oInit.headerContextMenu.show&&function(t,l){var i={},n=l.oInit,s=new c.Api(l);n.headerContextMenu.selectAllPage&&jQuery.extend(i,{selectAllPage:{name:e.rup.i18nParse(e.rup.i18n.base,"rup_table.plugins.multiselection.selectAllPage"),icon:"check",disabled:function(){},callback:function(){m(s)}}}),n.headerContextMenu.deselectAllPage&&jQuery.extend(i,{deselectAllPage:{name:e.rup.i18nParse(e.rup.i18n.base,"rup_table.plugins.multiselection.deselectAllPage"),icon:"uncheck",disabled:function(){},callback:function(){f(s)}}}),n.headerContextMenu.separator&&jQuery.extend(i,{separator:""}),n.headerContextMenu.selectAll&&jQuery.extend(i,{selectAll:{name:e.rup.i18nParse(e.rup.i18n.base,"rup_table.plugins.multiselection.selectAll"),icon:"check_all",disabled:function(){},callback:function(){p(s)}}}),n.headerContextMenu.deselectAll&&e.extend(i,{deselectAll:{name:e.rup.i18nParse(e.rup.i18n.base,"rup_table.plugins.multiselection.deselectAll"),icon:"uncheck_all",disabled:function(){},callback:function(){h(s)}}}),s.on("init.dt",(function(){e("#"+e.escapeSelector(t)).rup_contextMenu({selector:"#"+t,trigger:"left",items:i,position:function(e){e.$menu.css({top:this.parent().offset().top+this.parent().height(),left:this.parent().parent().offset().left})}})}))}(n[0].id,t)}l[0].orderable=!1}}(l),!0===o?(r="os",g=!0):"string"==typeof o?(r=o,g=!0):e.isPlainObject(o)&&(void 0!==o.info&&(S=o.info),void 0!==o.items&&(u=o.items),void 0!==o.style&&(r=o.style,g=!0),void 0!==l.oInit.selector&&(b=o.selector),void 0!==o.className&&(_=o.className),void 0!==o.keys&&(v=o.keys)),t.multiSelect.selector(b),t.multiSelect.items(u),t.multiSelect.style(r),t.multiSelect.info(S),t.multiSelect.keys(v),l._multiSelect.className=_,e.fn.dataTable.ext.order["select-checkbox"]=function(t,l){return this.api().column(l,{order:"index"}).nodes().map((function(l){return"row"===t._multiSelect.items?e(l).parent().hasClass(t._multiSelect.className):"cell"===t._multiSelect.items&&e(l).hasClass(t._multiSelect.className)}))},!g&&e(t.table().node()).hasClass("selectable")&&t.multiSelect.style("os")}},e.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],(function(e,t){c.ext.selector[t.type].push((function(e,l,c){var i,n=l.selected,s=[];if(void 0===n)return c;for(var a=0,o=c.length;a<o;a++)(i=e[t.prop][c[a]])&&(!0===n&&!0===i._multiSelect_selected||!1===n&&!i._multiSelect_selected)&&s.push(c[a]);return s}))})),c.ext.selector.cell.push((function(e,t,l){var c,i=t.selected,n=[];if(void 0===i)return l;for(var s=0,a=l.length;s<a;s++)(c=e.aoData[l[s].row])&&(!0===i&&c._selected_cells&&!0===c._selected_cells[l[s].column]||!1===i&&(!c._selected_cells||!c._selected_cells[l[s].column]))&&n.push(l[s]);return n}));var w=c.Api.register,x=c.Api.registerPlural;function k(e,t){return function(l){return l.i18n("buttons."+e,t)}}function T(e){var t=e._eventNamespace;return"draw.dt.DT"+t+" multiSelect.dt.DT"+t+" deselect.dt.DT"+t}w("multiSelect()",(function(){return this.iterator("table",(function(e){c.multiSelect.init(new c.Api(e))}))})),w("multiSelect.info()",(function(e){return void 0===o?this.context[0]._multiSelect.info:this.iterator("table",(function(t){t._multiSelect.info=e}))})),w("multiSelect.items()",(function(e){return void 0===e?this.context[0]._multiSelect.items:this.iterator("table",(function(t){t._multiSelect.items=e,a(new c.Api(t),"selectItems",[e])}))})),w("multiSelect.keys()",(function(t){return void 0===t?this.context[0]._multiSelect.keys:this.iterator("table",(function(i){i._multiSelect||c.multiSelect.init(new c.Api(i)),i._multiSelect.keys=t,function(t){var c=t.settings()[0],i=c._multiSelect.keys,n="dts-keys-"+c.sTableId;i?(e(t.rows({page:"current"}).nodes()).attr("tabindex",0),t.on("draw."+n,(function(){e(t.rows({page:"current"}).nodes()).attr("tabindex",0)})),e(l).on("keydown."+n,(function(e){var c=e.keyCode,i=l.activeElement;if([9,13,32,38,40].includes(c)){var n=t.rows({page:"current"}).nodes().toArray(),s=n.indexOf(i),a=!0;if(-1!==s){if(9===c)!1===e.shift&&s===n.length-1?u(t):!0===e.shift&&0===s?r(t):a=!1;else if(13===c||32===c){var o=t.row(i);o.selected()?o.deselect():o.select()}else 38===c?s>0?n[s-1].focus():r(t):s<n.length-1?n[s+1].focus():u(t);a&&(e.stopPropagation(),e.preventDefault())}}}))):(e(t.rows().nodes()).removeAttr("tabindex"),t.off("draw."+n),e(l).off("keydown."+n))}(new c.Api(i))}))})),w("multiSelect.style()",(function(l){return void 0===l?this.context[0]._multiSelect.style:this.iterator("table",(function(a){a._multiSelect||c.multiSelect.init(new c.Api(a)),a._multiSelect_init||function(l){var n=new c.Api(l);l._multiSelect_init=!0,l._multiSelect_mode="additive",l._multiSelect_set=[],l.aoRowCreatedCallback.push((function(t,c,s){var a,o,u=l.aoData[s],r=n.row(s).id();for((u._multiSelect_selected||"additive"===l._multiSelect_mode&&l._multiSelect_set.includes(r)||"subtractive"===l._multiSelect_mode&&!l._multiSelect_set.includes(r))&&(u._multiSelect_selected=!0,e(t).addClass(l._multiSelect.className).find("input."+i(!0)).prop("checked",!0)),a=0,o=l.aoColumns.length;a<o;a++)(l.aoColumns[a]._multiSelect_selected||u._selected_cells&&u._selected_cells[a])&&e(u.anCells[a]).addClass(l._multiSelect.className)})),function(e){e.on("select",(function(t,l,c,i){if("row"===c){var n=e.settings()[0];"additive"===n._multiSelect_mode?_(e,n._multiSelect_set,i):g(e,n._multiSelect_set,i)}})),e.on("deselect",(function(t,l,c,i){if("row"===c){var n=e.settings()[0];"additive"===n._multiSelect_mode?g(e,n._multiSelect_set,i):_(e,n._multiSelect_set,i)}}))}(n),n.on("info.dt",(function(t,l,c){l._multiSelect.infoEls.includes(c)||l._multiSelect.infoEls.push(c),o(n),function(t,l){var c=e.fn.dataTable,i=-1;e.each(l.multiselection.selectedIds,(function(n,s){var a=-1;e.each(t.context[0].json.rows,(function(e,t){if(s===c.Api().rupTable.getIdPk(t,l.oInit))return a=e,!1})),a>=0&&(t.context[0].aoData[a]._multiSelect_selected=!0,e(t.context[0].aoData[a].nTr).addClass(t.context[0]._multiSelect.className),void 0!==t.row(a).child()&&t.row(a).child().addClass(l._multiSelect.className),e(e(l.aoData[a].anCells).filter(".select-checkbox")).find(":input").prop("checked",!0),e(t.context[0].aoData[a].nTr).triggerHandler("tableHighlightRowAsSelected",l),l.multiselection.lastSelectedId===s&&(i=a),-1===i&&""===l.multiselection.lastSelectedId&&(i=a))})),i>=0&&(l._iDisplayLength<l.json.rows.length&&!e("#"+e.escapeSelector(l.sTableId)+" tbody tr").hasClass("new")&&i--,c.Api().rupTable.selectPencil(t.context[0],i))}(n,l),e("#divSelectTableHead_"+e.escapeSelector(l.sTableId)).closest("th").removeClass("dt-orderable-none"),e("#divSelectTableHead_"+e.escapeSelector(l.sTableId)).closest("th").off("mousedown.colReorder touchstart.colReorder");const i=l.oInit.feedback.$feedbackContainer;void 0!==i.type&&"eliminar"===i.type&&(i.rup_feedback("set",i.msgFeedBack,"ok"),i.rup_feedback("show"))})),n.on("select.dtSelect.dt deselect.dtSelect.dt",(function(){l._multiSelect.infoEls.forEach((function(e){o(n)})),n.state.save()})),n.on("destroy.dtSelect",(function(){var t,l;e(n.rows({selected:!0}).nodes()).removeClass(n.settings()[0]._multiSelect.className),e("input."+i(!0),n.table().header()).remove(),l=(t=n).settings()[0]._multiSelect.selector,e(t.table().container()).off("mousedown.dtSelect",l).off("mouseup.dtSelect",l).off("click.dtSelect",l),e("body").off("click.dtSelect"+b(t.table().node())),n.off(".dtSelect"),e("body").off(".dtSelect"+b(n.table().node()))})),void 0===l.oInit.inlineEdit&&void 0===l.oInit.formEdit&&e(t).on("resize.dtr",c.util.throttle((function(){c.Api().editForm.addchildIcons(l)})))}(a),a._multiSelect.style=l;var u=new c.Api(a);"api"!==l&&(a.oInit.multiSelect.enableMouseSelection&&function(t,l){l=t.settings()[0];var c=e(l.nTBody);l.oInit.selectFilaDer?c.on("click contextmenu",(function(l){if(void 0!==l.target&&l.target.className.indexOf("openResponsive")>-1)return!1;var c=t.settings()[0],i=e(l.target);i.triggerHandler("tableSelectBeforeSelectRow",c),(l.shiftKey||l.ctrlKey||l.shiftKey&&32===l.which)&&c.multiselection.selectedRowsPerPage.length>0?n(t,l):c.multiselection.lastSelectedIsRange?"checkbox"!==l.target.type?(f(t),t.row(e(l.target).closest("tr").index()).multiSelect()):e(l.target).parent("").find("input").prop("checked",(function(){return!this.checked})):"checkbox"!==l.target.type?s(t,l):e(l.target).hasClass("editable")||e(l.target).parent("").find("input").prop("checked",(function(){return!this.checked})),i.triggerHandler("tableSelectAfterSelectRow",c)})):c.on("click",(function(l){if(void 0!==l.target&&l.target.className.indexOf("openResponsive")>-1)return!1;var c=t.settings()[0],i=e(l.target);i.triggerHandler("tableSelectBeforeSelectRow",c),(l.shiftKey||l.ctrlKey||l.shiftKey&&32===l.which)&&c.multiselection.selectedRowsPerPage.length>0?n(t,l):c.multiselection.lastSelectedIsRange?"checkbox"!==l.target.type?(f(t),t.row(e(l.target).closest("tr").index()).multiSelect()):e(l.target).parent("").find("input").prop("checked",(function(){return!this.checked})):"checkbox"!==l.target.type?s(t,l):e(l.target).hasClass("editable")||e(l.target).parent("").find("input").prop("checked",(function(){return!this.checked})),i.triggerHandler("tableSelectAfterSelectRow",c)}))}(u,a),a.oInit.multiSelect.enableKeyboardSelection&&function(t){var l=t.settings()[0];e(l.nTBody).on("keydown.dtSelect",(function(l){if(32===l.which){if(void 0!==l.target&&l.target.className.indexOf("openResponsive")>-1)return!1;var c=t.settings()[0],i=e(l.target);if(i.triggerHandler("tableSelectBeforeSelectRow",c),l.shiftKey&&32===l.which||l.ctrlKey&&32===l.which)n(t,l);else if(c.multiselection.lastSelectedIsRange)f(t),t.row(e(l.target).closest("tr").index()).multiSelect();else{if(c.oInit.multiSelect.hideMultiselect&&32===l.which){if(l.target.className.indexOf("openResponsive")>-1||i.hasClass("editable"))return!1;var a=i.index();i.hasClass("tr-highlight")?(c.multiselection.accion="uncheck",t.row(a).deselect()):t.row(a).multiSelect()}s(t,l)}i.triggerHandler("tableSelectAfterSelectRow",c)}}))}(u)),e("#"+e.escapeSelector(a.sTableId)).trigger("selectStyle",[l,a])}))})),w("multiSelect.selector()",(function(e){return void 0===e?this.context[0]._multiSelect.selector:this.iterator("table",(function(t){t._multiSelect.selector=e}))})),w("multiSelect.selectable()",(function(e){let t=this.context[0];return e?(t._multiSelect.selectable=e,this):t._multiSelect.selectable})),w("multiSelect.last()",(function(e){let t=this.context[0];return e?(t._multiSelect_lastCell=e,this):t._multiSelect_lastCell})),w("multiSelect.cumulative()",(function(e){if(e)return this.iterator("table",(function(t){if(t._multiSelect_mode!==e){var l=new c.Api(t);if("subtractive"===e){var i=l.rows({selected:!1}).ids().toArray();t._multiSelect_mode=e,t._multiSelect_set.length=0,t._multiSelect_set.push.apply(t._multiSelect_set,i)}else{var n=l.rows({selected:!0}).ids().toArray();t._multiSelect_mode=e,t._multiSelect_set.length=0,t._multiSelect_set.push.apply(t._multiSelect_set,n)}}})).draw(!1);let t=this.context[0];return t&&t._multiSelect_set?{mode:t._multiSelect_mode,rows:t._multiSelect_set}:null})),w("multiSelect.deselectAll()",(function(e){h(e)})),w("multiSelect.selectAll()",(function(e){p(e)})),w("multiSelect.defaultsIds()",(function(t){let l=t.oInit.multiSelect.defaultsIds;if(void 0!==l&&void 0!==l[0]){let c=l[0],i=l[1];!0===i&&e.each(c,(function(){jQuery.inArray(this,t.multiselection.selectedIds)<0&&t.multiselection.selectedIds.push(this)})),!1!==i&&void 0!==i||(e.each(c,(function(){jQuery.inArray(this,t.multiselection.selectedIds)<0&&t.multiselection.selectedIds.push(this)})),t.oInit.multiSelect.defaultsIds[1]=null)}})),x("rows().multiSelect()","row().multiSelect()",(function(t){var l=this,c=e.fn.dataTable,i=!0,n=l.context[0];if(void 0===n.multiselection)return!1;var s=n.oInit.feedback;if(s.$feedbackContainer.children().length>1&&s.type&&"fijo"===s.type&&s.$feedbackContainer.rup_feedback("hide"),!1===t)return v(c,c.Api().rupTable.getIdPk(l.data(),n.oInit),0,i,void 0,n),n.multiselection.accion="",this.deselect();if(this.iterator("row",(function(t,n){t.oInit.noEdit||void 0===t.oInit.inlineEdit||void 0===t.inlineEdit.lastRow||t.inlineEdit.lastRow.idx===n||c.Api().inlineEdit.restaurarFila(t,!0),e(t.aoData[n].nTr).triggerHandler("tableMultiSelectBeforeSelectRow",t),S(t);var s=t.aoData[n];if(t.aoColumns,!t._multiSelect.selectable||!1!==t._multiSelect.selectable(s._aData,s.nTr,n)){e(s.nTr).addClass(t._multiSelect.className),void 0!==l.row(n).child()&&l.row(n).child().addClass(t._multiSelect.className),s._multiSelect_selected=!0,i=!1,e(e(t.aoData[n].anCells).filter(".select-checkbox")).find(":input").prop("checked",!0);var a=c.Api().rupTable.getIdPk(t.aoData[n]._aData,t.oInit);void 0!==t.multiselection&&void 0!==t.json&&t.multiselection.numSelected<t.json.recordsTotal&&void 0!==a&&t.multiselection.selectedIds.indexOf(a)<0&&t.multiselection.numSelected++,v(c,a,1,i,n,t),t.multiselection.lastSelectedId=a,e(t.aoData[n].nTr).triggerHandler("tableMultiSelectAfterSelectRow",t)}})),i){if(n.multiselection.selectedAll){let t=l.settings()[0];e.each(l.context[0].aoData,(function(n){var s=c.Api().rupTable.getIdPk(t.aoData[n]._aData,t.oInit);-1===jQuery.inArray(s,t.multiselection.deselectedIds)&&(t.aoData[n]._multiSelect_selected=!0,e(t.aoData[n].nTr).addClass(t._multiSelect.className),void 0!==l.row(n).child()&&l.row(n).child().addClass(t._multiSelect.className),e(e(t.aoData[n].anCells).filter(".select-checkbox")).find(":input").prop("checked",!0),v(c,s,1,i,void 0,t))}))}void 0!==n.oInit.buttons&&e("#"+e.escapeSelector(n.sTableId)+" > tbody > tr").addClass("context-menu-cursor")}this.iterator("table",(function(e,t){a(l,"select",["row",l[t]],!0)}));var o=e(n.nTHead.rows[0].cells[0]).find(":input");return d(l,!0)?o.prop("checked",!0):o.prop("checked",!1),this})),w("row().selected()",(function(){var e=this.context[0];return!!(e&&this.length&&e.aoData[this[0]]&&e.aoData[this[0]]._multiSelect_selected)})),w("row().focus()",(function(){var e=this.context[0];e&&this.length&&e.aoData[this[0]]&&e.aoData[this[0]].nTr&&e.aoData[this[0]].nTr.focus()})),w("row().blur()",(function(){var e=this.context[0];e&&this.length&&e.aoData[this[0]]&&e.aoData[this[0]].nTr&&e.aoData[this[0]].nTr.blur()})),x("columns().multiSelect()","column().multiSelect()",(function(t){var l=this;return!1===t?this.deselect():(this.iterator("column",(function(t,l){S(t),t.aoColumns[l]._multiSelect_selected=!0;var i=new c.Api(t).column(l);e(i.header()).addClass(t._multiSelect.className),e(i.footer()).addClass(t._multiSelect.className),i.nodes().to$().addClass(t._multiSelect.className)})),this.iterator("table",(function(e,t){a(l,"multiSelect",["column",l[t]],!0)})),this)})),w("column().selected()",(function(){var e=this.context[0];return!!(e&&this.length&&e.aoColumns[this[0]]&&e.aoColumns[this[0]]._multiSelect_selected)})),x("cells().multiSelect()","cell().multiSelect()",(function(t){var l=this;return!1===t?this.deselect():(this.iterator("cell",(function(t,l,c){S(t);var i=t.aoData[l];void 0===i._selected_cells&&(i._selected_cells=[]),i._selected_cells[c]=!0,i.anCells&&e(i.anCells[c]).addClass(t._multiSelect.className)})),this.iterator("table",(function(e,t){a(l,"multiSelect",["cell",l[t]],!0)})),this)})),w("cell().selected()",(function(){var e=this.context[0];if(e&&this.length){var t=e.aoData[this[0][0].row];if(t&&t._multiSelect_cells&&t._multiSelect_cells[this[0][0].column])return!0}return!1})),x("rows().deselect()","row().deselect()",(function(){var t=this,l=e.fn.dataTable,c=t.context[0],i=c.oInit.feedback;i.$feedbackContainer.children().length>1&&i.type&&"fijo"===i.type&&i.$feedbackContainer.rup_feedback("hide"),this.iterator("row",(function(c,i){var n=c.aoData[i];c.aoColumns,e(n.nTr).removeClass(c._multiSelect.className),n._multiSelect_selected=!1,c._multiSelect_lastCell=null,e(c.aoData[i].nTr).removeClass(c._multiSelect.className),void 0!==t.row(i).child()&&t.row(i).child().removeClass(c._multiSelect.className),c.oInit.multiSelect.hideMultiselect||e(e(c.aoData[i].anCells).filter(".select-checkbox")).find(":input").prop("checked",!1);var s=l.Api().rupTable.getIdPk(c.aoData[i]._aData,c.oInit);c.multiselection.numSelected>0&&void 0!==s&&c.multiselection.deselectedIds.indexOf(s)<0&&c.multiselection.numSelected--,c.multiselection.numSelected>0&&"uncheckAll"===c.multiselection.accion||c.multiselection.numSelected>=0&&"uncheck"===c.multiselection.accion?v(l,s,0,!1,void 0,c):""===c.multiselection.accion&&c.multiselection.numSelected--,!c.oInit.noEdit&&void 0!==c.oInit.inlineEdit&&l.Api().inlineEdit.editSameLine(c,i)&&t.rows(i).multiSelect()})),this.iterator("table",(function(e,l){a(t,"deselect",["row",t[l]],!0)}));var n=e(c.nTHead.rows[0].cells[0]).find(":input");return d(t,!0)?n.prop("checked",!0):n.prop("checked",!1),this})),x("columns().deselect()","column().deselect()",(function(){var t=this;return this.iterator("column",(function(t,l){t.aoColumns[l]._multiSelect_selected=!1;var i=new c.Api(t),n=i.column(l);e(n.header()).removeClass(t._multiSelect.className),e(n.footer()).removeClass(t._multiSelect.className),i.cells(null,l).indexes().each((function(l){var c=t.aoData[l.row],i=c._selected_cells;!c.anCells||i&&i[l.column]||e(c.anCells[l.column]).removeClass(t._multiSelect.className)}))})),this.iterator("table",(function(e,l){a(t,"deselect",["column",t[l]],!0)})),this})),x("cells().deselect()","cell().deselect()",(function(){var t=this;return this.iterator("cell",(function(t,l,c){var i=t.aoData[l];i._selected_cells[c]=!1,i.anCells&&!t.aoColumns[c]._multiSelect_selected&&e(i.anCells[c]).removeClass(t._multiSelect.className)})),this.iterator("table",(function(e,l){a(t,"deselect",["cell",t[l]],!0)})),this}));var I=0;return e.extend(c.ext.buttons,{selected:{text:k("selected","Selected"),className:"buttons-selected",init:function(e,t,l){var c=this;l._eventNamespace=".multiSelect"+I++,e.on(T(l),(function(){var e=c.rows({selected:!0}).any()||c.columns({selected:!0}).any()||c.cells({selected:!0}).any();c.enable(e)})),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},selectedSingle:{text:k("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(e,t,l){var c=this;l._eventNamespace=".multiSelect"+I++,e.on(T(l),(function(){var t=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;c.enable(1===t)})),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},selectAll:{text:k("selectAll","Select all"),className:"buttons-select-all",action:function(){this[this.multiSelect.items()+"s"]().select()}},selectNone:{text:k("selectNone","Deselect all"),className:"buttons-select-none",action:function(){S(this.settings()[0],!0)},init:function(e,t,l){var c=this;l._eventNamespace=".multiSelect"+I++,e.on(T(l),(function(){var t=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;c.enable(t>0)})),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},showSelected:{text:k("showSelected","Show only selected"),className:"buttons-show-selected",action:function(e,t){if(t.search.fixed("dt-select"))t.search.fixed("dt-select",null),this.active(!1);else{var l=t.settings()[0].aoData;t.search.fixed("dt-select",(function(e,t,c){return l[c]._multiSelect_selected})),this.active(!0)}t.draw()}}}),e.each(["Row","Column","Cell"],(function(e,t){var l=t.toLowerCase();c.ext.buttons["multiSelect"+t+"s"]={text:k("multiSelect"+t+"s","multiSelect "+l+"s"),className:"buttons-select-"+l+"s",action:function(){this.select.items(l)},init:function(e){var t=this;this.active(e.select.items()===l),e.on("selectItems.dt.DT",(function(e,c,i){t.active(i===l)}))}}})),c.type("select-checkbox",{className:"dt-select",detect:c.versionCheck("2.1")?{oneOf:function(){return!1},allOf:function(){return!1},init:function(){return!1}}:function(e){return"select-checkbox"===e&&e},order:{pre:function(e){return"X"===e?-1:0}}}),e.extend(!0,c.defaults.oLanguage,{select:{aria:{rowCheckbox:"Select row"}}}),c.render.multiSelect=function(t,l){var n=t?c.util.get(t):null,s=l?c.util.get(l):null,a=function(t,l,c,a){var o=a.settings.aoData[a.row],u=o._multiSelect_selected,r=a.settings.oLanguage.select.aria.rowCheckbox,d=a.settings._multiSelect.selectable;return"display"===l?d&&!1===d(c,o.nTr,a.row)?"":e("<input>").attr({"aria-label":r,class:i(),name:s?s(c):null,type:"checkbox",value:n?n(c):null,checked:u}).on("input",(function(t){t.preventDefault(),this.checked=e(this).closest("tr").hasClass("selected")}))[0]:"type"===l?"select-checkbox":"filter"===l?"":u?"X":""};return a._name="selectCheckbox",a},c.ext.order["select-checkbox"]=function(t,l){return this.api().column(l,{order:"index"}).nodes().map((function(l){return"row"===t._multiSelect.items?e(l).parent().hasClass(t._multiSelect.className).toString():"cell"===t._multiSelect.items&&e(l).hasClass(t._multiSelect.className).toString()}))},e.fn.DataTable.multiSelect=c.multiSelect,e(l).on("i18n.dt.dtSelect preInit.dt.dtSelect",(function(e,t){"dt"===e.namespace&&void 0!==t.oInit.multiSelect&&!1!==t.oInit.multiSelect.activate&&c.multiSelect.init(new c.Api(t))})),c.multiSelect}));