/*! For license information please see rup.calendar.js.LICENSE.txt */
import underscore from"underscore";import"jquery";import"./rup.base";import"popper.js";import"./external/bootstrap-calendar";var self,rup_calendar={},calObj={},errorstr=t=>{throw ReferenceError("Cannot call methods on rup_calendar before init. tried to call method "+t)};window._=underscore,$.extend($.rup.iniRup,$.rup.rupSelectorObjectConstructor("rup_calendar",rup_calendar)),$.fn.rup_calendar("extend",{navigate:function(t){var e=this;if($(e).data("cal").options||errorstr("navigate"),t instanceof Date){if(void 0!==$(e).data("cal").options.date_range_start&&t.getTime()<$(e).data("cal").options.date_range_start.getTime())return void console.warn("Can´t navigate to an out of range time.");if(void 0!==$(e).data("cal").options.date_range_end&&t.getTime()>$(e).data("cal").options.date_range_end.getTime())return void console.warn("Can´t navigate to an out of range time.");let a=$.extend({},$(e).data("cal").options.position);return a.start.setTime(t.getTime()),$(e).data("cal").options.day=a.start.getFullYear()+"-"+a.start.getMonthFormatted()+"-"+a.start.getDateFormatted(),void $(e).data("cal").view()}if(t=t||"today",$.inArray(t,["next","prev","today"])<0)throw Error("Parámetro inválido");$(e).data("cal").navigate(t)},isToday:function(){return $(this).data("cal").options||errorstr("isToday"),$(this).data("cal").isToday()},instance:function(){return $(this).data("cal").options||errorstr("instance"),$(this).data("cal")},setView:function(t){if($(this).data("cal").options||errorstr("setView"),t=t||"month",$.inArray(t,["year","month","week","day"])<0)throw Error("Parámetro inválido");$(this).data("cal").view(t)},getView:function(){return $(this).data("cal").options||errorstr("getView"),$(this).data("cal").options.view},getYear:function(){return $(this).data("cal").options||errorstr("getYear"),$(this).data("cal").getYear()},getMonth:function(){return $(this).data("cal").options||errorstr("getMonth"),$(this).data("cal").getMonth()},getWeek:function(){return $(this).data("cal").options||errorstr("getWeek"),new Date($(this).data("cal").getStartDate()).getWeek()},getDay:function(){return $(this).data("cal").options||errorstr("getDay"),$(this).data("cal").getDay()},getTitle:function(){return $(this).data("cal").options||errorstr("getTitle"),$(this).data("cal").getTitle()},getStartDate:function(){return $(this).data("cal").options||errorstr("getStartDate"),$(this).data("cal").getStartDate()},getEndDate:function(){return $(this).data("cal").options||errorstr("getEndDate"),$(this).data("cal").getEndDate()},option:function(t,e){var a=this;if($(a).data("cal").options||errorstr("option"),"object"!=typeof t){if(void 0===e)return $(a).data("cal").options[t];$(a).data("cal").options[t]=e,$(a).data("cal")._render()}else{let e=Object.keys(t);$.each(e,((e,r)=>{$(a).data("cal").options[r]=t[r],$(a).data("cal")._render()}))}},getEventsBetween:function(t,e){return $(this).data("cal").options||errorstr("getEventsBetween"),$(this).data("cal").getEventsBetween(t,e)},showCell:function(t){if($(this).data("cal").options||errorstr("showCell"),!(t instanceof Date))throw TypeError("Se requiere un Date como parámetro");let e=(t=>{let e=t.getTime(),a=$(".events-list").filter(((t,a)=>$(a).attr("data-cal-start")<=e&&$(a).attr("data-cal-end")>e));return 0!==a.length&&$(a).parent()})(t);if(!e)return!1;void 0!==$("#cal-slide-box").css("display")&&"none"!==$("#cal-slide-box").css("display")||($(this).trigger("beforeShowCell"),e.mouseover(),e.click())},hideCells:function(){var t=this;$(t).data("cal").options||errorstr("showCell"),$(t).trigger("beforeHideCell"),$("#cal-slide-box").css("display","none"),$(t).trigger("afterHideCell")},refresh:function(){var t=this;$(t).data("cal").options||errorstr("refresh"),$(t).data("cal")._render(),$(t).data("cal")._loadEvents(),$(t).data("cal")._render(),setTimeout((function(){$(t).trigger("afterRefresh")}),400)},destroy:function(){var t=this;void 0===$(t).data("cal")&&errorstr("destroy"),$(t).data("cal").options||errorstr("destroy"),$(t).data("cal").options.selector=void 0,$(t).removeClass("cal-context"),$(t).removeData(),$(t).children().remove(),$(t).trigger("afterDestroy")}}),$.fn.rup_calendar("extend",{_callIfFunction:function(...t){if(0===t.length)return!1;if(t.length>1){let e=t[0],a=t.slice(1);return void 0!==e&&"function"==typeof e&&e.apply(this,a)}return void 0!==t&&"function"==typeof t?t.call(this):void 0},_init:function(t){if(t.length>1)$.rup.errorGestor($.rup.i18nParse($.rup.i18n.base,"rup_global.initError")+$(this).attr("id"));else{self=this;var e=t[0],a=$.extend({},$.fn.rup_calendar.defaults,e);self._ADAPTER=$.rup.adapter[a.adapter],a.onAfterEventsLoad=function(...t){self._callIfFunction.call(this,$.fn.rup_calendar.defaults.onAfterEventsLoad,t),self._callIfFunction.call(this,e.rupAfterEventsLoad,t),$(self).trigger("afterEventsLoad")},a.onAfterViewLoad=function(...t){self._callIfFunction.call(this,$.fn.rup_calendar.defaults.onAfterViewLoad,t),self._callIfFunction.call(this,e.rupAfterViewLoad,t),$(self).trigger("afterViewLoad")},window.calendar_languages||(window.calendar_languages={}),window.calendar_languages[a.language]=$.rup.i18n.base.rup_calendar,calObj=new $(self).calendar(a),this.data("cal",calObj),this.trigger("afterInitCalendar")}}}),$.fn.rup_calendar.defaults={events_source:()=>[],language:$.rup.lang,view:"month",tmpl_path:global.STATICS+"/rup/html/templates/rup_calendar/",tmpl_cache:!1,day:"now",weekbox:!1,classes:{months:{general:"label"}},onAfterEventsLoad:()=>{},onAfterViewLoad:()=>{},adapter:"calendar_bootstrap"};