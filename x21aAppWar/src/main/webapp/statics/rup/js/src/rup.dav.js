/*! For license information please see rup.dav.js.LICENSE.txt */
!function(n){jQuery.rup_dav={},n.extend(jQuery.rup_dav,{editOnline:function(e){var r;r="string"==typeof e?jQuery.extend({},jQuery.rup_dav.defaults,{url:e}):jQuery.extend({},jQuery.rup_dav.defaults,e),jQuery.rup_dav._checkUrl(r),r.xlnetsAuth&&jQuery.rup_dav._xlnetsAuth(r),!0===n.browser.msie?jQuery.rup_dav._editOnlineIE(r):jQuery.rup_dav._editOnlineFF(r)}}),n.extend(jQuery.rup_dav,{_checkUrl:function(n){var e="";-1===n.url.indexOf(location.protocol)&&(e+=location.protocol+"//",-1===n.url.indexOf(location.host)&&(e+=location.host),-1===n.url.indexOf(window.CTX_PATH)&&(e+=window.CTX_PATH),n.url=e+n.url)},_xlnetsAuth:function(e){var r=n.rup_utils.readCookie("n38UidSesion"),t=n.rup_utils.readCookie("n38DominioUid"),o={};null!=r&&""!==r&&jQuery.extend(!0,o,{n38UidSesion:r}),null!=t&&""!==t&&jQuery.extend(!0,o,{n38DominioUid:t}),jQuery.isEmptyObject(o)||(e.url+="?"+e.xlnetsAuthParam+"="+jQuery.rup_utils.base64.encode(jQuery.param(o)))},_editOnlineIE:function(n){var e;try{(e=new ActiveXObject("SharePoint.OpenDocuments.3")).EditDocument(encodeURI(n.url))}catch(r){try{(e=new ActiveXObject("Word.Application")).Visible=!0,e.Documents.Open(encodeURI(n.url))}catch(e){!0===n.downloadOnError&&window.open(encodeURI(n.alternateDownloadURL),"_blank"),"function"==typeof n.fncErrorOnEditOnline&&n.fncErrorOnEditOnline.bind(n)}}},_editOnlineFF:function(n){var e,r;try{r=(e=document.getElementById("winFirefoxPlugin")).GetOfficeVersion(),e.EditDocument(n.url,r)}catch(e){!0===n.downloadOnError&&window.open(encodeURI(n.alternateDownloadURL),"_blank"),"function"==typeof n.fncErrorOnEditOnline&&n.fncErrorOnEditOnline.bind(n)}}}),n.rup_dav.defaults={xlnetsAuth:!1,xlnetsAuthParam:"c",downloadOnError:!1,alternateDownloadURL:null,fncErrorOnEditOnline:null}}(jQuery);