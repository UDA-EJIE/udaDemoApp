/*! For license information please see rup.table.inlineEdit.js.LICENSE.txt */
!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],(function(i){return e(i,window,document)})):"object"==typeof exports?module.exports=function(i,t){return i||(i=window),t&&t.fn.dataTable||(t=require("datatables.net")(i,t).$),e(t,i,i.document)}:e(jQuery,window,document)}((function(e,i,t,n){"use strict";var l=e.fn.dataTable;function a(i){let t=!1,l=i.responsive._columnsVisiblity();for(let e=0;e<l.length;e++)l[e]||(!i.aoColumns[e].className||i.aoColumns[e].className.indexOf("never")<0)&&(t=!0);if("td span.openResponsive"===i.responsive.c.details.target&&(e("#"+e.escapeSelector(i.sTableId)).find("tbody td:first-child span.openResponsive").remove(),t&&e.each(e("#"+e.escapeSelector(i.sTableId)).find("tbody td:first-child:not(.child):not(.dataTables_empty)"),(function(){var t=e("<span></span>");0===e(this).find("span.openResponsive").length?e(this).prepend(t.addClass("openResponsive")):t=e(this).find("span.openResponsive"),e(this).parent().next().hasClass("child")&&t.addClass("closeResponsive");var l=e(this).parent();t.click((function(e){l.hasClass("editable")&&l.find(".closeResponsive").length?e.stopPropagation():t.hasClass("closeResponsive")?t.removeClass("closeResponsive"):t.addClass("closeResponsive")})),i.inlineEdit!==n&&l.hasClass("editable")&&c(i,l)})),i.inlineEdit!==n&&i.inlineEdit.lastRow!==n&&i.inlineEdit.lastRow.rupValues!==n)){var a=e("#"+e.escapeSelector(i.sTableId)).DataTable();i.inlineEdit.lastRow.columnsHidden=a.columns().responsiveHidden();var s=e("#"+e.escapeSelector(i.sTableId)+" tbody tr.editable:not(.child)");b(i,s)}e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditLineAddChildIcons",i)}function s(i,t,s,d="POST"){t.inlineEdit.lastRow!==n&&t.inlineEdit.lastRow.idx!==s&&o(t,!1),e.when(function(i,t,a){var s=i.oInit.inlineEdit!==n?i.oInit.inlineEdit.idForm:n;let o=i.oInit.inlineEdit.actionType;if(function(e,i,t,a){if(e.oInit.enableDynamicForms){let s=e.oInit.inlineEdit.lastSelectedIdUsed,o=l.Api().rupTable.getIdPk(a,e.oInit);if(e.oInit.inlineEdit.lastSelectedIdUsed=o,i!==t||s===n||o!==s)return!0}return!1}(i,o,t,a)){const o={actionType:"PUT"==t&&i.oInit.inlineEdit.usePostAsEditActionType?"POST":t,isMultipart:!0===i.oInit.inlineEdit.multipart,..."CLONE"!=i.oInit.inlineEdit.rowDefault?.actionType&&""!=l.Api().rupTable.getIdPk(a,i.oInit)&&{pkValue:l.Api().rupTable.getIdPk(a,i.oInit)}};let r=i.oInit.inlineEdit.data!==n?e.extend({},o,i.oInit.inlineEdit.data):o;return e.post(i.oInit.inlineEdit.url!==n?i.oInit.inlineEdit.url:i.oInit.urlBase+"/inlineEdit",r,(function(l){let a=s!==n?s:n,o=e(l).find("form").addBack("form");a!==n&&1===a.length&&a.attr("id")===o.attr("id")&&a.remove();let r=e("#"+e.escapeSelector(i.sTableId)+"_wrapper");r.prepend(o),i.oInit.inlineEdit.actionType=t,i.oInit.inlineEdit.idForm=r.find("form").first();const d=i.oInit.inlineEdit.serializerSplitter?e.rup_utils.editFormSerialize(i.oInit.inlineEdit.idForm,i.oInit.inlineEdit.serializerSplitter):e.rup_utils.formDataToQueryString(i.oInit.inlineEdit.idForm,i.oInit.inlineEdit.formDataToQueryStringOptions);i.oInit.inlineEdit.serializerSplitter||i.oInit.inlineEdit.allowAllCharacters?i.oInit.inlineEdit.receivedFormDataObject=e.rup_utils.queryStringToJson(d,i.oInit.inlineEdit.serializerSplitter,i.oInit.inlineEdit.allowAllCharacters):i.oInit.inlineEdit.receivedFormDataObject=e.rup_utils.queryStringToObject(d,i.oInit.inlineEdit.queryStringToObjectOptions)}),"html")}{let n=e.Deferred();return i.oInit.inlineEdit.actionType=t,n.resolve(),n.promise()}}(t,d,t.json.rows[s])).then((function(){const o=e("#"+e.escapeSelector(t.sTableId)+" > tbody > tr:not(.dtrg-group)").eq(s);o.hasClass("editable")||(function(i,t){if(i.oInit.colModel!==n){var a=e("#"+e.escapeSelector(i.sTableId)).DataTable(),s=0;i.inlineEdit.lastRow=e("#"+e.escapeSelector(i.sTableId)+" > tbody > tr:not(.dtrg-group)").eq(t),i.inlineEdit.lastRow.cellValues={},i.inlineEdit.lastRow.columnsHidden=a.columns().responsiveHidden(),i.inlineEdit.lastRow.submit=0,i.inlineEdit.lastRow.idx=t,i.inlineEdit.lastRow.ponerFocus=!1;var o=i.inlineEdit.lastRow.find(i.oInit.responsive.details.target);o.length>0&&0===i.inlineEdit.lastRow.next().find(".child").length&&o.click(),s=r(i,i.inlineEdit.lastRow,i.inlineEdit.lastRow.find("td"),s),i.inlineEdit.lastRow.hasClass("new")||i.oInit.inlineEdit.alta||l.Api().rupTable.blockPKEdit(i,"PUT","_inline");var d=i.inlineEdit.lastRow.next(".child");r(i,d,d.find(i.oInit.responsive.selectorResponsive),s),d.length>0&&!d.hasClass("new")&&!i.oInit.inlineEdit.alta&&l.Api().rupTable.blockPKEdit(i,"PUT","_inline_child")}}(t,s),l.Api().buttons.disableAllButtons(t,t.ext.buttons.custom)),e("#"+e.escapeSelector(t.sTableId)+"saveButton_1").prop("disabled",!1),e("#"+e.escapeSelector(t.sTableId)+"saveButton_1_contextMenuToolbar").removeClass("disabledButtonsTable"),e("#"+e.escapeSelector(t.sTableId)+"cancelButton_1").prop("disabled",!1),e("#"+e.escapeSelector(t.sTableId)+"cancelButton_1_contextMenuToolbar").removeClass("disabledButtonsTable"),o.hasClass("odd new")||e("#"+e.escapeSelector(t.sTableId)+"informes_01").prop("disabled",!1),l.Api().seeker.enabledButtons(t),e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableInlineEdit",t);var d={};if(d[0]=o,1===o.next().find(".child").length&&(d[1]=o.next().find(".child")),e.each(d,(function(){u(t,this)})),!0!==t.oInit.inlineEdit.clone)if(t.oInit.multiSelect!==n)i.row(s).multiSelect();else{var c=e(t.nTBody);e("tr",c).removeClass("selected tr-highlight"),l.Api().select.selectRowIndex(i,s,!0),""==t.multiselection.selectedIds&&(t.multiselection.selectedIds=[])}i.responsive.recalc(),t.oInit.inlineEdit.currentPos!==n&&t.oInit.inlineEdit.currentPos.actionType!==n&&"CLONE"===t.oInit.inlineEdit.currentPos.actionType&&0===o.find("span.openResponsive").length&&a(t)}))}function o(i,t){if(e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditInlineRestaurarFilaInit",i),i.inlineEdit!==n&&i.inlineEdit.lastRow!==n){var a=i.inlineEdit.lastRow.idx,s=e("#"+e.escapeSelector(i.sTableId)+" > tbody > tr:not(.dtrg-group)").eq(a);d(i,s,s.find("td"),0);var o=s.find('td:not([style*="display: none"])').length;s.find("td.select-checkbox").length>0&&o--,d(i,s.next(".child"),s.next(".child").find(i.oInit.responsive.selectorResponsive),o)}if(i.inlineEdit!==n&&t){const t=e("#"+e.escapeSelector(i.sTableId)+" > tbody > tr:not(.dtrg-group)").eq(a);i.inlineEdit.lastRow=n,t.data("events")!==n&&t.off("keydown"),l.Api().seeker.disabledButtons(i),i.oInit.feedback.$feedbackContainer.rup_feedback("hide"),s!==n&&s.hasClass("new")&&(s.next(".child").remove(),s.remove(),i.multiselection.numSelected=0,i.multiselection.selectedIds=[],i.multiselection.selectedRowsPerPage=[]),i._buttons[0].inst.s.disableAllButtons=n,l.Api().buttons.displayRegex(i)}e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditLineRestaurarFilaEnd",i)}function r(i,t,l,a){t.addClass("editable inline");var s=i.oInit.colModel,o="";t.hasClass("child")&&(o="_child",t=t.prev());var r=0,d=!0;return(t.hasClass("new")||i.oInit.inlineEdit.alta)&&(d=!1),l.each((function(){var l=e(this),c=e(l);if(!c.hasClass("select-checkbox")){for(;s[a].hidden;)a++;var u=s[a];if(!0===u.editable||!d){let l=e("<input />");u.rupType!==n&&"select"===u.rupType&&(l=e("<select />")),l.val(i.oInit.inlineEdit.useLocalValues?c.text():i.json.rows[t.idx][u.name]).attr("name",u.name+"_inline"+o);var p=u.name.charAt(0).toUpperCase()+u.name.slice(1);l.attr("id",u.name+"_inline"+o).attr("oldtitle",p),i.inlineEdit.lastRow.cellValues[0]===n&&(i.inlineEdit.lastRow.ponerFocus=!0),i.inlineEdit.lastRow.cellValues[a]=c.html();var g=c.find(".openResponsive");c.html(l),g.length>=1&&(g.click((function(e){e.stopPropagation()})),c.prepend(g));const s=u.editoptions?.rupType!==n?u.editoptions.rupType:u.rupType,r=e.escapeSelector(u.name);var f=e("#"+r+"_inline"+o,i.nTBody);if(e("#"+r+"_inline").parent().hasClass("form-groupMaterial")||e("#"+r+"_inline").wrap("<div class='form-groupMaterial'></div>"),e("#"+r+"_inline_child").parent().hasClass("form-groupMaterial")||e("#"+r+"_inline_child").wrap("<div class='form-groupMaterial'></div>"),f.attr({title:"",class:"editable customelement form-control-customer",...e.rup_utils.isNumeric(u.editoptions?.maxlength)&&{maxlength:u.editoptions.maxlength}}).removeAttr("readOnly"),s!==n)"select"===s&&u.editoptions===n?console.error(e.rup_utils.format(jQuery.rup.i18nParse(jQuery.rup.i18n.base,"rup_table.errors.wrongColModel"),u.name,"editoptions")):"tree"===s?console.error(e.rup_utils.format(jQuery.rup.i18nParse(jQuery.rup.i18n.base,"rup_table.errors.treeInlineEdit"),u.name)):("select"===s&&(u.editoptions.selected=i.oInit.inlineEdit.useLocalValues?i.inlineEdit.lastRow.cellValues[a]:i.json.rows[t.idx][u.name]+"",u.editoptions.inlineEditFieldName=u.name,u.editoptions.inlineEdit={},u.editoptions.inlineEdit.$auxForm=i.oInit.inlineEdit.idForm,u.editoptions.inlineEdit.auxSiblingFieldName=u.name),e("#"+e.escapeSelector(f.attr("id"))+"-menu").length>0&&e("#"+e.escapeSelector(f.attr("id"))+"-menu").remove("ul"),f["rup_"+s](u.editoptions));else if("checkbox"===u.edittype){f.prop("type","checkbox").parent().toggleClass("form-groupMaterial checkbox-material checkbox-material-inline").append('<label for="'+f.attr("name")+'"></label>').closest("td").addClass("text-center");var b=i.inlineEdit.lastRow.cellValues[a];1===e(b).find("i.mdi-close").length?f.prop("checked",!1):1===e(b).find("i.mdi-check").length&&f.prop("checked",!0)}i.inlineEdit.lastRow.ponerFocus&&(l.focus(),i.inlineEdit.lastRow.ponerFocus=!1,d&&i.oInit.blockPKeditForm&&i.oInit.primaryKey.length>0&&e.each(i.oInit.primaryKey,(function(e,t){t==u.name&&(i.inlineEdit.lastRow.ponerFocus=!0)})))}a++,"none"===c.css("display")&&r++}})),a-r}function d(i,t,n,l){if(t.hasClass("editable")){var a=i.oInit.colModel;t.removeClass("editable inline"),n.each((function(){var n=e(this),s=e(n);if(!s.hasClass("select-checkbox")){for(;a[l].hidden;)l++;var o=a[l];if(!0===o.editable&&(s.html(i.inlineEdit.lastRow.cellValues[l]),s.find("span.openResponsive").length))if(i.responsive.s.current.reduce((function(e,i){return!1===i?e+1:e}),0)>0){var r=s.find("span.openResponsive");r.click((function(e){t.hasClass("editable")&&t.find(".closeResponsive").length?e.stopPropagation():r.hasClass("closeResponsive")?r.removeClass("closeResponsive"):r.addClass("closeResponsive")}))}else s.find("span.openResponsive").remove();"checkbox"===o.edittype&&s.closest("td").removeClass("text-center"),l++}}))}return l}function c(i,t){var n=i.responsive.s.current.reduce((function(e,i){return!1===i?e+1:e}),0),a=t.find("span.openResponsive");0===t.next(".child").length?a.click():a.addClass("closeResponsive");var s=t.next(".child"),o=i.responsive.s.current.length-n;t.find("td.select-checkbox").length&&o--,r(i,s,s.find(i.oInit.responsive.selectorResponsive),o),s.length>0&&!s.hasClass("new")&&!i.oInit.inlineEdit.alta&&l.Api().rupTable.blockPKEdit(i,"PUT","_inline_child"),u(i,s),e("#"+e.escapeSelector(i.sTableId)).DataTable().responsive.recalc()}function u(i,t){t.data("events")!==n&&t.data("events").keydown!==n||t.keydown((function(l){if("Escape"===l.code)if(t.hasClass("new")){var a=e("#"+e.escapeSelector(i.sTableId)).DataTable();i.inlineEdit.lastRow=n,i.oInit.inlineEdit.alta=n,a.ajax.reload(n,!1)}else o(i,!0);else if("Enter"===l.code||!l.shiftKey&&"Tab"===l.code&&function(e,i){var t=i.closest("td").index();1===i.closest("tr.child").length&&(t=e.aoColumns.length-i.closest("ul").find("li").length+i.closest("li").index());for(var n=0,l=e.aoColumns.length-1;l>=0;l--){for(var a=e.aoColumns[l].data,s=0;s<e.oInit.colModel.length;s++){var o=e.oInit.colModel[s].name;if(!0===e.oInit.colModel[s].editable&&o===a){n=l;break}}if(0!==n)break}return t===n}(i,e(l.target))){var s=!1;return t.parent("tr").length>0&&(t=t.parent("tr")),(1===t.find(".child").length||t.hasClass("child"))&&(s=!0),p(i,t,s),!1}})),e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditLineCrearEventos",i)}function p(i,t,l){var a=function(i,t,l){var a=jQuery.extend(!0,{},t.oInit.inlineEdit.receivedFormDataObject),s={};return!1===l?(s[0]=i,1===i.next().find(".child").length&&(s[1]=i.next())):(s[0]=i.prev(),s[1]=i),e.each(s,(function(){let i;i=this.hasClass("child")?this.find("select,input,textarea"):this.find('td:not([style*="display: none"]):not(".select-checkbox") input:not([disabled]),td:not([style*="display: none"]):not(".select-checkbox") select:not([disabled]),td:not([style*="display: none"]):not(".select-checkbox") textarea:not([disabled])').not('select[ruptype="select"] + span input'),e.each(i,(function(i,t){var l=e(t).val();if(null!=l){var s=t.id.replace("_inline","").replace("_child","");if(l.includes("%"))return a=!1,!1;e(t).prop("type")!==n&&"checkbox"===e(t).prop("type")&&(l="0",e(t).prop("checked")&&(l="1")),s.includes(".")?e.extend(a,e.rup_utils.queryStringToObject(s+"="+l)):a[s]=l}}))})),s[0].hasClass("new")||"boolean"==typeof a||jQuery.grep(t.oInit.colModel,(function(n,l){if(!0!==n.editable){const l=n.name.includes("."),s=t.json.rows[e("tr:not(.dtrg-group)",e(t.nTBody)).index(i)],o=l?e.fn.flattenJSON(s)[n.name]:s[n.name];return l?e.extend(a,e.rup_utils.queryStringToObject(n.name+"="+o)):a[n.name]=o,n}})),a}(t,i,l);if(e.each(i.oInit.primaryKey,(function(n,l){a[l]=i.json.rows[e("tr:not(.dtrg-group)",e(i.nTBody)).index(t)][l]})),a){var s="PUT";if((t.hasClass("new")||l&&t.prev().hasClass("new"))&&(s="POST"),"PUT"===s){let e=i.oInit.validarModificar;if("function"==typeof e&&e(i))return!1}else if("POST"===s){let e=i.oInit.validarAlta;if("function"==typeof e&&e(i))return!1}let n="POST"==s?"/add":"/edit";const o=n.substring(1)+"Url";i.oInit.inlineEdit[o]&&(n=i.oInit.inlineEdit[o]),g(s,i,t,a,n,!1),e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditlineGuardar",i)}else f(i,e.rup.i18nParse(e.rup.i18n.base,"rup_global.charError"),"error"),e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditInLineErrorCallSaveAjax",i)}function g(i,t,s,o,r,d){let c=function(){e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableEditInLineBeforeCallAjax",[t,i,r]);var c=t.oInit.feedback.$feedbackContainer,u=e.rup.i18nParse(e.rup.i18n.base,"rup_table.modifyOK");if("/deleteAll"!==r&&"DELETE"!==i||(u=e.rup.i18nParse(e.rup.i18n.base,"rup_table.deletedOK")),t.oInit.masterDetail!==n){var p=l.Api().masterDetail.getMasterTablePkObject(t);o=jQuery.extend(!0,o,p)}var g={url:t.oInit.urlBase+r,accepts:{"*":"*/*",html:"text/html",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript",text:"text/plain",xml:"application/xml, text/xml"},type:t.oInit.inlineEdit.multipart||"PUT"==i&&t.oInit.inlineEdit.usePostAsEditActionType?"POST":i,data:o,dataType:"json",showLoading:!1,contentType:"application/json",async:!0,success:function(o,d,c){e("#"+e.escapeSelector(t.sTableId)+"saveButton_1").prop("disabled",!0),e("#"+e.escapeSelector(t.sTableId)+"saveButton_1_contextMenuToolbar").addClass("disabledButtonsTable"),e("#"+e.escapeSelector(t.sTableId)+"cancelButton_1").prop("disabled",!0),e("#"+e.escapeSelector(t.sTableId)+"cancelButton_1_contextMenuToolbar").addClass("disabledButtonsTable"),t.oInit.inlineEdit.alta=n;var p=e("#"+e.escapeSelector(t.sTableId)).DataTable(),g=l.Api().rupTable.getIdPk(o,t.oInit);if(t.oInit.filter!=n&&(t.oInit.filter.type="operation"),"/deleteAll"!==r&&"DELETE"!==i){if(f(t,u,"ok"),"PUT"===i){const i=e("tr:not(.dtrg-group)",e(t.nTBody)).index(s);p.row(i).data(o),t.json.rows[i]=o;let a=0;e.each(t.multiselection.selectedRowsPerPage,(function(e,i){i.id!=t.multiselection.lastSelectedId||(a=e)})),t.seeker!==n&&!jQuery.isEmptyObject(t.seeker.ajaxOption.data.search)&&t.seeker.search.funcionParams!==n&&t.seeker.search.funcionParams.length>0&&function(i,t,n){var a=!0;e.each(t.seeker.ajaxOption.data.search,(function(e,t){if(-1===i[e].indexOf(t))return a=!1,!1})),a||(t.seeker.search.funcionParams=jQuery.grep(t.seeker.search.funcionParams,(function(e){return e.page!==Number(t.json.page)||e.pageLine!==n+1})),e("#"+e.escapeSelector(t.sTableId)+" tbody tr").eq(n).find("td.select-checkbox i.filtered-row").remove(),e("#"+e.escapeSelector(t.sTableId)+" tbody tr").eq(n).find("td i.filtered-row").remove(),l.Api().seeker.updateDetailSeekPagination(1,t.seeker.search.funcionParams.length,t))}(o,t,i),t.multiselection.lastSelectedId=g,t.multiselection.selectedRowsPerPage[a].id=g}else t.oInit.inlineEdit.currentPos!==n&&"CLONE"===t.oInit.inlineEdit.currentPos.actionType?(t.multiselection.selectedIds.push(g),t.multiselection.numSelected=t.oInit.multiSelect?t.multiselection.numSelected+1:1):(t.multiselection.selectedIds=[g],t.multiselection.numSelected=1),t.multiselection.lastSelectedId=g,t.multiselection.selectedRowsPerPage[0].id=g;t.inlineEdit.row=o}else t.oInit.feedback.type="eliminar",t.oInit.feedback.msgFeedBack=u,t.oInit.multiSelect!==n?l.Api().multiSelect.deselectAll(p):t.oInit.select!==n&&(l.Api().select.deselect(t),f(t,u,"ok")),e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableEditInLineAfterDelete",t);t.inlineEdit.row=n,t.inlineEdit.lastRow=n,t._buttons[0].inst.s.disableAllButtons=n,l.Api().seeker.disabledButtons(t),p.ajax.reload((function(){a(t)}),!1)},complete:function(){e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableEditInLineCompleteCallSaveAjax",t)},error:function(i){if(406===i.status&&""!==i.responseText)try{let a=JSON.parse(i.responseText);if(a.rupErrorFields)if(a.rupErrorFields!==n||a.rupFeedback!==n){var l=a.rupErrorFields;e.each(l,(function(i,t){1===e("#"+e.escapeSelector(i)+"_inline").length&&(a.rupErrorFields[i+"_inline"]=t),1===e("#"+e.escapeSelector(i)+"_inline_child").length&&(a.rupErrorFields[i+"_inline_child"]=t),delete a.rupErrorFields[i]}));let i=e("#"+e.escapeSelector(t.sTableId)+"_search_searchForm");i.validate().submitted=e.extend(!0,i.validate().submitted,a.rupErrorFields),i.validate().invalid=a.rupErrorFields,i.validate().showErrors(a.rupErrorFields)}else if(errors.rupFeedback!==n){let i=e.rup_utils.printMsg(a.rupFeedback.message);f(t,i,"error")}}catch(e){f(t,i.responseText,"error")}else f(t,i.responseText,"error");e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableEditInLineErrorCallSaveAjax",t)},validate:t.oInit.inlineEdit.validate,feedback:c};if(t.inlineEdit.lastRow!==n&&(t.inlineEdit.lastRow.submit=1),""==g.data)delete g.data,e.rup_ajax(g);else if(d||e("#"+e.escapeSelector(t.sTableId)+"_search_searchForm").valid())if(-1===r.indexOf("deleteAll")){if(!0===t.oInit.inlineEdit.multipart){g.enctype="multipart/form-data",g.processData=!1,g.contentType=!1;let i=new FormData;e.each(g.data,(function(t,n){const l=s.find('input[type="file"][name="'+t+'_inline"]');0!=l.length&&l.prop("files").length>0?e.each(l.prop("files"),(function(e,n){i.append(t,n)})):i.append(t,n)})),g.data=i}else g.data=JSON.stringify(g.data);e.rup_ajax(g)}else g.data=JSON.stringify(g.data),e.rup_ajax(g)};t.oInit.inlineEdit.settings.saveDialog&&!d?e.rup_messages("msgConfirm",{title:"POST"==i?t.oInit.inlineEdit.settings.saveDialogMessages.titleOnAddAction:t.oInit.inlineEdit.settings.saveDialogMessages.titleOnEditAction,message:"POST"==i?t.oInit.inlineEdit.settings.saveDialogMessages.messageOnAddAction:t.oInit.inlineEdit.settings.saveDialogMessages.messageOnEditAction,OKFunction:function(){c(),e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableMessageOk",t)},CANCELFunction:function(){e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableMessageCancel",t)},CLOSEFunction:function(){e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableMessageClose",t)}}):c()}function f(i,t,n){if(i.oInit.inlineEdit.disabledFeedback)return!1;e("#"+e.escapeSelector(i.sTableId)).triggerHandler("tableEditInLineFeedbackShow",i),i.oInit.feedback.$feedbackContainer.rup_feedback("set",t,n),i.oInit.feedback.$feedbackContainer.rup_feedback("show")}function b(i,t){var l=0;e.each(i.inlineEdit.lastRow.rupValues,(function(e,i){i.value!==n?i.visible?t.find("td").eq(i.idCell).find("select").length>0?t.find("td").eq(i.idCell).find("select").rup_select("setRupValue",i.value):(t.find("td").eq(i.idCell).find("input").val(i.value),t.find("td").eq(i.idCell).find("input").is(":checkbox")&&(i.value?t.find("td").eq(i.idCell).find("input").prop("checked",!0):t.find("td").eq(i.idCell).find("input").prop("checked",!1))):(t.next(".child").find("li").eq(l).find("select").length>0?t.next(".child").find("li").eq(l).find("select").rup_select("setRupValue",i.value):(t.next(".child").find("li").eq(l).find("input").val(i.value),t.next(".child").find("li").eq(l).find("input").is(":checkbox")&&(i.value?t.next(".child").find("li").eq(l).find("input").prop("checked",!0):t.next(".child").find("li").eq(l).find("input").prop("checked",!1))),l++):i.visible||l++}))}l.inlineEdit={},l.inlineEdit.version="1.2.4",l.inlineEdit.init=function(t){var r,d=t.settings()[0];if(d.inlineEdit={},e(d.nTBody).on("dblclick.DT keypress","tr:not(.dtrg-group)",(function(i){if("keypress"==i.type&&13==i.which||"dblclick"===i.type){if(e(this).hasClass("editable"))return!1;r=this._DT_RowIndex,s(t,d,r,"PUT"),e("#"+e.escapeSelector(d.sTableId)).triggerHandler("tableEditInlineClickRow",d)}})),t.on("responsive-display",(function(i,a,c,u){u&&c.child()!==n&&(c.child().on("dblclick.DT",(function(){r=c.index(),s(t,d,r,"PUT")})),d.oInit.inlineEdit.rowDefault!==n&&"estadoFinal"===d.oInit.inlineEdit.rowDefault&&(d.oInit.inlineEdit.rowDefault=n,o(d,!0),s(t,d,c.index(),"PUT"),null!==d.oInit.inlineEdit.currentPos&&"CLONE"===d.oInit.inlineEdit.currentPos.actionType&&(e("#"+e.escapeSelector(d.sTableId)+" tbody tr:not(.dtrg-group)").eq(0).addClass("new"),l.Api().rupTable.selectPencil(d,0))),e(c.node()).hasClass("selected")&&c.child().addClass("selected tr-highlight"))})),e(i).on("resize.dtr",l.util.throttle((function(){t.responsive.recalc()}))),d.oInit.inlineEdit.validate!==n&&d.oInit.inlineEdit.validate.rules!==n){var c=d.oInit.inlineEdit.validate.rules;d.oInit.inlineEdit.validate.rules={},e.each(c,(function(e,i){d.oInit.inlineEdit.validate.rules[e+"_inline"]=i,d.oInit.inlineEdit.validate.rules[e+"_inline_child"]=i}))}if(0===e("#"+e.escapeSelector(d.sTableId)+"_search_searchForm").length){var u=jQuery("<form>").attr("id",d.sTableId+"_search_searchForm").addClass("w-100");e("#"+e.escapeSelector(d.sTableId)).wrapAll(u)}let g,f=d.oInit.feedback.$feedbackContainer;d.oInit.inlineEdit.validate!==n&&(g=d.oInit.inlineEdit.validate.rules);let b=e.extend(!0,{},{liveCheckingErrors:!1,showFieldErrorAsDefault:!0,showErrorsInFeedback:!0,showFieldErrorsInFeedback:!0},d.oInit.inlineEdit.propertiesValidate);b.feedback=f,b.rules=g,e("#"+e.escapeSelector(d.sTableId)+"_search_searchForm").rup_validate(b);let I=!1,m=!1;d.oInit.buttons!==n&&d.oInit.buttons.blackListButtons!==n&&("all"===d.oInit.buttons.blackListButtons?(I=!0,m=!0):d.oInit.buttons.blackListButtons&&d.oInit.buttons.blackListButtons.length>0&&e.each(d.oInit.buttons.blackListButtons,(function(){"saveButton"===this&&(I=!0),"cancelButton"===this&&(m=!0)}))),d.oInit.inlineEdit.myButtons={},I||(d.oInit.inlineEdit.myButtons.guardar={text:function(i){return e.rup.i18nParse(e.rup.i18n.base,"rup_table.save")},id:d.sTableId+"saveButton_1",className:"btn-material-primary-high-emphasis table_toolbar_btnSave order-5",icon:"mdi-content-save",displayRegex:/asss/,insideContextMenu:!0,type:"save",action:function(i,t,n,l){var a=e("#"+e.escapeSelector(d.sTableId)+" tbody tr.editable:not(.child)");p(d,a,!1)}}),m||(d.oInit.inlineEdit.myButtons.cancelar={text:function(i){return e.rup.i18nParse(e.rup.i18n.base,"rup_table.cancel")},id:d.sTableId+"cancelButton_1",className:"btn-material-primary-high-emphasis table_toolbar_btnCancel order-6",icon:"mdi-cancel",displayRegex:/asss/,insideContextMenu:!0,type:"cancel",action:function(){let i=function(){e("#"+e.escapeSelector(d.sTableId)+"saveButton_1").prop("disabled",!0),e("#"+e.escapeSelector(d.sTableId)+"saveButton_1_contextMenuToolbar").addClass("disabledButtonsTable"),e("#"+e.escapeSelector(d.sTableId)+"cancelButton_1").prop("disabled",!0),e("#"+e.escapeSelector(d.sTableId)+"cancelButton_1_contextMenuToolbar").addClass("disabledButtonsTable"),d.inlineEdit.lastRow=n,d.oInit.inlineEdit.alta=n,d.oInit.multiSelect!==n?l.Api().multiSelect.deselectAll(t):d.oInit.select!==n&&l.Api().select.deselect(d),t.ajax.reload(n,!1)};d.oInit.inlineEdit.settings.cancelDialog?e.rup_messages("msgConfirm",{title:d.oInit.inlineEdit.settings.cancelDialogMessages.title,message:d.oInit.inlineEdit.settings.cancelDialogMessages.message,OKFunction:function(){i(),e("#"+e.escapeSelector(d.sTableId)).triggerHandler("tableMessageOk",d)},CANCELFunction:function(){e("#"+e.escapeSelector(d.sTableId)).triggerHandler("tableMessageCancel",d)},CLOSEFunction:function(){e("#"+e.escapeSelector(d.sTableId)).triggerHandler("tableMessageClose",d)}}):i()}}),d.oInit.inlineEdit.settings={saveDialog:d.oInit.inlineEdit.confirmDialogs===n||d.oInit.inlineEdit.confirmDialogs.saveDialog===n||d.oInit.inlineEdit.confirmDialogs.saveDialog,saveDialogMessages:{titleOnAddAction:d.oInit.inlineEdit.confirmDialogs?.saveDialogMessages?.titleOnAddAction?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.saveDialogMessages.titleOnAddAction):e.rup.i18nParse(e.rup.i18n.base,"rup_table.add.save"),messageOnAddAction:d.oInit.inlineEdit.confirmDialogs?.saveDialogMessages?.messageOnAddAction?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.saveDialogMessages.messageOnAddAction):e.rup.i18nParse(e.rup.i18n.base,"rup_table.add.saveData"),titleOnEditAction:d.oInit.inlineEdit.confirmDialogs?.saveDialogMessages?.titleOnEditAction?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.saveDialogMessages.titleOnEditAction):e.rup.i18nParse(e.rup.i18n.base,"rup_table.edit.save"),messageOnEditAction:d.oInit.inlineEdit.confirmDialogs?.saveDialogMessages?.messageOnEditAction?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.saveDialogMessages.messageOnEditAction):e.rup.i18nParse(e.rup.i18n.base,"rup_table.edit.saveData")},cancelDialog:d.oInit.inlineEdit.confirmDialogs===n||d.oInit.inlineEdit.confirmDialogs.cancelDialog===n||d.oInit.inlineEdit.confirmDialogs.cancelDialog,cancelDialogMessages:{title:d.oInit.inlineEdit.confirmDialogs?.cancelDialogMessages?.title?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.cancelDialogMessages.title):e.rup.i18nParse(e.rup.i18n.base,"rup_table.changes"),message:d.oInit.inlineEdit.confirmDialogs?.cancelDialogMessages?.message?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.cancelDialogMessages.message):e.rup.i18nParse(e.rup.i18n.base,"rup_table.saveAndContinue")},deleteDialog:d.oInit.inlineEdit.confirmDialogs===n||d.oInit.inlineEdit.confirmDialogs.deleteDialog===n||d.oInit.inlineEdit.confirmDialogs.deleteDialog,deleteDialogMessages:{title:d.oInit.inlineEdit.confirmDialogs?.deleteDialogMessages?.title?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.deleteDialogMessages.title):e.rup.i18nParse(e.rup.i18n.base,"rup_table.delete"),message:d.oInit.inlineEdit.confirmDialogs?.deleteDialogMessages?.message?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.deleteDialogMessages.message):e.rup.i18nParse(e.rup.i18n.base,"rup_table.deleteAll")},changeControlDialogMessages:{title:d.oInit.inlineEdit.confirmDialogs?.changeControlDialogMessages?.title?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.changeControlDialogMessages.title):e.rup.i18nParse(e.rup.i18n.base,"rup_table.changes"),message:d.oInit.inlineEdit.confirmDialogs?.changeControlDialogMessages?.message?e.rup.i18nParse(e.rup.i18n.app,d.oInit.inlineEdit.confirmDialogs.changeControlDialogMessages.message):e.rup.i18nParse(e.rup.i18n.base,"rup_table.checkSelectedElems")}},e(i).on("resize.dtr",l.util.throttle((function(){a(d)})))};var I=l.Api.register;return I("inlineEdit.add()",(function(i,t){!function(i,t){t.multiselection.numSelected>0?e.rup_messages("msgConfirm",{title:t.oInit.inlineEdit.settings.changeControlDialogMessages.title,message:t.oInit.inlineEdit.settings.changeControlDialogMessages.message,OKFunction:function(){o(t,!0),t.oInit.seeker!==n?l.Api().seeker.limpiarSeeker(i,t):t.oInit.multiSelect!==n?l.Api().multiSelect.deselectAll(i):t.oInit.select!==n&&l.Api().select.deselect(t),t.oInit.inlineEdit.alta=!0,i.ajax.reload((function(){t.oInit.inlineEdit.alta=n,e("#"+e.escapeSelector(t.sTableId)+" tbody tr:not(.dtrg-group)").eq(0).addClass("new"),s(i,t,0,"POST")}))}}):(t.oInit.inlineEdit.alta=!0,i.ajax.reload((function(){t.oInit.inlineEdit.alta=n,e("#"+e.escapeSelector(t.sTableId)+" tbody tr:not(.dtrg-group)").eq(0).addClass("new"),s(i,t,0,"POST")}))),e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableEditInlineAddRow",t)}(i,t)})),I("inlineEdit.editInline()",(function(e,i,t,n){s(e,i,t,n)})),I("inlineEdit.restaurarFila()",(function(e,i){o(e,i)})),I("inlineEdit.editSameLine()",(function(e,i){var t=!1;return e.inlineEdit!==n&&e.inlineEdit.lastRow!==n&&e.inlineEdit.lastRow.idx==i&&(t=!0),t})),I("inlineEdit.recorrerCeldas()",(function(e,i,t,n){r(e,i,t,n)})),I("inlineEdit.comprobarFila()",(function(e,i){c(e,i)})),I("inlineEdit.inResponsiveChangeInputsValues()",(function(i,t){!function(i,t){var n=e("#"+e.escapeSelector(i.sTableId)).DataTable();i.inlineEdit.lastRow.rupValues=[],n.columns().responsiveHidden().each((function(n,l){if(!t.find("td").eq(l).hasClass("select-checkbox")){if(n!==i.inlineEdit.lastRow.columnsHidden[l]&&i.oInit.columns[l].editable){var a="";if(n){var s=i.inlineEdit.lastRow.columnsHidden.reduce((function(e,i){return!1===i?e+1:e}),0);s=s+l-i.inlineEdit.lastRow.columnsHidden.length;var o=t.next(".child").find("li").eq(s).find("select,input");a=o.val(),o.length>0&&e("#"+e.escapeSelector(o[0].id.replace("_child",""))).prop("disabled",!1),o.is(":checkbox")&&(a=!!o.prop("checked"))}else{var r=t.find("td").eq(l).find("select,input");a=r.val(),r.prop("disabled",!0),r.is(":checkbox")&&(a=!!r.prop("checked"))}}else{var d=i.inlineEdit.lastRow.columnsHidden.reduce((function(e,i){return!1===i?e+1:e}),0);if(d=d+l-i.inlineEdit.lastRow.columnsHidden.length,n||0===t.next(".child").find("li").eq(d).find("select,input").length){var c=t.find("td").eq(l).find("select,input");a=c.val(),c.is(":checkbox")&&(a=!!c.prop("checked"))}else{var u=t.next(".child").find("li").eq(d).find("select,input");a=u.val(),u.is(":checkbox")&&(a=!!u.prop("checked"))}}i.inlineEdit.lastRow.rupValues.push({idCell:l,value:a,visible:n})}}))}(i,t)})),I("inlineEdit.asignarInputsValues()",(function(e,i){b(e,i)})),I("inlineEdit.onResponsiveResize()",(function(e){!function(e){e.on("responsive-resize",(function(e,i){a(i.context[0])}))}(e)})),I("inlineEdit.addchildIcons()",(function(e){a(e)})),I("inlineEdit.createTr()",(function(e,i,t){return function(e,i,t){var l={};return i.oInit.colModel!==n&&(jQuery.grep(i.oInit.colModel,(function(e){l[e.name]=""})),t.unshift(l)),t}(0,i,t)})),I("inlineEdit.drawInlineEdit()",(function(i,t){return function(i,t){a(t);var s=t.inlineEdit.row;if(t.inlineEdit.row!==n&&function(i){var t=l.Api().rupTable.getIdPk(i.inlineEdit.row,i.oInit),a=!0;return e.each(i.json.rows,(function(e,n){if(l.Api().rupTable.getIdPk(n,i.oInit)==t)return a=!1,!1})),i.inlineEdit.row=n,a}(t)){var o=s;e.each(t.json.rows,(function(e,t){var n=t;i.row(e).data(o),o=n})),t.json.rows.pop(),t.json.rows.splice(0,0,s)}}(i,t)})),I("inlineEdit.getRowSelected()",(function(i,t){return function(i,t){var a=i.settings()[0],o={id:0,page:1,line:0},r=a.multiselection.lastSelectedId;if(a.multiselection.selectedAll){if(a.oInit.inlineEdit!==n&&(a.oInit.inlineEdit.numPosition=0),r===n||""===r)o.page=function(i){var t=1,n=i.json.total;if(i.multiselection.deselectedRowsPerPage.length>0)for(var l=i.json.rows.length,a=0,s=1;s<n;)e.each(i.multiselection.deselectedRowsPerPage,(function(e,i){if(s===Number(i.page)&&a++,a===l)return!1})),a<l&&(t=s,s=i.json.total),a=0,s++;return t}(a),o.line=function(i){var t=-1,a=i.json.rows;return e.each(a,(function(e,a){if(e>-1&&-1===jQuery.inArray(l.Api().rupTable.getIdPk(a,i.oInit),i.multiselection.deselectedIds)){t=e;var s={id:l.Api().rupTable.getIdPk(a,i.oInit),page:i.json.page,line:e};return i.oInit.inilineEdit!==n&&(i.oInit.inilineEdit.currentPos=s),!1}})),t}(a);else{var d=e.grep(a.multiselection.selectedRowsPerPage,(function(e){return e.id==a.multiselection.lastSelectedId}));o.page=d[0].page,o.line=d[0].line;var c=a._iDisplayLength*(Number(o.page)-1);c=c+1+o.line,d=e.grep(a.multiselection.deselectedRowsPerPage,(function(e){return Number(e.page)<Number(o.page)||Number(o.page)===Number(e.page)&&Number(e.line)<Number(o.line)})),o.indexSelected=c-d.length,a.oInit.inlineEdit!==n&&(a.oInit.inlineEdit.numPosition=o.indexSelected-1)}a.oInit.inlineEdit!==n&&(a.oInit.inlineEdit.currentPos=o)}else e.each(a.multiselection.selectedRowsPerPage,(function(e,i){if(i.id==a.multiselection.lastSelectedId)return o.id=i.id,o.page=i.page,o.line=i.line,o.indexSelected=e,a.oInit.inlineEdit!==n&&(a.oInit.inlineEdit.currentPos=o),!1}));return i.page()+1!==Number(o.page)?(e("#"+e.escapeSelector(a.sTableId)).DataTable().page(o.page-1).draw("page"),a.oInit.inlineEdit!==n&&(o.actionType=t,a.oInit.inlineEdit.rowDefault=o)):"PUT"===t?s(i,a,o.line,t):"CLONE"===t&&(i.ajax.reload(n,!1),o.actionType=t,a.oInit.inlineEdit.rowDefault=o),o}(i,t)})),I("inlineEdit.deleteAllSelects()",(function(t){return function(t){var n=t.settings()[0];let l=new RegExp(n.oInit.multiplePkToken,"g"),a=n.multiselection.selectedIds.length>1?"POST":"DELETE",s=function(){let e={};e.filter=i.form2object(n.oInit.filter.$filterContainer[0]),n.multiselection.selectedIds.length>1?(e.core={pkToken:n.oInit.multiplePkToken,pkNames:n.oInit.primaryKey},e.multiselection={},e.multiselection.selectedAll=n.multiselection.selectedAll,e.multiselection.selectedAll?e.multiselection.selectedIds=n.multiselection.deselectedIds:e.multiselection.selectedIds=n.multiselection.selectedIds,g(a,n,0,e,"/deleteAll",!0)):(e=n.multiselection.selectedIds[0],e=e.replace(l,"/"),g(a,n,"",0,"/"+e,!0))};n.oInit.inlineEdit.settings.deleteDialog?e.rup_messages("msgConfirm",{title:n.oInit.inlineEdit.settings.deleteDialogMessages.title,message:n.oInit.inlineEdit.settings.deleteDialogMessages.message,OKFunction:function(){s(),e("#"+e.escapeSelector(n.sTableId)).triggerHandler("tableMessageOk",n)},CANCELFunction:n.oInit.inlineEdit.cancelDeleteFunction}):s()}(t)})),I("inlineEdit.cloneLine()",(function(i,t,l){!function(i,t,l){e("#"+e.escapeSelector(t.sTableId)).triggerHandler("tableEditInlineClone",t),i.row(0).data(i.row(l+1).data()),t.oInit.inlineEdit.rowDefault!==n&&(t.oInit.inlineEdit.rowDefault.line=0),e("#"+e.escapeSelector(t.sTableId)+" tbody tr").eq(0).addClass("new")}(i,t,l)})),e(t).on("plugin-init.dt",(function(e,i){"dt"===e.namespace&&(i.oInit.noEdit||i.oInit.inlineEdit===n||!1===i.oInit.inlineEdit.activate||(l.inlineEdit.init(new l.Api(i)),i.oInit.inlineEdit.cancelDeleteFunction===n&&(i.oInit.inlineEdit.cancelDeleteFunction=function(){})))})),l.inlineEdit}));