/*! For license information please see rup.dialog.js.LICENSE.txt */
!function(i){"function"==typeof define&&define.amd?define(["jquery","./rup.base","block-ui","./rup.message"],i):i(jQuery)}((function(i){i.extend(i.rup,{dialog:{DIV:"dialogDIV",TEXT:"textDialog",AJAX:"ajaxDialog",LINK:"linkButton"}}),i.extend(i.rup.iniRup,i.rup.rupSelectorObjectConstructor("rup_dialog",{})),i.widget("ui.dialog",i.ui.dialog,{_title:function(i){this.options.title?i.html(this.options.title):i.html("&#160;")}}),i.fn.rup_dialog("extend",{open:function(){if(!i(this).hasClass("disabled")){var t,e=i.extend({},i(this).dialog("option"));i(this).data("focus",i(document.activeElement)),i("body").addClass("overflow-hidden");var a=i(document).height(),o=i(document).width();!1===i(this).dialog("option","ajaxCache")?(e.id=i(this).attr("id"),e.autoOpen=!0,e.complete=function(){i(this).trigger("rupDialog_open")},this._ajaxLoad(e)):(i(this).dialog("open"),i(this).trigger("rupDialog_open")),i.rup_utils.aplicatioInPortal()&&(null!==i(this).data("uiDialog").overlay&&(t=i(this).data("uiDialog").overlay,i(".r01gContainer").append(t),t.css("height",a).css("width",o)),void 0!==e.position&&null!==e.position||i(this).data("uiDialog").uiDialog.css("position","absolute").css("top",a/2-i("div[aria-describedby="+this[0].id+"]").height()/2)),i("div.ui-dialog-buttonpane button").last().trigger("focus")}},destroy:function(){i(this).dialog("destroy")},disable:function(){i(this).hasClass("disabled")||i(this).addClass("disabled")},enable:function(){i(this).hasClass("disabled")&&i(this).removeClass("disabled")},widget:function(){return i(this).dialog("widget")},moveToTop:function(){i(this).hasClass("disabled")||i(this).dialog("moveToTop")},close:function(){i(this).hasClass("disabled")||!1!==i(this).triggerHandler("onBeforeClose")&&i(this).dialog("close")},isOpen:function(){return i(this).dialog("isOpen")},getOption:function(t){return i(this).dialog("option",t)},setOption:function(t,e){if("buttons"!==t)void 0!==e?i(this).dialog("option",t,e):i(this).dialog("option",t);else{var a,o=e.length,s=[];if(o>1)for(let t=0;t<e.length;t++)e[t].btnType===i.rup.dialog.LINK&&s.push(e.splice(t,1));if(a=s.length,o>1&&0===a)return i.rup_messages("msgAlert",{message:i.rup.i18nParse(i.rup.i18n,"base.rup_global.rupCheckStyleError")}),!1;if(i(this).dialog("option",t,e),a>0)for(let i=0;i<a;i++)this.createBtnLinks(s[i][0],this[0].id);o>0&&i("#"+i.escapeSelector(this[0].id)).closest("div.rup-dialog").find("button.ui-button.ui-corner-all.ui-widget:not(.ui-datepicker-trigger)").addClass(i.rup.adapter[i.fn.rup_dialog.defaults.adapter].classComponent()).removeClass("ui-button ui-corner-all ui-widget")}},createBtnLinks:function(t,e){if(!i(this).hasClass("disabled")){var a=i("<button></button>").attr("type","button").attr("id","rup_dialog"+t.text).addClass(i.rup.adapter[i.fn.rup_dialog.defaults.adapter].classComponent()).html(t.text).click(t.click);i("div[aria-describedby="+e+"] .ui-dialog-buttonset ").prepend(a)}}}),i.fn.rup_dialog("extend",{_init:function(t){if(t.length>1)i.rup.errorGestor(i.rup.i18nParse(i.rup.i18n.base,"rup_global.initError"+i(this).attr("id")));else{var e=i.extend({},i.fn.rup_dialog.defaults,t[0]),a=this;e._close=e.close,e.close=function(t,a){void 0!==i(this).data("focus")&&i(this).data("focus").focus(),void 0!==e._close&&e._close(t,a)},e.onBeforeClose&&"function"==typeof e.onBeforeClose&&i(this).on("onBeforeClose",(function(){return e.onBeforeClose()})),i(this).on("dialogclose",(function(){i("body").removeClass("overflow-hidden")})),null!==e.type&&i(this).length>0?i.each(i(this),(function(){var t=i(this);void 0!==t.attr("id")?e.id=t.attr("id"):(e.id="rup_"+e.type+"DIV",i("<div></div>").attr("id",e.id).appendTo("body"));var o,s,r,n,l=!1,d=[],u=0,p=!1;if(i("div[aria-describedby="+e.id+"]").length>0?p=!0:(i("body #"+e.id).not(".ui-dialog-content").length>1&&i(i("body #"+e.id).not(".ui-dialog-content")[1]).remove(),""!==e.specificLocation?n=function(){t.parent(".ui-dialog").insertAfter(i("#"+i.escapeSelector(e.specificLocation)))}:i.rup_utils.aplicatioInPortal()&&(n=function(){i(".r01gContainer").append(i(".ui-dialog"))})),void 0!==n){var c=e.create;e.create=function(i,t){if(null!=c&&!1===c.call(i,t))return!1;n(i,t)}}switch(e.type){case i.rup.dialog.DIV:void 0!==e.clone&&(t.clone(!0).attr("id",e.clone).insertAfter(t),e.id=e.clone);break;case i.rup.dialog.TEXT:t.html(e.message);break;case i.rup.dialog.AJAX:a._ajaxLoad(e)}if(!0===e.autoOpen&&(l=!0,e.autoOpen=!1),e.buttons&&null!==e.buttons){if((o=e.buttons.length)>1){for(s=0;s<e.buttons.length;s++)e.buttons[s].btnType===i.rup.dialog.LINK&&(d.push(e.buttons.splice(s,1)),s--);s=null}u=d.length,o>1&&0===u&&e.rupCheckStyle&&(i.rup_messages("msgAlert",{message:i.rup.i18nParse(i.rup.i18n.base,"rup_global.rupCheckStyleError")}),e.stack=!1,e.modal=!1,e.zIndex=9999)}if(p)i("div[aria-describedby="+e.id+"] .ui-dialog-buttonset a").remove(),e.title&&i("div[aria-describedby="+e.id+"] .ui-dialog-title").text(e.title);else if(t.dialog(e),t.data("uiDialog").uiDialog.addClass("rup-dialog"),null!=e.maxWidth&&0!=e.maxWidth&&""!=e.maxWidth&&(("string"==typeof e.maxWidth||e.maxWidth instanceof String)&&e.maxWidth.includes("%")?t.parent().css("max-width",""+e.maxWidth):t.parent().css("max-width",e.maxWidth+"px")),"dialog_material"===i.fn.rup_dialog.defaults.adapter&&t.data("uiDialog").uiDialogTitlebar.addClass(i.rup.adapter[i.fn.rup_dialog.defaults.adapter].titlebarColor()),0===i("#"+i.escapeSelector(e.id)+"_close").length&&t.prev("div").append('<a class="float-end text-white" href="#0"><i id="'+e.id+'_close" class="mdi mdi-close" aria-hidden="true"></i></a>').on("click","a",(function(){return t.dialog("close"),!1})),u>0){for(r=0;r<u;r++)i(this).rup_dialog("createBtnLinks",d[r][0],e.id);r=null}e.type!==i.rup.dialog.AJAX?a._addButtonClasses(t):e.dialog=a,l&&(e.type!==i.rup.dialog.AJAX?(t.rup_dialog("open"),i("div[aria-describedby="+e.id+"] .ui-dialog-buttonpane button").last().focus()):e.autoOpen=!0)})):0===i(this).length?i.rup.errorGestor(i.rup.i18nParse(i.rup.i18n.base,"rup_global.selectorError")):i.rup.errorGestor(i.rup.i18nParse(i.rup.i18n.base,"rup_global.dialogTypeError"))}},_ajaxLoad:function(t){if(!t.url||null===t.url||""===t.url)return i.rup_messages("msgAlert",{title:i.rup.i18nParse(i.rup.i18n.base,"rup_global.error"),message:i.rup.i18nParse(i.rup.i18n.base,"rup_dialog.noURL")}),!1;t.showLoading&&!0===t.autoOpen&&i.blockUI({message:'<img src="'+i.rup.RUP+'/css/images/rup.ajaxLoader.gif" style="position:absolute;top:12px;left:15px;" alt="'+i.rup.i18nParse(i.rup.i18n.base,"rup_blockUI.cargando")+'" ><h1 class="loading">'+i.rup.i18nParse(i.rup.i18n.base,"rup_blockUI.cargando")+"...</h1>"});var e=i.extend({},t.ajaxOptions);e.success=function(e,a,o){if(""!==e||null!==e){const a=i("#"+i.escapeSelector(t.id));a.html(e),t.dialog._addButtonClasses(),i.unblockUI(),!0===t.autoOpen&&(a.rup_dialog("open"),i("div[aria-describedby="+i.escapeSelector(t.id)+"] .ui-dialog-buttonpane button").last().focus())}t.ajaxOptions&&void 0!==t.ajaxOptions.success&&null!==t.ajaxOptions.success&&"function"==typeof t.ajaxOptions.success&&t.ajaxOptions.success(e,a,o)},e.error=function(e,a,o){i.unblockUI(),t.ajaxOptions&&void 0!==t.ajaxOptions.error&&null!==t.ajaxOptions.error&&"function"==typeof t.ajaxOptions.error?t.ajaxOptions.error(e,a,o):i.rup_messages("msgAlert",{message:i.rup.i18nParse(i.rup.i18n.base,"rup_dialog.errorLoadingData")})},e.url=i.rup_utils.setNoPortalParam(t.url),e.type="GET",e.cache=!1,e.dataType="text",i.rup_ajax(e)},_addButtonClasses:function(){this.data("uiDialog")?.uiDialog.find("button.ui-dialog-titlebar-close").remove(),this.data("uiDialog")?.uiDialog.find("button:not(.ui-datepicker-trigger,.ui-timepicker-trigger)").addClass(i.rup.adapter[i.fn.rup_dialog.defaults.adapter].classComponent()).removeClass("ui-button ui-corner-all ui-widget")}}),i.fn.rup_dialog.defaults={rupCheckStyle:!0,type:null,url:null,minHeight:100,maxWidth:!1,ajaxCache:!0,specificLocation:"",clone:void 0,adapter:"dialog_material"}}));